{% extends 'WAMSApp/base.html' %}

{% block content %}

{% load static %}

<style type="text/css">

.ck.ck-content ul,
.ck.ck-content ul li{
  list-style-type: inherit;
}
.ck.ck-content ul {
  padding-left: 40px;
}

.flex-container-space-btw {
  display: flex;
  justify-content: space-between;
}

.flex-container-space-btw > div{
  margin-top: 15px;
  width: 7vw;
}


.img-wrapper {
  position: relative;
}

.img-responsive {
  width: 100%;
  height: auto;
}

.img-overlay {
  position: absolute;
  top: 1em;
  bottom: 0;
  right: 1em;
  text-align: center;
}

.redd:hover {
  background-color: red !important;
  color:white !important;
}

.greenn:hover {
  background-color: #009051 !important;
  color:white !important;
}

.bluee:hover {
  background-color: blue !important;
  color:white !important;  
}

.yelloww:hover {
  background-color: orange !important;
  color:white !important;
}

.purplee:hover {
  background-color: #512de8 !important;
  color:white !important;
}

.maroonn:hover {
  background-color: maroon !important;
  color: white !important;
}

.homee:hover {
  background-color: #521893 !important;
  color: white !important;
}

.miniimage + input {
  width: 50% !important;
  display: block;
}

input[type = "checkbox"].filled-in:checked + span:before {
  background-color: #512de8 !important
}

input[type = "checkbox"].filled-in:checked + span:after {
  background-color: #512de8 !important
}

.img-overlay:before {
  content: ' ';
  display: block;
  height: 10%;
}


a .active {
  background-color: #512da8 !important;
}


/*tabs*/

.tab-content {
  margin-top: 20px;
  max-height: 80vh;
  overflow: auto;
  overflow-x: hidden; 
}

input:focus {
  border-color: #512da8 !important;  
}

input:select {
  border-color: #512da8 !important;  
}

.tab-pane div.row {
  padding: 20px !important;
}

.savebtn {
  position: fixed;
  top: 20px;
  left: 50px;
  background-color: #512da8;
}

li span {
  color: black !important;
}

img.materialboxed {
  width: 100px;
  height: 100px;
}

.tab-pane h4 {
  display: none;
}

.miniimage {
  display: block;
  height: 80px;
}

.image-section {
  overflow-y: scroll;
  overflow-x: hidden;
}

::-webkit-scrollbar {
    width: 0px;
    background: transparent; 
}

::-webkit-scrollbar-thumb {
    background: gray;
}


.input-field:not(.left-section) {
  padding : 0px 50px 0px 50px !important;
  margin-top: 20px !important;  
}


input:not([type]),
input[type=text],
input[type=password],
input[type=email],
input[type=url],
input[type=time],
input[type=date],
input[type=datetime],
input[type=datetime-local],
input[type=tel],
input[type=number],
input[type=search],
textarea.materialize-textarea {
  border: none !important;
  border-bottom: 2px solid #f7f7f7 !important; 
  padding-left: 10px !important;
  font-family: 'AvenirNext' !important;
  font-weight: 
}

input:not([type]):focus:not([readonly]),
input[type=text]:focus:not([readonly]),
input[type=password]:focus:not([readonly]),
input[type=email]:focus:not([readonly]),
input[type=url]:focus:not([readonly]),
input[type=time]:focus:not([readonly]),
input[type=date]:focus:not([readonly]),
input[type=datetime]:focus:not([readonly]),
input[type=datetime-local]:focus:not([readonly]),
input[type=tel]:focus:not([readonly]),
input[type=number]:focus:not([readonly]),
input[type=search]:focus:not([readonly]),
textarea.materialize-textarea:focus:not([readonly]) > label {
  border-bottom: 1px solid #512ea8 !important;
  box-shadow: 0 1px 0 0 #f00 !important;
  border-bottom: none !important;
  box-shadow: none !important;
}

label {
  margin-left: 50px !important; 
}

.input-field:not(.left-section) input:focus + label {
  color: #512ea8 !important;
}

.row .input-field:not(.left-section) input:focus {
  border-bottom: 1px solid #512ea8 !important;
  box-shadow: 0 1px 0 0 #512ea8 !important
}

.left-section .select-wrapper ul {
  position: relative;
  top: -300px !important;
}

.material-placeholder {
  width: 25vw;
  height: 25vw;
}

.preview-img{
  height: 100% !important;
  width:  100% !important;
  object-fit: contain;
}

body {
  z-index: 100; 
}

</style>



<script src="https://cdn.ckeditor.com/ckeditor5/11.0.1/decoupled-document/ckeditor.js"></script>

<style type="text/css">
  .document-editor {
    border: 1px solid var(--ck-color-base-border);
    border-radius: var(--ck-border-radius);
    max-height: 40em;
    display: flex;
    flex-flow: column nowrap;
  }

  .document-editor__toolbar {
    z-index: 1;
    box-shadow: 0 0 5px hsla( 0,0%,0%,.2 );
    border-bottom: 1px solid var(--ck-color-toolbar-border);
  }

  .document-editor__toolbar .ck-toolbar {
    border: 0;
    border-radius: 0;
  }


  .document-editor__editable-container {
    padding: calc( 2 * var(--ck-spacing-large) );
    background: var(--ck-color-base-foreground);
    overflow-y: scroll;
  }

  .document-editor__editable-container .ck-editor__editable {
    width: 15.8cm;
    min-height: 21cm;
    padding: 1cm 2cm 2cm;
    border: 1px hsl( 0,0%,82.7% ) solid;
    border-radius: var(--ck-border-radius);
    background: white;
    box-shadow: 0 0 5px hsla( 0,0%,0%,.1 );
    margin: 0 auto;
  }

  .document-editor .ck-content,
  .document-editor .ck-heading-dropdown .ck-list .ck-button__label {
    font: 16px/1.6 "Helvetica Neue", Helvetica, Arial, sans-serif;
  }

  .document-editor .ck-heading-dropdown .ck-list .ck-button__label {
    line-height: calc( 1.7 * var(--ck-line-height-base) * var(--ck-font-size-base) );
    min-width: 6em;
  }

  .document-editor .ck-heading-dropdown .ck-list .ck-button:not(.ck-heading_paragraph) .ck-button__label {
    transform: scale(0.8);
    transform-origin: left;
  }

  .document-editor .ck-content h2,
  .document-editor .ck-heading-dropdown .ck-heading_heading1 .ck-button__label {
    font-size: 2.18em;
    font-weight: normal;
  }

  .document-editor .ck-content h2 {
    line-height: 1.37em;
    padding-top: .342em;
    margin-bottom: .142em;
  }

  .document-editor .ck-content h3,
  .document-editor .ck-heading-dropdown .ck-heading_heading2 .ck-button__label {
    font-size: 1.75em;
    font-weight: normal;
    color: hsl( 203, 100%, 50% );
  }

  .document-editor .ck-heading-dropdown .ck-heading_heading2.ck-on .ck-button__label {
    color: var(--ck-color-list-button-on-text);
  }

  .document-editor .ck-content h3 {
    line-height: 1.86em;
    padding-top: .171em;
    margin-bottom: .357em;
  }

  .document-editor .ck-content h4,
  .document-editor .ck-heading-dropdown .ck-heading_heading3 .ck-button__label {
    font-size: 1.31em;
    font-weight: bold;
  }

  .document-editor .ck-content h4 {
    line-height: 1.24em;
    padding-top: .286em;
    margin-bottom: .952em;
  }

  .document-editor .ck-content p {
    font-size: 1em;
    line-height: 1.63em;
    padding-top: .5em;
    margin-bottom: 1.13em;
  }

  .image-section-dropdown
  .select-wrapper
  input.select-dropdown {
    border : none !important;
    bottom: 2px !important;
    margin-bottom: 0px !important;
    font-size: 14px !important;
  }

  .document-editor .ck-content blockquote {
    font-family: Georgia, serif;
    margin-left: calc( 2 * var(--ck-spacing-large) );
    margin-right: calc( 2 * var(--ck-spacing-large) );
  }

  input.active {
    border-bottom-color: #512da8!important;
  }

</style>


<br>
<div>
  <div class="row" style="margin:0px;margin-left: 100px;">
    <div class="col s4 image-section" style="height: 90vh;">
      <div class = "main-image">
      </div>
        
      <div class="row image-section-dropdown" style="margin-bottom: 0px;">
        <div class="input-field left-section col s7" style="
          width: 21vw;
          border: none; 
          background-color: 
          white;height: 40px; 
          font-size: 14px !important;
          margin-left: 10px;">
          <select id="images-category">
            <option value="Main Images" id="main-images-option" >Main Images</option> 
            <option value="Sub Images" id="sub-images-option">Sub Images</option>
            <option value="PFL Images" id="pfl-images-option">PFL Images</option>
            <option value="PFL Generated Images" id="pfl-generated-images-option">PFL Generated Images</option>
            <option value="White Background Images" id="white-background-images-option">White Background Images</option>
            <option value="Lifestyle Images" id="lifestyle-images-option">Lifestyle Images</option>
            <option value="Certificate Images" id="certificate-images-option">Certificate Images</option>
            <option value="Giftbox Images" id="giftbox-images-option">Giftbox Images</option>
            <option value="Diecut Images" id="diecut-images-option">Diecut Images</option>
            <option value="A+ Content Images" id="aplus-content-images-option">A+ Content Images</option>
            <option value="Ads Images" id="ads-images-option">Ads Images</option>
            <option value="Unedited Images" id="unedited-images-option">Unedited Images</option>
          </select>
        </div>

        <div class="col s3">
          <a href="#upload-image-modal" id="import-btn" class="modal-trigger">  
            <i class="material-icons" title="Add Image" style="
              color: gray;
              background-color: white;
              padding: 8px;
              margin-top: 15px;">
              add_photo_alternate
            </i>
          </a>
        </div>
      </div> 

      <div class="row" style="position: relative;bottom: 15px;right: 5px;">
        <div id="graphics-section" class="col s12" style="width: 94%;padding-top: 1.11em;">
        
        </div>
      </div>
    </div>

    <div class="col s8 center" style="position: relative; right: 30px;">
      <ul class="scroll-style-2 tabs">
        <li class="active tab"><a href="#vital">VITAL</a></li>
        <li class="tab"><a id="information-tab" href="#information">INFORMATION</a></li>
        <li class="tab"><a href="#dimensions">DIMENSIONS</a></li>
        <li class="tab"><a href="#attributes">ATTRIBUTES</a></li>
        <li class="tab"><a href="#variation">VARIATION</a></li>
        <li class="tab"><a href="#offer">OFFER</a></li>
        <li class="tab"><a href="#pfl">PFL</a></li>
      </ul>

      <div class="scroll-style-1 tab-content">
        <div class="tab-pane active" id="vital">
          <h4>VITAL</h4> 
          <div class="row white" style="margin-bottom: 0em;padding-top: 0em !important;padding-bottom: 0em !important;">
            <div class="input-field col s12" style="margin-top:40px !important;">
              <input id="product-name-sap" type="text">
               <label for="product-name-sap">Product Title SAP</label>
            </div>

            <div class="input-field col s12">
              <input id="product-name-amazon-uk" type="text">
              <label for="product-name-amazon-uk">Product Title Amazon UK</label>
            </div>

            <div class="input-field col s12">
              <input id="product-name-amazon-uae" type="text">
              <label for="product-name-amazon-uae">Product Title Amazon UAE</label>
            </div>

            <div class="input-field col s12">
              <input id="product-name-ebay" type="text">
              <label for="product-name-ebay">Product Title Ebay</label>
            </div>
          </div>

          <div class="row white" style="margin-bottom: 0em;padding-top: 0em !important;padding-bottom: 0em !important;">
            <div class="input-field col s6">
              <input id="category" type="text">
              <label for="category">Category</label>
            </div>
          
            <div class="input-field col s6">
              <input id="subtitle" type="text">
              <label for="subtitle">Subtitle</label>
            </div>
          </div>

          <div class="row white" style="margin-bottom: 0em;padding-top: 0em !important;padding-bottom: 0em !important;">
            <div class="input-field col s6">
              <input id="brand-name" type="text" >
              <label for="brand-name">Brand Name</label>
            </div>

            <div class="input-field col s6">
              <input id="manufacturer" type="text" >
              <label for="manufacturer">Manufacturer</label>
            </div>
          </div>

          <div class="row white" style="margin-bottom: 0em;padding-top: 0em !important;padding-bottom: 0em !important;">
            <div class="input-field col s6">
              <input id="product-id" type="text" >
              <label for="product-id">Product ID</label>
            </div>

            <div class="input-field col s6">
              <select id="product-id-type">
              </select>
              <label for="product-id-type">Product ID Type</label>
            </div>    
          </div>

          
          <div class="row white" style="margin-bottom: 0em;padding-top: 0em !important;padding-bottom: 0em !important;">
            <div class="input-field col s6">
              <input id="seller-sku" type="text">
              <label for="seller-sku">Seller SKU</label>
            </div>

            <div class="input-field col s6">
              <input id="manufacturer-part-number" type="text" >
              <label for="manufacturer-part-number">Manufacturer Part Number</label>
            </div>
          </div>



          <div class="row white" style="margin-bottom: 0em;padding-top: 0em !important;padding-bottom: 0em !important;">
            <div class="input-field col s6">
              <select id="condition-type">
                <option value="New" selected>New</option>
                <option value="Old">Old</option>
              </select>
              <label for="condition-type">Condition Type</label>
            </div>

            <div class="input-field col s6">
              <input id="feed-product-type" type="text">
              <label for="feed-product-type">Feed Product Type</label>
            </div>
          </div>


          <div class="row white" style="margin-bottom: 0em;padding-top: 0em !important;padding-bottom: 0em !important;">
            <div class="input-field col s6">
              <select id="update-delete">
                <option value="Update" selected>Update</option>
                <option value="Delete">Delete</option>
              </select>
              <label for="update-delete">Update Delete</label>
            </div>

            <div class="input-field col s6">
              <input id="recommended-browse-nodes" type="text" >
              <label for="recommended-browse-nodes">Recommended Browse Nodes</label>
            </div>
          </div>
          
          <div class="row white" style="margin-bottom: 0em;padding-top: 0em !important;padding-bottom: 0em !important;">
            <div class="input-field col s6">
              <input id="barcode-string" type="text" >
              <label for="barcode-string">Barcode</label>
            </div>
          </div>
        </div>


        <div class="tab-pane" id="information">
          <h4>Information</h4> 
          <div class="row white" style="position: relative;padding-bottom:0em !important;margin-bottom: 0em;">
            <span style="position: absolute;top: 20px;left: 30px;color: gray;">Product Description - HTML Editor</span>
            <br>
            <div class="col s12">
              <ul class="tabs">
                <li class="tab col s4"><a class="active" href="#amazon_uk_description_div">Amazon UK</a></li>
                <li class="tab col s4"><a href="#amazon_uae_description_div">Amazon UAE</a></li>
                <li class="tab col s4"><a href="#ebay_description_div">Ebay</a></li>
              </ul>
            </div>
        
            <div id="amazon_uk_description_div">
              <div class="input-field col s12" style="text-align: left;">
                <div class="document-editor">
                  <div class="document-editor__toolbar"></div>
                  <div class="document-editor__editable-container">
                    <div class="document-editor__editable">
                    </div>
                  </div>
                </div>
              </div>  

              <div class="input-field col s9">
                <input id="product-attribute-amazon-uk-1" type="text" >
                <label for="product-attribute-amazon-uk-1">Product Attribute</label>
              </div>

              <div class="input-field col s1">
                <a id="add-product-attribute-amazon-uk-btn" href="#!" class="btn-floating blue" style="background-color: #512ea8 !important; transform: scale(0.7);box-shadow: none;"><i class="material-icons">add</i></a>
              </div>

              <div id="product-attributes-amazon-uk-div"> 
              </div>  
            </div>

            <div id="amazon_uae_description_div">
              <div class="input-field col s12" style="text-align: left;">
                <div class="document-editor">
                  <div class="document-editor__toolbar clone2_toolbar"></div>
                  <div class="document-editor__editable-container clone2_container">
                    <div class="document-editor__editable clone2_editable">
                    </div>
                  </div>
                </div>
              </div>  

              <div class="input-field col s9">
                <input id="product-attribute-amazon-uae-1" type="text" >
                <label for="product-attribute-amazon-uae-1">Product Attribute</label>
              </div>

              <div class="input-field col s1">
                <a id="add-product-attribute-amazon-uae-btn" href="#!" class="btn-floating blue" style="background-color: #512ea8 !important; transform: scale(0.7);box-shadow: none;"><i class="material-icons">add</i></a>
              </div>

              <div id="product-attributes-amazon-uae-div">
              </div>
            </div>

            <div id="ebay_description_div">

              <div class="input-field col s12" style="text-align: left;">
                <div class="document-editor">
                  <div class="document-editor__toolbar clone3_toolbar"></div>
                  <div class="document-editor__editable-container clone3_container">
                    <div class="document-editor__editable clone3_editable">
                    </div>
                  </div>
                </div>
              </div>  


              <div class="input-field col s9">
                <input id="product-attribute-ebay-1" type="text" >
                <label for="product-attribute-ebay-1">Product Attribute</label>
              </div>

              <div class="input-field col s1">
                <a id="add-product-attribute-ebay-btn" href="#!" class="btn-floating" style = "background-color: #512ea8 !important; transform: scale(0.7);box-shadow: none;"><i class="material-icons">add</i></a>
              </div>

              <div id="product-attributes-ebay-div">
              </div>
            </div>

            <div class="input-field col s12">
              <input id="search-terms" type="text" >
              <label for="search-terms">Search Terms</label>
            </div>    
          </div>

          <div class="row white" style="margin-top: 0em;margin-bottom: 0em;padding-top: 0em !important;padding-bottom: 0em !important;">

            <div class="input-field col s6">
              <input id="color-map" type="text" >
              <label for="color-map">Color Map</label>
            </div>

            <div class="input-field col s6">
              <input id="color" type="text" >
              <label for="color">Color</label>
            </div>
          </div>

          <div class="row white" style="margin-bottom: 0em;padding-top: 0em !important;padding-bottom: 0em !important;">
            <div class="input-field col s6">
              <input id="enclosure-material" type="text" >
              <label for="enclosure-material">Enclosure Material</label>
            </div>

            <div class="input-field col s6">
              <input id="cover-material-type" type="text" >
              <label for="cover-material-type">Cover Material Type</label>
            </div>
          </div>

          <div class="row white" style="margin-bottom: 0em;padding-top: 0em !important;padding-bottom: 0em !important;">
            <div class="input-field col s9">
              <input id="special-feature-1" type="text" >
              <label for="special-feature-1">Special Feature</label>
            </div>

            <div class="input-field col s1">
              <a id="add-special-feature-btn" href="#!" class="btn-floating blue" style = "background-color: #512ea8 !important; transform: scale(0.7);box-shadow: none;"><i class="material-icons">add</i></a>
            </div>

            <div id="special-features-div">
            </div>
          </div>
        </div>

        <div class="tab-pane" id="dimensions">
          <h4>Dimensions</h4> 
          <div class="row white" style="margin-bottom:0px !important;">
            
            <div class="col s12">
              <div class="row" style="margin-bottom:0px !important;padding-bottom: 0em !important;">
                <div class="input-field col s4" style="padding: 0px 20px 0px 40px  !important;">
                  <input id="package-length" type="number" >
                  <label for="package-length">Package Length</label>
                </div>
                
                <div class="input-field  col s2" style="padding: 0px 40px 0px 10px !important;">
                  <select id="package-length-metric">
                    <option selected value="">Unit</option>
                    <option value="FT">FT</option>
                    <option value="IN">IN</option>
                    <option value="CM">CM</option>
                    <option value="MM">MM</option>
                    <option value="M">M</option>
                  </select>
                </div>

                <div class="input-field col s4" style="padding: 0px 40px 0px 20px  !important;">
                  <input id="package-width" type="number" >
                  <label for="package-width">Package Width</label>
                </div>

                <div class="input-field col s2" style="padding: 0px 40px 0px 10px !important;">
                  <select id="package-width-metric">
                    <option selected value="">Unit</option>
                    <option value="FT">FT</option>
                    <option value="IN">IN</option>
                    <option value="CM">CM</option>
                    <option value="MM">MM</option>
                    <option value="M">M</option>
                  </select>
                </div>
              </div>

              <div class="row" style="margin-bottom:0px !important;padding-bottom: 0em !important;padding-top: 0em !important;">
                <div class="input-field col s4" style="padding: 0px 20px 0px 40px  !important;">
                  <input id="package-height" type="number" >
                  <label for="package-height">Package Height</label>
                </div>

                <div class="input-field col s2" style="padding: 0px 40px 0px 10px !important;">
                  <select id="package-height-metric">
                    <option selected value="">Unit</option>
                    <option value="FT">FT</option>
                    <option value="IN">IN</option>
                    <option value="CM">CM</option>
                    <option value="MM">MM</option>
                    <option value="M">M</option>
                  </select>
                </div>

                <div class="input-field col s4" style="padding: 0px 40px 0px 20px  !important;">
                  <input id="package-weight" type="number" >
                  <label for="package-weight">Package Weight</label>
                </div>

                <div class="input-field col s2"  style="padding: 0px 40px 0px 10px !important;">
                  <select id="package-weight-metric">
                    <option selected value="">Unit</option>
                    <option value="KG">KG</option>
                    <option value="LB">LB</option>
                    <option value="OZ">OZ</option>
                    <option value="MG">MG</option>
                    <option value="GR">GR</option>
                  </select>
                </div>
              </div>

              <div class="row" style="margin-bottom:0px !important;padding-bottom: 0em !important;padding-top: 0em !important;">
                <div class="input-field col s4" style="padding: 0px 20px 0px 40px  !important;">
                  <input id="shipping-weight" type="number" >
                  <label for="shipping-weight">Shipping Weight</label>
                </div>
                
                <div class="input-field col s2" style="padding: 0px 40px 0px 10px !important;">
                  <select id="shipping-weight-metric">
                    <option selected value="">Unit</option>
                    <option value="KG">KG</option>
                    <option value="LB">LB</option>
                    <option value="OZ">OZ</option>
                    <option value="MG">MG</option>
                    <option value="GR">GR</option>
                  </select>
                </div>


                <div class="input-field col s4" style="padding: 0px 40px 0px 20px  !important;">
                  <input id="item-display-weight" type="number" >
                  <label for="item-display-weight">Item Display Weight</label>
                </div>
                
                <div class="input-field col s2"  style="padding: 0px 40px 0px 10px !important;">
                  <select id="item-display-weight-metric">
                    <option selected value="">Unit</option>
                    <option value="KG">KG</option>
                    <option value="LB">LB</option>
                    <option value="OZ">OZ</option>
                    <option value="MG">MG</option>
                    <option value="GR">GR</option>
                  </select>
                </div>
              </div>

              <div class="row" style="margin-bottom:0px !important;padding-bottom: 0em !important;padding-top: 0em !important;">
                <div class="input-field col s4" style="padding: 0px 20px 0px 40px  !important;">
                  <input id="item-display-volume" type="number" >
                  <label for="item-display-volume">Item Display Volume</label>
                </div>
                
                <div class="input-field col s2" style="padding: 0px 40px 0px 10px !important;">
                  <select id="item-display-volume-metric">
                    <option selected value="">Unit</option>
                    <option value="cc">CC</option>
                    <option value="litres">L</option>
                    <option value="cubic-m">CUBIC-M</option>
                  </select>
                </div>


                <div class="input-field col s4" style="padding: 0px 40px 0px 20px  !important;">
                  <input id="item-display-length" type="number" >
                  <label for="item-display-length">Item Display Length</label>
                </div>
                
                <div class="input-field col s2"  style="padding: 0px 40px 0px 10px !important;">
                  <select id="item-display-length-metric">
                    <option selected value="">Unit</option>
                    <option value="FT">FT</option>
                    <option value="IN">IN</option>
                    <option value="CM">CM</option>
                    <option value="MM">MM</option>
                    <option value="M">M</option>
                  </select>
                </div>
              </div>

              <div class="row" style="margin-bottom:0px !important;padding-bottom: 0em !important;padding-top: 0em !important;">
                <div class="input-field col s4" style="padding: 0px 20px 0px 40px  !important;">
                  <input id="item-weight" type="number" >
                  <label for="item-weight">Item Weight</label>
                </div>
                
                <div class="input-field col s2" style="padding: 0px 40px 0px 10px !important;">
                  <select id="item-weight-metric">
                    <option selected value="">Unit</option>
                    <option value="KG">KG</option>
                    <option value="LB">LB</option>
                    <option value="OZ">OZ</option>
                    <option value="MG">MG</option>
                    <option value="GR">GR</option>
                  </select>
                </div>

                <div class="input-field col s4" style="padding: 0px 40px 0px 20px  !important;">
                  <input id="item-length" type="number" >
                  <label for="item-length">Item Length</label>
                </div>
                
                <div class="input-field col s2"  style="padding: 0px 40px 0px 10px !important;">
                  <select id="item-length-metric">
                    <option selected value="">Unit</option>
                    <option value="FT">FT</option>
                    <option value="IN">IN</option>
                    <option value="CM">CM</option>
                    <option value="MM">MM</option>
                    <option value="M">M</option>
                  </select>
                </div>
              </div>

              <div class="row" style="margin-bottom:0px !important;padding-bottom: 0em !important;padding-top: 0em !important;">
                <div class="input-field col s4" style="padding: 0px 20px 0px 40px  !important;">
                  <input id="item-width" type="number" >
                  <label for="item-width">Item Width</label>
                </div>

                <div class="input-field col s2" style="padding: 0px 40px 0px 10px !important;">
                  <select id="item-width-metric">
                    <option selected value="">Unit</option>
                    <option value="FT">FT</option>
                    <option value="IN">IN</option>
                    <option value="CM">CM</option>
                    <option value="MM">MM</option>
                    <option value="M">M</option>
                  </select>
                </div>

                <div class="input-field col s4" style="padding: 0px 40px 0px 20px  !important;">
                  <input id="item-height" type="number" >
                  <label for="item-height">Item Height</label>
                </div>
        
                <div class="input-field col s2 "  style="padding: 0px 40px 0px 10px !important;">
                  <select id="item-height-metric">
                    <option selected value="">Unit</option>
                    <option value="FT">FT</option>
                    <option value="IN">IN</option>
                    <option value="CM">CM</option>
                    <option value="MM">MM</option>
                    <option value="M">M</option>
                  </select>
                </div>
              </div>

              <div class="row" style="margin-bottom:0px !important;padding-bottom: 0em !important;padding-top: 0em !important;">
                <div class="input-field col s4" style="padding: 0px 20px 0px 40px  !important;">
                  <input id="item-display-width" type="number" >
                  <label for="item-display-width">Item Display Width</label>
                </div>
                
                <div class="input-field col s2" style="padding: 0px 40px 0px 10px !important;">
                  <select id="item-display-width-metric">
                    <option selected value="">Unit</option>
                    <option value="FT">FT</option>
                    <option value="IN">IN</option>
                    <option value="CM">CM</option>
                    <option value="MM">MM</option>
                    <option value="M">M</option>
                  </select>
                </div>

                <div class="input-field col s4" style="padding: 0px 40px 0px 20px  !important;">
                  <input id="item-display-height" type="number" >
                  <label for="item-display-height">Item Display Height</label>
                </div>
                
                <div class="input-field col s2"  style="padding: 0px 40px 0px 10px !important;">
                  <select id="item-display-height-metric">
                    <option selected value="">Unit</option>
                    <option value="FT">FT</option>
                    <option value="IN">IN</option>
                    <option value="CM">CM</option>
                    <option value="MM">MM</option>
                    <option value="M">M</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="tab-pane" id="attributes">
          <h4>Attributes</h4> 
          <div class="row white" style="margin-bottom: 0em;padding-top:0em !important;padding-bottom:0em !important;">
            <div class="input-field col s12">
              <input id="item-condition-note" type="text" >
              <label for="item-condition-note">Item Condition Note</label>
            </div>
          </div>
    
          <div class="row white" style="margin-bottom: 0em;padding-top:0em !important;padding-bottom:0em !important;">
            <div class="input-field col s6">
              <input id="max-order-quantity" type="text" >
              <label for="max-order-quantity">Max Order Quantity</label>
            </div>

            <div class="input-field col s6">
              <input id="number-of-items" type="text" >
              <label for="number-of-items">Number of Items</label>
            </div>
          </div>
      
          <div class="row white" style="margin-bottom: 0em;padding-top:0em !important;padding-bottom:0em !important;">
          
            <div class="input-field col s4" style="padding: 0px 20px 0px 50px  !important;">
               <input id="wattage" type="number" >
              <label for="wattage">Wattage</label>
            </div>
          
            <div class="input-field col s2" style="padding: 0px 40px 0px 10px !important;">
              <select id="wattage-metric">
                <option selected value="">Unit</option>
                <option value="volts">V</option>
                <option value="Watts">W</option>
                <option value="Kilowatts">KW</option>
              </select>
            </div>

            <div class="input-field col s6">
              <input id="material-type" type="text" >
              <label for="material-type">Material Type</label>
            </div>
          </div>  
        </div>

        <div class="tab-pane" id="variation">
          <h4>Variation</h4> 
          <div class="row white" style="margin-bottom: 0em;padding-bottom: 0em !important;padding-top: 0em !important;">
            <div class="input-field col s6">
              <input id="parentage" type="text" >
              <label for="parentage">Parentage</label>
            </div>

            <div class="input-field col s6">
              <input id="parent-sku" type="text" >
              <label for="parent-sku">Parent SKU</label>
            </div>
          </div>

          <div class="row white" style="margin-bottom: 0em;padding-bottom: 0em !important;padding-top: 0em !important;">
            <div class="input-field col s6">
              <input id="relationship-type" type="text" >
              <label for="relationship-type">Relationship Type</label>
            </div>

            <div class="input-field col s6">
              <input id="variation-theme" type="text" >
              <label for="variation-theme">Variation Theme</label>
            </div>
          </div>
        </div>

        <div class="tab-pane" id="offer">
          <h4>Offer</h4> 
          <div class="row white" style="margin-bottom: 0em;padding-bottom: 0em !important;padding-top: 0em !important;">
            <div class="input-field col s6">
              <input id="standard-price" type="number" >
              <label for="standard-price">Standard Price</label>
            </div>

            <div class="input-field col s6">
              <input id="quantity" type="number" >
              <label for="quantity">Quantity</label>
            </div>
          </div>

          <div class="row white" style="margin-bottom: 0em;padding-bottom: 0em !important;padding-top: 0em !important;">
            <div class="input-field col s6">
              <input id="sale-price" type="number" >
              <label for="sale-price">Sale Price</label>
            </div>

            <div class="input-field col s6">
              <input id="sale-from" type="date" >
              <label for="sale-from">Sale From</label>
            </div>
          </div>

          <div class="row white" style="margin-bottom: 0em;padding-bottom: 0em !important;padding-top: 0em !important;">
            <div class="input-field col s6">
              <input id="sale-end" type="date" >
              <label for="sale-end">Sale End</label>
            </div>
          </div>
        </div>

        <div class="tab-pane" id="pfl">
          <h4>PFL</h4> 
          <div class="row white" style="margin-bottom:0px !important;">
            <div class="input-field col s12">
              <input id="pfl-product-name" type="text" >
              <label for="pfl-product-name">PFL Product Name</label>
            </div>

            <div id="feature-summary-editor-div" class="row">
              <div class="input-field col s9">
                <input class="feature-text" id="pfl-feature-1" type="text" >
                <label for="pfl-feature-1">Feature</label>
              </div>

              <div class="input-field col s1">
                <a id="add-feature-btn" href="#!" class="btn-floating blue" style="background-color: #512ea8 !important; transform: scale(0.7);box-shadow: none;"><i class="material-icons">add</i></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<div id="upload-image-modal" class="modal">
  <div class="modal-content">
    <h4 style="font-family:'AvenirNext';font-size:18px;">Upload Image</h4>
    <div class="file-field input-field">
      <div class="btn" style = "background-color: #512da8">
        <span style="font-size:14px;">File</span>
        <input id="product-image-input" type="file" multiple>
      </div>
      <div class="file-path-wrapper">
        <input class="file-path validate" type="text">
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <a href="#!" class="modal-close waves-effect waves-green btn-flat">Cancel</a>
    <a id="upload-image-btn" href="#!" class="waves-effect waves-green btn-flat blue white-text" style="background-color:#009051 !important ;">Upload</a>
  </div>
</div>


<div id="delete-image-modal" class="modal">
  <div class="modal-content">
    <h4 style="font-family:'AvenirNext';font-size:18px;">Are you sure you want to delete the image?</h4>
  </div>
  <div class="modal-footer">
    <a href="#!" class="modal-close waves-effect waves-green btn-flat">Cancel</a>
    <a id="delete-image-btn" href="#!" class="red waves-effect waves-red btn-flat white-text">Delete</a>
  </div>
</div>



<div class="toolbar" style="position: fixed; top: 0px; left: 0px;padding:20px 5px 20px 5px; height: 100vh; background-color: white;">
  <a class="right" href = "#!" onclick="window.close()" style="background-color: transparent;display: block;cursor: pointer;">
    <i class="material-icons redd" title="Close" style="
      background-color: #f7f7f7;
      padding: 8px;
      color: gray;
      border-radius: 5px;
      margin-left: 8px;
      font-size: 20px;
      margin-right: 9px;
      display: block;
      margin-bottom: 10px;">
      close
    </i> 
  </a>
  </br>

  <a class="right" href = "/products" style="background-color: transparent;display: block;cursor: pointer;">
    <i class="material-icons homee" title="Products" style="
      background-color: #f7f7f7;
      padding: 8px;
      color: gray;
      border-radius: 5px;
      margin-left: 8px;
      font-size: 20px;
      margin-right: 9px;
      display: block;
      margin-bottom: 10px;">
      select_all
    </i> 
  </a> 

  <div style="background-color: transparent; position: absolute;bottom: 15px;right: 4px;">
    <a id="pfl-editor-link" href="#!" class=" right" style="background-color: transparent;display: block;">    
      <i class="material-icons maroonn" title="PFL Editor" style="
        color: gray;
        background-color: #f7f7f7;
        padding: 8px;
        border-radius: 5px;
        margin-left: 8px;
        font-size: 20px;
        margin-right: 9px;
        display: block;margin-bottom: 10px;">
        vertical_split
      </i> 
    </a> 

    <a href="#!" class=" right" style="background-color: transparent;display: block;">
      <i id="pending-icon" class="material-icons yelloww" title="Pending" style="
        background-color: #f7f7f7;
        padding: 8px;
        color: gray;
        border-radius: 5px;
        margin-left: 8px;
        font-size: 20px;
        margin-right: 9px;
        display: block;
        margin-bottom: 10px;">
        timer
      </i>
    </a> 

    <a href="#!" class=" right" style="background-color: transparent;display: block;">
      <i id="verified-icon" class="material-icons greenn" title="Verified" style="
        background-color: #f7f7f7;
        padding: 8px;
        color: gray;
        border-radius: 5px;
        margin-left: 8px;
        font-size: 20px;
        margin-right: 9px;
        display: block;
        margin-bottom: 10px;">
        verified_user
      </i>
    </a> 

    <a href="#!" id="main-image-select-save-btn" class="right" style="background-color: transparent;display: block;">
      <i class="material-icons bluee" title="Set Cover Image" style="
        background-color: #f7f7f7;
        padding: 8px;
        color: gray;
        border-radius: 5px;
        margin-left: 8px;
        font-size: 20px;
        margin-right: 9px;
        display: block;
        margin-bottom: 10px;">
        burst_mode
      </i>
    </a>

    {% if perms.WAMSApp.change_product %}
      <a href="#!" id="save-btn" href="#import-modal" class="right" style="background-color: transparent;">
        <i class="material-icons purplee" title="Save" style="
          background-color: #f7f7f7;
          padding: 8px;
          color: gray;
          border-radius: 5px;
          margin-left: 8px;
          font-size: 20px;
          margin-right: 9px;
          display: block;
          margin-bottom: 10px;">
          save
        </i> 
      </a>
    {% endif %}
  </div>   
</div>
 

<div id="pfl-div" class="row white" style="display:none;height: 297mm;width: 210mm;">
  <!-- Brand Image Preview -->
  <div id="brand-image" class="col s6 offset-s6">
    <br>
    <img id="brand-image-img" src="" style="width: 73.5mm;margin-left:23mm;display: none;position: absolute;">
  </div>
  
  <!-- Product Image Preview -->
  <div class="col s12" style="text-align: center; position: absolute;width: 210mm;margin-top: 40mm;">
    <img id="pfl-product-image-preview-img" style="max-width: 90%;max-height: 130mm;object-fit: scale-down;display: none;background-size: 100% 100%;">
    <br>
  </div>

  <!-- Product Name Preview -->
  <div class="col s12" style="background-color:#521893;text-align: center;width: 210mm;padding-bottom: 1em;position: absolute;margin-top: 190mm;width:210mm;height: 20mm;">
    <div id="product-name-preview" class="white-text left" style="padding-left: 1em;text-transform: uppercase;margin-top: 6.4mm;font-size: 1.7em;font-family:'AvenirNextRegular';">
    </div>
  </div>

  <!-- Seller SKU Preview -->
  <div class="col s12" style="background-color:white;position: absolute;margin-top: 192.5mm;width:45mm;height: 15mm;margin-left: 156mm;text-align: center;">
    <span id="seller-sku-preview" style="font-size: 1.4em;font-family:'AvenirNextRegular'; line-height: 16mm;color:#521893;"></span>
  </div>

  <!-- Features Preview -->
  <div class="col s12" style="position: absolute;margin-top: 218mm;width: 10mm;">
    <span style="color:#521893;font-size: 1.4em;font-family: 'AvenirNext';padding-left: 1em;">Features</span>
  </div>
  <div class="col s12" style="margin-top: 215mm;">
    <div id="features-preview-div" style="padding-left: 1.3em;">
    </div>
  </div>


  <!-- Barcode Preview -->
  <div class="col s3" style="position: absolute;margin-top: 240mm;width:45mm;margin-left:152mm;">
    <br><br>
    <img id="barcode-image-preview-img" src="" style="display:none;width: 100%;">
  </div>
  
  <!-- Footer -->
  <div class="col s12" style="background-color:#521893;position: absolute;margin-top: 287mm;width:210mm;height: 10mm;">
    <div class="white-text" style="font-size: 1.1em;margin-top:-1mm;">
      <p class="right" style="color:#009051;font-size: 0.8em;color:white;font-family:'AvenirNextRegular';">For more information, please visit www.royalford.com</p>
    </div>
  </div>

</div>


<script type="text/javascript" src="{% static 'WAMSApp/js/html2canvas.js' %}"></script>
<script type="text/javascript" src="{% static 'WAMSApp/js/canvas2image.js' %}"></script>
<script type="text/javascript">
  var global_verification_status = false;
  var global_delete_image_pk = null;
  
  //Page reload prevent logic
  let savecounter = false;
  $('#save-btn').click(()=>{
    savecounter = false;
  })

  $('input').click(function(){
    savecounter = true;
  })

  function preventDefault(){
    if(savecounter) {
      alert('Please save the details before refreshing!');
    }
    else {
      window.close();
    }
  }

  $('#close-btn').click(function(){
    preventDefault();
  })

  window.addEventListener('beforeunload', function (e) {
    if(savecounter){
      e.preventDefault();
      e.returnValue = '';
    }
    else
      window.close();
  });

  $("#pending-icon").click(function(){
    if(global_verification_status) {
      set_verify(false);
      call_verify_api(0);
      global_verification_status = false;
    }
  });

  $("#verified-icon").click(function(){
    if(!global_verification_status)
    {
      set_verify(true);
      call_verify_api(1);
      global_verification_status = true;
    }
  });

  function call_verify_api(verify)
  {
    var fd = new FormData()
    fd.append("product_pk", window.location.pathname.split("/")[2]);
    fd.append("verify", verify);
    
    $.ajax({
      url: "/verify-product/",
      type: "POST",
      headers:{
        'X-CSRFToken':getCsrfToken()
      },
      processData: false,
      contentType: false,
      data: fd,
      success: function(response) {
        console.log("Success!", response);
        if(response["status"]==200)
        {
          if(verify==1)
          {
            M.toast({html: "Product status changed to verified"});
          }
          else
          {
            M.toast({html: "Product status changed to pending"});
          }
        }
      },
      error: function(xhr, textstatus, errorthrown) {
        console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
      }
    });
  }

  $(document).ready(function(){
    $('.tabs').tabs();
  });
        
  
  var pfl_feature_cnt = 2;
  
  $("#add-feature-btn").click(function(){
    var html_string = `<div class="feature-div">
                         <div class="input-field col s9">
                           <input class="feature-text" id="pfl-feature-`+pfl_feature_cnt+`" type="text" >
                           <label for="pfl-feature-`+pfl_feature_cnt+`">Feature</label>
                         </div>

                        <div class="input-field col s1">
                          <a href="#!" class="delete-feature-btn btn-floating red" style="transform: scale(0.7);box-shadow: none;"><i class="material-icons">remove</i></a>
                        </div>
                      </div>`;
    $("#feature-summary-editor-div").append(html_string);
    pfl_feature_cnt++;
  });


  $(document).on('click', ".delete-feature-btn", function(){
    $(this).parent().parent().remove();
  });

  // $('.pflspecific').hide(); 
  $('.tabs').tabs();
  $('.chips').chips();
  $('select').formSelect();
  $('.modal').modal();
  $('body').css('background-color', '#ebebeb');

  $("#heading-title").html("PRODUCT FORM");

  window.editor = []

  DecoupledEditor
  .create( document.querySelector( '.document-editor__editable' ), {
      cloudServices: {
      }
  } )
  .then( editor => {
      const toolbarContainer = document.querySelector( '.document-editor__toolbar' );

      toolbarContainer.appendChild( editor.ui.view.toolbar.element );
      //editor.isReadOnly = !response['edit_access'];
      window.editor.push(editor);
  } )
  .catch( err => {
      console.error( err );
  } );

   DecoupledEditor
  .create( document.querySelector( '.clone2_editable' ), {
      cloudServices: {
      }
  } )
  .then( editor => {
      const toolbarContainer = document.querySelector( '.clone2_toolbar' );

      toolbarContainer.appendChild( editor.ui.view.toolbar.element );
      //editor.isReadOnly = !response['edit_access'];
      window.editor.push(editor);
  } )
  .catch( err => {
      console.error( err );
  } );

   DecoupledEditor
  .create( document.querySelector( '.clone3_editable' ), {
      cloudServices: {
      }
  } )
  .then( editor => {
      const toolbarContainer = document.querySelector( '.clone3_toolbar' );

      toolbarContainer.appendChild( editor.ui.view.toolbar.element );
      //editor.isReadOnly = !response['edit_access'];
      window.editor.push(editor);
  } )
  .catch( err => {
      console.error( err );
  } );

  function getCsrfToken() {
    var CSRF_TOKEN = $('input[name="csrfmiddlewaretoken"]').val();
    return CSRF_TOKEN;
  }

  var global_images = {};
  var global_image_key = "main_images";

  function fetch_constant_values()
  {
    $.ajax({
      url: "/fetch-constant-values/",
      type: "POST",
      headers:{
        'X-CSRFToken':getCsrfToken()
      },
      data: {},
      success: function(response) {
        console.log("Success!", response);
        if(response["status"]==200)
        {
          var autocomplete_data = {}
          var material_list = response["material_list"];
          for(var i=0;i<material_list.length;i++) {
            autocomplete_data[material_list[i]["name"]] = null;
          }
          $('#material-type').autocomplete({
            data: autocomplete_data
          });

          autocomplete_data = {};
          var category_list = response["category_list"];
          for(var i=0;i<category_list.length;i++) {
            autocomplete_data[category_list[i]["name"]] = null;
          }
          $('#category').autocomplete({
            data: autocomplete_data
          });


          autocomplete_data = {};
          var brand_list = response["brand_list"];
          for(var i=0;i<brand_list.length;i++) {
            autocomplete_data[brand_list[i]["name"]] = null;
          }
          $('#brand-name').autocomplete({
            data: autocomplete_data
          });


          var product_id_type_list = response["product_id_type_list"];
          var html_string = `<option value="" selected>Choose Product ID Type</option>`;
          for(var i=0;i<product_id_type_list.length;i++)
          {
            html_string += `<option value="`+product_id_type_list[i]["name"]+`">`+product_id_type_list[i]["name"]+`</option>`
          }
          $("#product-id-type").html(html_string);
          $('select').formSelect();
        } 
        else
        {
          //M.toast({html:"Duplicate product detected!"});
        }
        //$("#save-btn").removeAttr("disabled");
      },
      error: function(xhr, textstatus, errorthrown) {
        console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
      }
    });
  }

  fetch_constant_values();

  $("#upload-image-btn").click(function(){
    
    $("#upload-image-btn").attr("disabled", "disabled");

    product_pk = window.location.pathname.split("/")[2];

    var fd = new FormData();

    fd.append("product_pk", product_pk);
    var product_image_input = document.getElementById("product-image-input");
    
    fd.append('image_count', product_image_input.files.length);
    for(var i=0;i<product_image_input.files.length;i++)
    {
      fd.append('image_'+i, product_image_input.files[i]);
    }	  
  
  
    fd.append('image_category', global_image_key);

    $.ajax({
      url: "/upload-product-image/",
      type: "POST",
      headers:{
        'X-CSRFToken':getCsrfToken()
      },
      processData: false,
      contentType: false,
      data: fd,
      success: function(response) {
        console.log("Success!", response);
        $("#upload-image-modal").modal("close");
        $("#upload-image-btn").removeAttr("disabled");
        fetch_product_details();
      },
      error: function(xhr, textstatus, errorthrown) {
        console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
      }
    });
  })

  function set_verify(verified)
  {
    if(verified==true)
    {
      $("#pending-icon").css("background-color", "#f7f7f7");
      $("#pending-icon").css("color", "gray");
      $("#verified-icon").css("background-color", "#009051");
      $("#verified-icon").css("color", "white"); 
    }
    else
    {
      $("#verified-icon").css("background-color", "#f7f7f7");
      $("#verified-icon").css("color", "gray"); 
      $("#pending-icon").css("background-color", "orange");
      $("#pending-icon").css("color", "white");
    }
  }

  function fetch_product_details()
  {
    $.ajax({
      url: "/fetch-product-details/",
      type: "POST",
      headers:{
        'X-CSRFToken':getCsrfToken()
      },
      data: {
        pk: window.location.pathname.split("/")[2]
      },
      success: function(response) {
        console.log("Success!", response);

        global_verification_status = response["verified"];

        if(response["verified"]==true)
        {
          set_verify(true);
        }
        else
        {
          set_verify(false);
        }

        $("#pfl-product-name").val(response["pfl_product_name"])
        var pfl_product_features = response["pfl_product_features"]
        $('.material-placeholder').remove();
        $('.main-image').append(`<img class = "preview-img materialboxed" src='`+response["repr_image_url"]+`'>`)
        $('.materialboxed').materialbox();

        for(var i = 0;i<pfl_product_features.length;i++)
        {
          $("#pfl-feature-"+(i+1)).val(pfl_product_features[i]);
          if((i+1)!=pfl_product_features.length)
          {
            $("#add-feature-btn").click();
          }
        }

        $("#product-name-amazon-uk").val(response["product_name_amazon_uk"]);
        $("#product-name-amazon-uae").val(response["product_name_amazon_uae"]);
        $("#product-name-sap").val(response["product_name_sap"]);
        $("#product-name-ebay").val(response["product_name_ebay"]);
        $("#category").val(response["category"]);
        $("#subtitle").val(response["subtitle"]);
        $("#brand-name").val(response["brand"]);
    	  $("#manufacturer").val(response["manufacturer"]);
    	  $("#product-id").val(response["product_id"]);
    	  $("#product-id-type").val(response["product_id_type"]);
    	  $("#seller-sku").val(response["seller_sku"]);
        $("#manufacturer-part-number").val(response["manufacturer_part_number"]);
        $("#barcode-string").val(response["barcode_string"]);
        $("#condition-type").val(response["condition_type"]);
        $("#feed-product-type").val(response["feed_product_type"]);  
        $("#update-delete").val(response["update_delete"]);
        $("#recommended-browse-nodes").val(response["recommended_browse_nodes"]);
          
        window.editor[0].setData(response["product_description_amazon_uk"]);
        window.editor[1].setData(response["product_description_amazon_uae"]);
        window.editor[2].setData(response["product_description_ebay"]);

        var product_attribute_list_amazon_uk = response["product_attribute_list_amazon_uk"];
        if(product_attribute_list_amazon_uk.length>0)
        {
          $("#product-attribute-amazon-uk-1").val(product_attribute_list_amazon_uk[0]);
        }
        for(var i=1;i<product_attribute_list_amazon_uk.length;i++)
        {
          $("#add-product-attribute-amazon-uk-btn").click();  
          $("#product-attribute-amazon-uk-"+(i+1)).val(product_attribute_list_amazon_uk[i]);
        }

        var product_attribute_list_amazon_uae = response["product_attribute_list_amazon_uae"];
        if(product_attribute_list_amazon_uae.length>0)
        {
          $("#product-attribute-amazon-uae-1").val(product_attribute_list_amazon_uae[0]);
        }
        for(var i=1;i<product_attribute_list_amazon_uae.length;i++)
        {
          $("#add-product-attribute-amazon-uae-btn").click();  
          $("#product-attribute-amazon-uae-"+(i+1)).val(product_attribute_list_amazon_uae[i]);
        }

        var product_attribute_list_ebay = response["product_attribute_list_ebay"];
        if(product_attribute_list_ebay.length>0)
        {
          $("#product-attribute-ebay-1").val(product_attribute_list_ebay[0]);
        }
        for(var i=1;i<product_attribute_list_ebay.length;i++)
        {
          $("#add-product-attribute-ebay-btn").click();  
          $("#product-attribute-ebay-"+(i+1)).val(product_attribute_list_ebay[i]);
        }
          
        $("#search-terms").val(response["search_terms"]);
        $("#color-map").val(response["color_map"]);
        $("#color").val(response["color"]);
        $("#enclosure-material").val(response["enclosure_material"]);
        $("#cover-material-type").val(response["cover_material_type"]);

        var special_features = response["special_features"];
        if(special_features.length>0)
        {
          $("#special-feature-1").val(special_features[0]);
        }
        for(var i=1;i<special_features.length;i++)
        {
          $("#add-special-feature-btn").click();  
          $("#special-feature-"+(i+1)).val(special_features[i]);
        }

        $("#special-feature").val(response["special_features"]);
        $("#package-length").val(response["package_length"]);
        $("#package-length-metric").val(response["package_length_metric"]);
        $("#package-width").val(response["package_width"]);
        $("#package-width-metric").val(response["package_width_metric"]);
        $("#package-height").val(response["package_height"]);
        $("#package-height-metric").val(response["package_height_metric"]);
        $("#package-weight").val(response["package_weight"]);
        $("#package-weight-metric").val(response["package_weight_metric"]);
        $("#shipping-weight").val(response["shipping_weight"]);
        $("#shipping-weight-metric").val(response["shipping_weight_metric"]);
        $("#item-display-weight").val(response["item_display_weight"]);
        $("#item-display-weight-metric").val(response["item_display_weight_metric"]);
        $("#item-display-volume").val(response["item_display_volume"]);
        $("#item-display-volume-metric").val(response["item_display_volume_metric"]);
        $("#item-display-length").val(response["item_display_length"]);
        $("#item-display-length-metric").val(response["item_display_length_metric"]);
        $("#item-weight").val(response["item_weight"]);
        $("#item-weight-metric").val(response["item_weight_metric"]);
        $("#item-length").val(response["item_length"]);
        $("#item-length-metric").val(response["item_length_metric"]);
        $("#item-width").val(response["item_width"]);
        $("#item-width-metric").val(response["item_width_metric"]);
        $("#item-height").val(response["item_height"]);
        $("#item-height-metric").val(response["item_height_metric"]);
        $("#item-display-width").val(response["item_display_width"]);
        $("#item-display-width-metric").val(response["item_display_width_metric"]);
        $("#item-display-height").val(response["item_display_height"]);
        $("#item-display-height-metric").val(response["item_display_height_metric"]);
        $("#item-condition-note").val(response["item_condition_note"]);
        $("#max-order-quantity").val(response["max_order_quantity"]);
        $("#number-of-items").val(response["number_of_items"]);
        $("#wattage").val(response["wattage"]); 
        $("#wattage-metric").val(response["wattage_metric"]);
        $("#material-type").val(response["material_type"]);
        $("#parentage").val(response["parentage"]);
        $("#parent-sku").val(response["parent_sku"]);
        $("#relationship-type").val(response["relationship_type"]);
        $("#variation-theme").val(response["variation_theme"]);
        $("#standard-price").val(response["standard_price"]);
        $("#quantity").val(response["quantity"]);
        $("#sale-price").val(response["sale_price"]);
        $("#sale-from").val(response["sale_from"]);
        $("#sale-end").val(response["sale_end"]);


        global_images = response["images"];

        $("#main-images-option").html("Main Images ("+global_images["main_images"].length+")");
        $("#sub-images-option").html("Sub Images ("+global_images["sub_images"].length+")");
        $("#pfl-images-option").html("PFL Images ("+global_images["pfl_images"].length+")");
        $("#pfl-generated-images-option").html("PFL Generated Images ("+global_images["pfl_generated_images"].length+")");
        $("#white-background-images-option").html("White Background Images ("+global_images["white_background_images"].length+")");
        $("#lifestyle-images-option").html("Lifestyle Images ("+global_images["lifestyle_images"].length+")");
        $("#certificate-images-option").html("Certificate Images ("+global_images["certificate_images"].length+")");
        $("#giftbox-images-option").html("Giftbox Images ("+global_images["giftbox_images"].length+")");
        $("#diecut-images-option").html("Diecut Images ("+global_images["diecut_images"].length+")");
        $("#aplus-content-images-option").html("A+ Content Images ("+global_images["aplus_content_images"].length+")");
        $("#ads-images-option").html("Ads Images ("+global_images["ads_images"].length+")");
        $("#unedited-images-option").html("Unedited Images ("+global_images["unedited_images"].length+")");
        
        update_grid_images(global_image_key);

        //forpfl
        $('#brand-image-img').attr("src" , response["brand_logo"]); 
        $('#product-id-preview-data').text(response["product_id_type"])
        if(global_images["main_images"].length>0)
        {
          $('#pfl-product-image-preview-img').attr("src" , global_images["main_images"][0]["url"]);
        }  
        $('#barcode-image-preview-img').attr("src" , response["barcode"]);

        $("#pfl-editor-link").attr("href", "/pfl/"+response["pfl_pk"]);

        M.updateTextFields();
        $('select').formSelect();
      },
      error: function(xhr, textstatus, errorthrown) {
        console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
      }
    });
  }

  fetch_product_details();

  var product_attribute_amazon_uk_cnt = 1;
  $("#add-product-attribute-amazon-uk-btn").click(function(){
    product_attribute_amazon_uk_cnt++;
    
    var html_string = `<div>
                         <div class="input-field col s9">
                           <input id="product-attribute-amazon-uk-`+product_attribute_amazon_uk_cnt+`" type="text" >
                           <label for="product-attribute-amazon-uk-`+product_attribute_amazon_uk_cnt+`">Product Attribute</label>
                         </div>
                         <div class="input-field col s1">
                           <a href="#!" class="remove-product-attribute-amazon-uk-btn btn-floating red" style="background-color: red !important; transform: scale(0.7);box-shadow: none;"><i class="material-icons">delete</i></a>
                         </div>
                       </div>`
    $("#product-attributes-amazon-uk-div").append(html_string);
  });

  $(document).on("click", ".remove-product-attribute-amazon-uk-btn", function(){
    $(this).parent().parent().remove();
  });


  var product_attribute_amazon_uae_cnt = 1;
  $("#add-product-attribute-amazon-uae-btn").click(function(){
    product_attribute_amazon_uae_cnt++;

    var html_string = `<div>
                         <div class="input-field col s9">
                           <input id="product-attribute-amazon-uae-`+product_attribute_amazon_uae_cnt+`" type="text" >
                           <label for="product-attribute-amazon-uae-`+product_attribute_amazon_uae_cnt+`">Product Attribute</label>
                         </div>
                         <div class="input-field col s1">
                           <a href="#!" class="remove-product-attribute-amazon-uae-btn btn-floating red" style="background-color: red !important; transform: scale(0.7);box-shadow: none;"><i class="material-icons">delete</i></a>
                         </div>
                      </div>`
    $("#product-attributes-amazon-uae-div").append(html_string);
  });

  $(document).on("click", ".remove-product-attribute-amazon-uae-btn", function(){
    $(this).parent().parent().remove();
  });


  var product_attribute_ebay_cnt = 1;
  $("#add-product-attribute-ebay-btn").click(function(){
    product_attribute_ebay_cnt++;

    var html_string = `<div>
                         <div class="input-field col s9">
                           <input id="product-attribute-ebay-`+product_attribute_ebay_cnt+`" type="text" >
                           <label for="product-attribute-ebay-`+product_attribute_ebay_cnt+`">Product Attribute</label>
                         </div>
                         <div class="input-field col s1">
                           <a href="#!" class="remove-product-attribute-ebay-btn btn-floating red" style="background-color: red !important; transform: scale(0.7);box-shadow: none;"><i class="material-icons">delete</i></a>
                         </div>
                       </div>`
    $("#product-attributes-ebay-div").append(html_string);
  });

  $(document).on("click", ".remove-product-attribute-ebay-btn", function(){
    $(this).parent().parent().remove();
  });


  var special_feature_cnt = 1;
  $("#add-special-feature-btn").click(function(){
      special_feature_cnt++;

      var html_string = `<div>
                           <div class="input-field col s9">
                             <input id="special-feature-`+special_feature_cnt+`" type="text" >
                             <label for="special-feature-`+special_feature_cnt+`">Special Feature</label>
                           </div>

                           <div class="input-field col s1">
                             <a href="#!" class="remove-special-feature-btn btn-floating blue" style = "background-color: red !important; transform: scale(0.7);box-shadow: none;"><i class="material-icons">delete</i></a>
                           </div>
                        </div>`
      $("#special-features-div").append(html_string);
  });

  $(document).on("click", ".remove-special-feature-btn", function(){
    $(this).parent().parent().remove();
  });


  function update_grid_images_main_images(key)
  {
    var html_string = "";
    for(var i=0;i<global_images[key].length;i++)
    {
      var checked = "";
      if(global_images[key][i]["is_main_image"]==true) {
        checked = "checked";
      }
      
      if(i%3==0) {
        html_string += "<div class='flex-container-space-btw' style='margin-top:0em;margin-bottom:0em;padding-top:0em !important;padding-bottom:0em !important;width:25.5vw !important;'>";
      }

      html_string += `<div style=";position:relative;">
                        <a href="#delete-image-modal" id="delimg-`+global_images[key][i]["pk"]+`" class="delete-image-modal-btn modal-trigger right" style="position:absolute;top:4px;right:2px;z-index:100;background-color: transparent;display: block;cursor: pointer;" title="Delete Image">
                          <i class="material-icons redd" title="Delete Image" style="
                            background-color: transparent;
                            padding: 4px;
                            color: gray;
                            border-radius: 2px;
                            margin-left: 4px;
                            font-size: 10px;
                            margin-right: 4px;
                            display: block;
                            margin-bottom: 5px;">
                            close
                          </i>
                        </a>
                        <img class="miniimage" src="`+global_images[key][i]["thumbnail-url"]+`" midimage_url="`+global_images[key][i]["midimage-url"]+`" style="width: 100%;">
                        <label style="margin-left:0px !important;">
                          <input value="`+global_images[key][i]["pk"]+`" name="group1" type="radio" `+checked+` />
                          <span class = "checkbox"></span>
                        </label>
                      </div>`;

      if(i%3==2 || i==global_images[key].length-1) {
        html_string += "</div>";
      }
    }
         
    $("#graphics-section").html(html_string);
  }


  $(document).on('click', '.miniimage', function(){
    let url = $(this).attr('midimage_url');
    $('.material-placeholder').remove();
    $('.main-image').append(`<img class = "preview-img materialboxed" src = '`+ url +`'>`)
    $('.materialboxed').materialbox();
  });

  $(document).on("click", ".delete-image-modal-btn", function(){
    global_delete_image_pk = this.id.split("-")[1];
  })

  $("#delete-image-btn").click(function(){
    delete_image();
  })

  function delete_image()
  {
    var image_type = "";
    if(global_image_key=="sub_images" || global_image_key=="main_images")
    {
      image_type = "main_sub";
    }
    else
    {
      image_type = "other";
    }

    var fd = new FormData();
    fd.append("image_pk", global_delete_image_pk);
    fd.append("image_type", image_type);

    $.ajax({
      url: "/delete-image/",
      type: "POST",
      headers:{
        'X-CSRFToken':getCsrfToken()
      },
      processData: false,
      contentType: false,
      data: fd,
      success: function(response) {
        console.log("Success!", response);
        if(response["status"]==200)
        {
          M.toast({html:"Image deleted!"}); 
        } 
        else
        {
          M.toast({html:"Error deleting image!"});
        }
        $("#delete-image-modal").modal("close");
        fetch_product_details();
      },
      error: function(xhr, textstatus, errorthrown) {
        console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
      }
    });
  }

  $("#main-image-select-save-btn").click(function(){

    if(global_image_key!="main_images") {
      return;
    }

    var fd = new FormData();

    var checked_pk = $("input[name=group1]:checked").val();
    fd.append("checked_pk", checked_pk);
    fd.append("product_pk", window.location.pathname.split("/")[2]);

    $.ajax({
      url: "/update-main-image/",
      type: "POST",
      headers:{
        'X-CSRFToken':getCsrfToken()
      },
      processData: false,
      contentType: false,
      data: fd,
      success: function(response) {
        console.log("Success!", response);
        if(response["status"]==200)
        {
          M.toast({html:"Main image updated successfully!"}); 
        } 
        else
        {
          M.toast({html:"Error updating main image!"});
        }
      },
      error: function(xhr, textstatus, errorthrown) {
        console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
      }
    });
  });


  function update_grid_images_sub_images(key) {
    var html_string = "";
    for(var i=0;i<global_images[key].length;i++) {
      var checked = "";
      if(global_images[key][i]["is_sub_image"]==true) {
        checked = "checked";
      }

      if(i%3==0) {
        html_string += "<div class='flex-container-space-btw' style='margin-top:0em;margin-bottom:0em;padding-top:0em !important;padding-bottom:0em !important;width:25.5vw !important;'>";
      }

      html_string += `<div class="" style="position:relative;">
                        <a href="#delete-image-modal" id="delimg-`+global_images[key][i]["pk"]+`" class="delete-image-modal-btn modal-trigger right" style="position:absolute;top:4px;right:2px;z-index:100;background-color: transparent;display: block;cursor: pointer;" title="Delete Image">
                          <i class="material-icons redd" title="Delete Image" style="
                            background-color: transparent;
                            padding: 4px;
                            color: gray;
                            border-radius: 2px;
                            margin-left: 4px;
                            font-size: 10px;
                            margin-right: 4px;
                            display: block;
                            margin-bottom: 5px;">
                            close
                          </i>
                        </a>
                        <img class="miniimage" src="`+global_images[key][i]["thumbnail-url"]+`" midimage_url="`+global_images[key][i]["midimage-url"]+`" style="width: 100%;">
                        <input value="`+global_images[key][i]["sub_image_index"]+`" id="subcheck_`+global_images[key][i]["pk"]+`" type="text" >
                      </div>`;

      if(i%3==2 || i==global_images[key].length-1) {
        html_string += "</div>";
      }
    }
    $("#graphics-section").html(html_string);
  }

  function save_subimages_index() {
    if(global_image_key!="sub_images")
    {
      return;
    }
    var fd = new FormData();

    var sub_image = [];
    var key = "sub_images";

    for(var i=0;i<global_images[key].length;i++)
    {
      var temp_dict = {};
      temp_dict["pk"] = global_images[key][i]["pk"];
      temp_dict["sub_image_index"] = $("#subcheck_"+global_images[key][i]["pk"]).val();
      sub_image.push(temp_dict);
    }

    fd.append("sub_images", JSON.stringify(sub_image));
    fd.append("product_pk", window.location.pathname.split("/")[2]);

    $.ajax({
      url: "/update-sub-images/",
      type: "POST",
      headers:{
        'X-CSRFToken':getCsrfToken()
      },
      processData: false,
      contentType: false,
      data: fd,
      success: function(response) {
        console.log("Success!", response);
        if(response["status"]==200)
        {
          //M.toast({html:"Sub images updated successfully!"}); 
        } 
        else
        {
          //M.toast({html:"Error updating sub images!"});
        }
      },
      error: function(xhr, textstatus, errorthrown) {
        console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
      }
    });
  }


  function update_grid_images(key)
  {
    if(key=="main_images")
    {
      update_grid_images_main_images(key);
      return;
    }


    if(key=="sub_images")
    {
      update_grid_images_sub_images(key);
      return;
    }


    var html_string = "";
    for(var i=0;i<global_images[key].length;i++)
    {
      html_string += `<div class="col s4" style="padding:1em;">
                        <div style="position:relative;">
                          <a href="#delete-image-modal" id="delimg-`+global_images[key][i]["pk"]+`" class="delete-image-modal-btn modal-trigger right" style="position:absolute;top:4px;right:2px;z-index:100;background-color: transparent;display: block;cursor: pointer;" title="Delete Image">
                            <i class="material-icons redd" title="Delete Image" style="
                              background-color: transparent;
                              padding: 4px;
                              color: gray;
                              border-radius: 2px;
                              margin-left: 4px;
                              font-size: 10px;
                              margin-right: 4px;
                              display: block;
                              margin-bottom: 5px;">
                              close
                            </i> 
                          </a> 
                          <img class="miniimage" src="`+global_images[key][i]["thumbnail-url"]+`" midimage_url="`+global_images[key][i]["midimage-url"]+`" style="width: 100%;">
                        </div>
                      </div>`;
    }

    $("#graphics-section").html(html_string);
  }



  $("#images-category").change(function(){
    
    if($("#images-category").val()=="Main Images")
    {
      update_grid_images("main_images"); 
      global_image_key = "main_images";
    }
    else if($("#images-category").val()=="Sub Images")
    {
      update_grid_images("sub_images");
      global_image_key = "sub_images";
    }
    else if($("#images-category").val()=="PFL Images")
    {
      update_grid_images("pfl_images");
      global_image_key = "pfl_images";
    }
    else if($("#images-category").val()=="PFL Generated Images")
    {
      update_grid_images("pfl_generated_images");
      global_image_key = "pfl_generated_images";
    }
    else if($("#images-category").val()=="White Background Images")
    {
      update_grid_images("white_background_images");
      global_image_key = "white_background_images";
    }
    else if($("#images-category").val()=="Lifestyle Images")
    {
      update_grid_images("lifestyle_images");
      global_image_key = "lifestyle_images";
    }
    else if($("#images-category").val()=="Certificate Images")
    {
      update_grid_images("certificate_images");
      global_image_key = "certificate_images";
    }
    else if($("#images-category").val()=="Giftbox Images")
    {
      update_grid_images("giftbox_images");
      global_image_key = "giftbox_images";
    }
    else if($("#images-category").val()=="Diecut Images")
    {
      update_grid_images("diecut_images");
      global_image_key = "diecut_images";
    }
    else if($("#images-category").val()=="A+ Content Images")
    {
      update_grid_images("aplus_content_images");
      global_image_key = "aplus_content_images";
    }
    else if($("#images-category").val()=="Ads Images")
    {
      update_grid_images("ads_images");
      global_image_key = "ads_images";
    }
    else if($("#images-category").val()=="Unedited Images")
    {
       update_grid_images("unedited_images");
      global_image_key = "unedited_images";
    }
  });


  function save_pfl_image_to_bucket()
  {
    var pfl_product_name = $("#pfl-product-name").val();

    var seller_sku = $("#seller-sku").val();

    var image_links = [];

    //Set the images
    if(global_images["main_images"].length>0)
    {
      $("#pfl-product-image-preview-img").attr("src", global_images["main_images"][0]["url"]);
    }

    $("#brand-image-img").attr("src", "");
    $("#barcode-image-preview-img").attr("src", "");


    if($("#pfl-product-image-preview-img").attr("src")!="")
    {
      image_links.push({
        "key": "product_image",
        "url": $("#pfl-product-image-preview-img").attr("src")
      });
    }

    if($("#brand-image-img").attr("src")!="")
    {
      image_links.push({
        "key": "brand_image",
        "url": $("#brand-image-img").attr("src")
      });
    }

    if($("#barcode-image-preview-img").attr("src")!="")
    {
      image_links.push({
        "key": "barcode_image",
        "url": $("#barcode-image-preview-img").attr("src")
      });
    }


    $("#seller-sku-preview").html(seller_sku);

    var html_string = `<br><br>`;
    var feature_text = $(".feature-text");
    for(var i=0;i<feature_text.length;i++)
    {
      html_string += `<span style="font-family: 'AvenirNextRegular'"><span style="color:#521893;">&bullet;&nbsp;&nbsp;</span> `+feature_text[i].value+`</span><br>`
    }
    $("#features-preview-div").html(html_string);

    $("#product-name-preview").text(pfl_product_name);


    $.ajax({
      url: "/download-images-s3/",
      type: "POST",
      headers:{
        'X-CSRFToken':getCsrfToken()
      },
      data: { 
        links : JSON.stringify(image_links)
      },
      success: function(response) {
        console.log("Success! ", response);
        if(response["status"]==200)
        {
          var local_links = response["local_links"];

          for(var i=0;i<response["local_links"].length;i++){
            if (local_links[i]["key"] == "product_image"){
              $("#pfl-product-image-preview-img").attr("src", local_links[i]["url"]);
              $("#pfl-product-image-preview-img").show();
            }
            else if(local_links[i]["key"] == "brand_image"){
              $("#brand-image-img").attr("src", local_links[i]["url"]);
            }
            else if(local_links[i]["key"] == "barcode_image"){
              $("#barcode-image-preview-img").attr("src", local_links[i]["url"]);
            }
          }

          $('#pfl-div').css("display" , "block");

          html2canvas($("#pfl-div"), {
            logging: true,
            dpi: 600,
            scale: 3,
            onrendered: function(canvas) {

              $("#pfl-div").hide();
              var image_data = canvas.toDataURL();

              var fd = new FormData();
              fd.append('image_data', image_data);
              fd.append('product_pk', window.location.pathname.split("/")[2]);

              $.ajax({
                url: "/save-pfl-in-bucket/",
                type: "POST",
                headers:{
                  'X-CSRFToken':getCsrfToken()
                },
                processData: false,
                contentType: false,
                data: fd,
                success: function(response) {
                  console.log("Success!", response);
                  if(response["status"]==200)
                  {
                    global_images["pfl_generated_images"] = [response["pfl_image_url"]];
                    update_grid_images(global_image_key);
                  }
                },
                error: function(xhr, textstatus, errorthrown) {
                  console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
                }
              });
            }
          });
        }
      },
      error: function(xhr, textstatus, errorthrown) {
        console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
      }
    });
  }

  function save_product()
  {
    save_pfl_image_to_bucket();

    $("#save-btn").attr("disabled", "disabled");
    
    var product_pk = window.location.pathname.split("/")[2];

    var pfl_product_name = $("#pfl-product-name").val();
    var pfl_product_features = [];
    for(var i=0;i<$(".feature-text").length;i++)
    {
      pfl_product_features.push($(".feature-text")[i].value);
    }

    var product_name_amazon_uk = $("#product-name-amazon-uk").val();
    var product_name_amazon_uae = $("#product-name-amazon-uae").val();
    var product_name_ebay = $("#product-name-ebay").val();
    var product_name_sap = $("#product-name-sap").val();
    var category = $("#category").val();
    var subtitle = $("#subtitle").val();
    var brand = $("#brand-name").val();
    var manufacturer = $("#manufacturer").val();
    var product_id = $("#product-id").val();
    var product_id_type = $("#product-id-type").val();
    var seller_sku = $("#seller-sku").val();
    var manufacturer_part_number = $("#manufacturer-part-number").val();
    var barcode_string = $("#barcode-string").val()
    var condition_type = $("#condition-type").val();
    var feed_product_type = $("#feed-product-type").val();  
    var update_delete = $("#update-delete").val();
    var recommended_browse_nodes = $("#recommended-browse-nodes").val();
    var product_description_amazon_uk = window.editor[0].getData();
    var product_description_amazon_uae = window.editor[1].getData();
    var product_description_ebay = window.editor[2].getData();


    var product_attribute_data_amazon_uk = [];
    for(var i=1;i<=product_attribute_amazon_uk_cnt;i++)
    {
      if($("#product-attribute-amazon-uk-"+i).val()!="")
      {
        product_attribute_data_amazon_uk.push($("#product-attribute-amazon-uk-"+i).val());
      } 
    }
    product_attribute_data_amazon_uk = JSON.stringify(product_attribute_data_amazon_uk);


    var product_attribute_data_amazon_uae = [];
    for(var i=1;i<=product_attribute_amazon_uae_cnt;i++)
    {
      if($("#product-attribute-amazon-uae-"+i).val()!="")
      {
        product_attribute_data_amazon_uae.push($("#product-attribute-amazon-uae-"+i).val());
      } 
    }
    product_attribute_data_amazon_uae = JSON.stringify(product_attribute_data_amazon_uae);


    var product_attribute_data_ebay = [];
    for(var i=1;i<=product_attribute_ebay_cnt;i++)
    {
      if($("#product-attribute-ebay-"+i).val()!="")
      {
        product_attribute_data_ebay.push($("#product-attribute-ebay-"+i).val());
      } 
    }
    product_attribute_data_ebay = JSON.stringify(product_attribute_data_ebay);


    var search_terms = $("#search-terms").val();
    var color_map = $("#color-map").val();
    var color = $("#color").val();
    var enclosure_material = $("#enclosure-material").val();
    var cover_material_type = $("#cover-material-type").val();


    var special_feature_data = [];
    for(var i=1;i<=special_feature_cnt;i++)
    {
      if($("#special-feature-"+i).val()!="")
      {
        special_feature_data.push($("#special-feature-"+i).val());
      }
    }

    var special_feature_data = JSON.stringify(special_feature_data);
    var package_length = $("#package-length").val();
    var package_length_metric = $("#package-length-metric").val();
    var package_width = $("#package-width").val();
    var package_width_metric = $("#package-width-metric").val();
    var package_height = $("#package-height").val();
    var package_height_metric = $("#package-height-metric").val();
    var package_weight = $("#package-weight").val();
    var package_weight_metric = $("#package-weight-metric").val();
    var shipping_weight = $("#shipping-weight").val();
    var shipping_weight_metric = $("#shipping-weight-metric").val();
    var item_display_weight = $("#item-display-weight").val();
    var item_display_weight_metric = $("#item-display-weight-metric").val();
    var item_display_volume = $("#item-display-volume").val();
    var item_display_volume_metric = $("#item-display-volume-metric").val();
    var item_display_length = $("#item-display-length").val();
    var item_display_length_metric = $("#item-display-length-metric").val();
    var item_weight = $("#item-weight").val();
    var item_weight_metric = $("#item-weight-metric").val();
    var item_length = $("#item-length").val();
    var item_length_metric = $("#item-length-metric").val();
    var item_width = $("#item-width").val();
    var item_width_metric = $("#item-width-metric").val();
    var item_height = $("#item-height").val();
    var item_height_metric = $("#item-height-metric").val();
    var item_display_width = $("#item-display-width").val();
    var item_display_width_metric = $("#item-display-width-metric").val();
    var item_display_height = $("#item-display-height").val();
    var item_display_height_metric = $("#item-display-height-metric").val();
    var item_condition_note = $("#item-condition-note").val();
    var max_order_quantity = $("#max-order-quantity").val();
    var number_of_items = $("#number-of-items").val();
    var wattage = $("#wattage").val(); 
    var wattage_metric = $("#wattage-metric").val();
    var material_type = $("#material-type").val();
    var parentage = $("#parentage").val();
    var parent_sku = $("#parent-sku").val();
    var relationship_type = $("#relationship-type").val();
    var variation_theme = $("#variation-theme").val();
    var standard_price = $("#standard-price").val();
    var quantity = $("#quantity").val();
    var sale_price = $("#sale-price").val();
    var sale_from = $("#sale-from").val();
    var sale_end = $("#sale-end").val();
    var product_pk = window.location.pathname.split("/")[2];

    var fd = new FormData();

    fd.append('pfl_product_name' , pfl_product_name)
    fd.append('pfl_product_features' , JSON.stringify(pfl_product_features));
    fd.append('product_pk', product_pk)
    fd.append('product_name_sap', product_name_sap);
    fd.append('product_name_amazon_uk', product_name_amazon_uk);
    fd.append('product_name_amazon_uae', product_name_amazon_uae);
    fd.append('product_name_ebay', product_name_ebay);
    fd.append('category', category);
    fd.append('subtitle', subtitle);
    fd.append('brand', brand);
    fd.append('manufacturer', manufacturer);
    fd.append('product_id', product_id);
    fd.append('product_id_type', product_id_type);
    fd.append('seller_sku',  seller_sku);
    fd.append('manufacturer_part_number', manufacturer_part_number);
    fd.append('barcode_string', barcode_string);
    fd.append('condition_type', condition_type);
    fd.append('feed_product_type', feed_product_type);
    fd.append('update_delete', update_delete);
    fd.append('recommended_browse_nodes', recommended_browse_nodes);
    fd.append('product_description_amazon_uk', product_description_amazon_uk);
    fd.append('product_description_amazon_uae', product_description_amazon_uae);
    fd.append('product_description_ebay', product_description_ebay);
    fd.append('product_attribute_list_amazon_uk', product_attribute_data_amazon_uk);
    fd.append('product_attribute_list_amazon_uae', product_attribute_data_amazon_uae);
    fd.append('product_attribute_list_ebay', product_attribute_data_ebay);
    fd.append('search_terms', search_terms);
    fd.append('color_map', color_map);
    fd.append('color', color);
    fd.append('enclosure_material', enclosure_material);
    fd.append('cover_material_type', cover_material_type);
    fd.append('special_features', special_feature_data);
    fd.append('package_length', package_length);
    fd.append('package_length_metric', package_length_metric);
    fd.append('package_width', package_width);
    fd.append('package_width_metric', package_width_metric);
    fd.append('package_height', package_height);
    fd.append('package_height_metric', package_height_metric);
    fd.append('package_weight', package_weight);
    fd.append('package_weight_metric', package_weight_metric);
    fd.append('shipping_weight', shipping_weight);
    fd.append('shipping_weight_metric', shipping_weight_metric);
    fd.append('item_display_weight', item_display_weight);
    fd.append('item_display_weight_metric', item_display_weight_metric);
    fd.append('item_display_volume', item_display_volume);
    fd.append('item_display_volume_metric', item_display_volume_metric);
    fd.append('item_display_length', item_display_length);
    fd.append('item_display_length_metric', item_display_length_metric);
    fd.append('item_weight', item_weight);
    fd.append('item_weight_metric', item_weight_metric);
    fd.append('item_length', item_length);
    fd.append('item_length_metric', item_length_metric);
    fd.append('item_width', item_width);
    fd.append('item_width_metric', item_width_metric);
    fd.append('item_height', item_height);
    fd.append('item_height_metric', item_height_metric);
    fd.append('item_display_width', item_display_width);
    fd.append('item_display_width_metric', item_display_width_metric);
    fd.append('item_display_height', item_display_height);
    fd.append('item_display_height_metric', item_display_height_metric);
    fd.append('item_condition_note', item_condition_note);
    fd.append('max_order_quantity', max_order_quantity);
    fd.append('number_of_items', number_of_items);
    fd.append('wattage', wattage);
    fd.append('wattage_metric', wattage_metric);
    fd.append('material_type', material_type);
    fd.append('parentage', parentage);
    fd.append('parent_sku', parent_sku);
    fd.append('relationship_type', relationship_type);
    fd.append('variation_theme', variation_theme);
    fd.append('standard_price', standard_price);
    fd.append('quantity', quantity);
    fd.append('sale_price', sale_price);
    fd.append('sale_from', sale_from);
    fd.append('sale_end', sale_end);

    $.ajax({
      url: "/save-product/",
      type: "POST",
      headers:{
        'X-CSRFToken':getCsrfToken()
      },
      processData: false,
      contentType: false,
      data: fd,
      success: function(response) {
        
        console.log("Success!", response);
        if(response["status"]==200)
        {
          M.toast({html:"Product saved successfully!"}); 
        } 
        else
        {
          M.toast({html:"Error saving product!"});
        }
        $("#save-btn").removeAttr("disabled");
      },
      error: function(xhr, textstatus, errorthrown) {
        console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
      }
    });

    save_subimages_index();
  }


  $("#save-btn").click(function(){
    if($("#product-name-sap").val()=="" || $("#product-id").val()=="" || $("#seller-sku").val()=="" || $("#brand-name").val()=="" || $("#product-name-sap").val()=="") {
     
    }
    save_product();
  });

  $("#information-tab").click(function(){
    setTimeout(function(){
      $('.tabs').tabs('updateTabIndicator');
    }, 100);
  });
</script>

{% endblock %}