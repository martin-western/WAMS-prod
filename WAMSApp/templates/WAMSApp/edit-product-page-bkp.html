{% extends 'WAMSApp/base.html' %}

{% block content %}

{% load static %}

<style type="text/css">
  .img-wrapper {
    position: relative;
  }

  .img-responsive {
    width: 100%;
    height: auto;
  }

  .img-overlay {
    position: absolute;
    top: 1em;
    bottom: 0;
    /*left: 0;*/
    right: 1em;
    text-align: center;
  }

  .img-overlay:before {
    content: ' ';
    display: block;
    height: 10%;
  }
</style>



<script src="https://cdn.ckeditor.com/ckeditor5/11.0.1/decoupled-document/ckeditor.js"></script>

<style type="text/css">
  .document-editor {
    border: 1px solid var(--ck-color-base-border);
    border-radius: var(--ck-border-radius);

    /* Set vertical boundaries for the document editor. */
    max-height: 40em;

    /* This element is a flex container for easier rendering. */
    display: flex;
    flex-flow: column nowrap;
  }

  .document-editor__toolbar {
    /* Make sure the toolbar container is always above the editable. */
    z-index: 1;

    /* Create the illusion of the toolbar floating over the editable. */
    box-shadow: 0 0 5px hsla(0, 0%, 0%, .2);

    /* Use the CKEditor CSS variables to keep the UI consistent. */
    border-bottom: 1px solid var(--ck-color-toolbar-border);
  }

  /* Adjust the look of the toolbar inside the container. */
  .document-editor__toolbar .ck-toolbar {
    border: 0;
    border-radius: 0;
  }


  /* Make the editable container look like the inside of a native word processor application. */
  .document-editor__editable-container {
    padding: calc(2 * var(--ck-spacing-large));
    background: var(--ck-color-base-foreground);

    /* Make it possible to scroll the "page" of the edited content. */
    overflow-y: scroll;
  }

  .document-editor__editable-container .ck-editor__editable {
    /* Set the dimensions of the "page". */
    width: 15.8cm;
    min-height: 21cm;

    /* Keep the "page" off the boundaries of the container. */
    padding: 1cm 2cm 2cm;

    border: 1px hsl(0, 0%, 82.7%) solid;
    border-radius: var(--ck-border-radius);
    background: white;

    /* The "page" should cast a slight shadow (3D illusion). */
    box-shadow: 0 0 5px hsla(0, 0%, 0%, .1);

    /* Center the "page". */
    margin: 0 auto;
  }


  /* Set the default font for the "page" of the content. */
  .document-editor .ck-content,
  .document-editor .ck-heading-dropdown .ck-list .ck-button__label {
    font: 16px/1.6 "Helvetica Neue", Helvetica, Arial, sans-serif;
  }



  /* Adjust the headings dropdown to host some larger heading styles. */
  .document-editor .ck-heading-dropdown .ck-list .ck-button__label {
    line-height: calc(1.7 * var(--ck-line-height-base) * var(--ck-font-size-base));
    min-width: 6em;
  }

  /* Scale down all heading previews because they are way too big to be presented in the UI.
    Preserve the relative scale, though. */
  .document-editor .ck-heading-dropdown .ck-list .ck-button:not(.ck-heading_paragraph) .ck-button__label {
    transform: scale(0.8);
    transform-origin: left;
  }

  /* Set the styles for "Heading 1". */
  .document-editor .ck-content h2,
  .document-editor .ck-heading-dropdown .ck-heading_heading1 .ck-button__label {
    font-size: 2.18em;
    font-weight: normal;
  }

  .document-editor .ck-content h2 {
    line-height: 1.37em;
    padding-top: .342em;
    margin-bottom: .142em;
  }

  /* Set the styles for "Heading 2". */
  .document-editor .ck-content h3,
  .document-editor .ck-heading-dropdown .ck-heading_heading2 .ck-button__label {
    font-size: 1.75em;
    font-weight: normal;
    color: hsl(203, 100%, 50%);
  }

  .document-editor .ck-heading-dropdown .ck-heading_heading2.ck-on .ck-button__label {
    color: var(--ck-color-list-button-on-text);
  }

  /* Set the styles for "Heading 2". */
  .document-editor .ck-content h3 {
    line-height: 1.86em;
    padding-top: .171em;
    margin-bottom: .357em;
  }

  /* Set the styles for "Heading 3". */
  .document-editor .ck-content h4,
  .document-editor .ck-heading-dropdown .ck-heading_heading3 .ck-button__label {
    font-size: 1.31em;
    font-weight: bold;
  }

  .document-editor .ck-content h4 {
    line-height: 1.24em;
    padding-top: .286em;
    margin-bottom: .952em;
  }

  /* Set the styles for "Paragraph". */
  .document-editor .ck-content p {
    font-size: 1em;
    line-height: 1.63em;
    padding-top: .5em;
    margin-bottom: 1.13em;
  }





  /* Make the block quoted text serif with some additional spacing. */
  .document-editor .ck-content blockquote {
    font-family: Georgia, serif;
    margin-left: calc(2 * var(--ck-spacing-large));
    margin-right: calc(2 * var(--ck-spacing-large));
  }
</style>


<br>
<div class="container" style="width: 95%;max-width: 100%;">
  <div class="row">

    <div class="col s12">
      <a href="#!" class="left" onclick="window.history.back()"><i class="material-icons"
          style="color:black;">arrow_back</i></a>
    </div>

    <div class="col s3">

      <div class="row">
        <div class="input-field col s12">
          <select id="images-category">
            <option value="Main Images">Main Images</option>
            <option value="Sub Images">Sub Images</option>
            <option value="PFL Images">PFL Images</option>
            <option value="PFL Generated Images">PFL Generated Images</option>
            <option value="White Background Images">White Background Images</option>
            <option value="Lifestyle Images">Lifestyle Images</option>
            <option value="Certificate Images">Certificate Images</option>
            <option value="Giftbox Images">Giftbox Images</option>
            <option value="Diecut Images">Diecut Images</option>
            <option value="A+ Content Images">A+ Content Images</option>
            <option value="Ads Images">Ads Images</option>
            <option value="Unedited Images">Unedited Images</option>
          </select>
        </div>
      </div>


      <div id="graphics-section" class="row">

      </div>

    </div>

    <div class="col s9 center">

      <h5>Edit Product</h5>
      <br>
      <h6><b>VITAL</b></h6>
      <br>
      <div class="row white" style="border: 1px solid grey;padding:1em;">

        <div class="input-field col s12">
          <input id="product-name-sap" type="text" class="validate">
          <label for="product-name-sap">Product Title SAP</label>
        </div>

        <div class="input-field col s4">
          <input id="product-name-amazon-uk" type="text" class="validate">
          <label for="product-name-amazon-uk">Product Title Amazon UK</label>
        </div>

        <div class="input-field col s4">
          <input id="product-name-amazon-uae" type="text" class="validate">
          <label for="product-name-amazon-uae">Product Title Amazon UAE</label>
        </div>

        <div class="input-field col s4">
          <input id="product-name-ebay" type="text" class="validate">
          <label for="product-name-ebay">Product Title Ebay</label>
        </div>


        <div class="input-field col s6">
          <input id="category" type="text" class="validate">
          <label for="category">Category</label>
        </div>

        <div class="input-field col s6">
          <input id="subtitle" type="text" class="validate">
          <label for="subtitle">Subtitle</label>
        </div>


        <div class="input-field col s6">
          <input id="brand-name" type="text" class="validate">
          <label for="brand-name">Brand Name</label>
        </div>

        <div class="input-field col s6">
          <input id="manufacturer" type="text" class="validate">
          <label for="manufacturer">Manufacturer</label>
        </div>


        <div class="input-field col s6">
          <input id="product-id" type="text" class="validate">
          <label for="product-id">Product ID</label>
        </div>

        <div class="input-field col s6">
          <select id="product-id-type">
          </select>
          <label for="product-id-type">Product ID Type</label>
        </div>




        <div class="input-field col s6">
          <input id="seller-sku" type="text" class="validate">
          <label for="seller-sku">Seller SKU</label>
        </div>

        <div class="input-field col s6">
          <input id="manufacturer-part-number" type="text" class="validate">
          <label for="manufacturer-part-number">Manufacturer Part Number</label>
        </div>




        <div class="input-field col s6">
          <select id="condition-type">
            <option value="New" selected>New</option>
            <option value="Old">Old</option>
          </select>
          <label for="condition-type">Condition Type</label>
        </div>

        <div class="input-field col s6">
          <input id="feed-product-type" type="text" class="validate">
          <label for="feed-product-type">Feed Product Type</label>
        </div>



        <div class="input-field col s6">
          <select id="update-delete">
            <option value="Update" selected>Update</option>
            <option value="Delete">Delete</option>
          </select>
          <label for="update-delete">Update Delete</label>
        </div>

        <div class="input-field col s6">
          <input id="recommended-browse-nodes" type="text" class="validate">
          <label for="recommended-browse-nodes">Recommended Browse Nodes</label>
        </div>

        <div class="input-field col s6">
          <input id="barcode-string" type="text" class="validate">
          <label for="barcode-string">Barcode String</label>
        </div>

      </div>


      <br>
      <h6><b>INFORMATION</b></h6>
      <br>
      <div class="row white" style="border: 1px solid grey;padding:1em;">
        <span class="col s12">Product Description</span>
        <br>
        <div class="col s12">
          <ul class="tabs">
            <li class="tab col s4"><a class="active" href="#amazon_uk_description_div">Amazon UK</a></li>
            <li class="tab col s4"><a href="#amazon_uae_description_div">Amazon UAE</a></li>
            <li class="tab col s4"><a href="#ebay_description_div">Ebay</a></li>
          </ul>
        </div>

        <div id="amazon_uk_description_div">
          <div class="input-field col s12">
            <div class="document-editor1">
              <div class="document-editor__toolbar"></div>
              <div class="document-editor__editable-container">
                <div class="document-editor__editable">
                </div>
              </div>
            </div>
          </div>


          <div class="input-field col s11">
            <input id="product-attribute-amazon-uk-1" type="text" class="validate">
            <label for="product-attribute-amazon-uk-1">Product Attribute 1</label>
          </div>

          <div class="input-field col s1">
            <a id="add-product-attribute-amazon-uk-btn" href="#!" class="btn-floating blue"><i
                class="material-icons">add</i></a>
          </div>

          <div id="product-attributes-amazon-uk-div">

          </div>

        </div>

        <div id="amazon_uae_description_div">
          <div class="input-field col s12">

          </div>

          <div class="input-field col s11">
            <input id="product-attribute-amazon-uae-1" type="text" class="validate">
            <label for="product-attribute-amazon-uae-1">Product Attribute 1</label>
          </div>

          <div class="input-field col s1">
            <a id="add-product-attribute-amazon-uae-btn" href="#!" class="btn-floating blue"><i
                class="material-icons">add</i></a>
          </div>

          <div id="product-attributes-amazon-uae-div">

          </div>


        </div>

        <div id="ebay_description_div">
          <div class="input-field col s12">

          </div>



          <div class="input-field col s11">
            <input id="product-attribute-ebay-1" type="text" class="validate">
            <label for="product-attribute-ebay-1">Product Attribute 1</label>
          </div>

          <div class="input-field col s1">
            <a id="add-product-attribute-ebay-btn" href="#!" class="btn-floating blue"><i
                class="material-icons">add</i></a>
          </div>

          <div id="product-attributes-ebay-div">

          </div>
        </div>




        <div class="input-field col s12">
          <input id="search-terms" type="text" class="validate">
          <label for="search-terms">Search Terms</label>
        </div>




        <div class="input-field col s6">
          <input id="color-map" type="text" class="validate">
          <label for="color-map">Color Map</label>
        </div>

        <div class="input-field col s6">
          <input id="color" type="text" class="validate">
          <label for="color">Color</label>
        </div>



        <div class="input-field col s6">
          <input id="enclosure-material" type="text" class="validate">
          <label for="enclosure-material">Enclosure Material</label>
        </div>

        <div class="input-field col s6">
          <input id="cover-material-type" type="text" class="validate">
          <label for="cover-material-type">Cover Material Type</label>
        </div>


        <div class="input-field col s11">
          <input id="special-feature-1" type="text" class="validate">
          <label for="special-feature-1">Special Feature 1</label>
        </div>

        <div class="input-field col s1">
          <a id="add-special-feature-btn" href="#!" class="btn-floating blue"><i class="material-icons">add</i></a>
        </div>

        <div id="special-features-div">

        </div>

      </div>



      <br>
      <h6><b>DIMENSIONS</b></h6>
      <br>
      <div class="row white" style="border: 1px solid grey;padding:1em;">

        <div class="input-field col s3">
          <input id="package-length" type="text" class="validate">
          <label for="package-length">Package Length</label>
        </div>
        <div class="input-field col s3">
          <select id="package-length-metric">
            <option value="FT">FT</option>
            <option value="IN">IN</option>
            <option value="CM">CM</option>
            <option value="MM">MM</option>
            <option value="M">M</option>
          </select>
        </div>


        <div class="input-field col s3">
          <input id="package-width" type="text" class="validate">
          <label for="package-width">Package Width</label>
        </div>
        <div class="input-field col s3">
          <select id="package-width-metric">
            <option value="FT">FT</option>
            <option value="IN">IN</option>
            <option value="CM">CM</option>
            <option value="MM">MM</option>
            <option value="M">M</option>
          </select>
        </div>











        <div class="input-field col s3">
          <input id="package-height" type="text" class="validate">
          <label for="package-height">Package Height</label>
        </div>
        <div class="input-field col s3">
          <select id="package-height-metric">
            <option value="FT">FT</option>
            <option value="IN">IN</option>
            <option value="CM">CM</option>
            <option value="MM">MM</option>
            <option value="M">M</option>
          </select>
        </div>


        <div class="input-field col s3">
          <input id="package-weight" type="text" class="validate">
          <label for="package-weight">Package Weight</label>
        </div>
        <div class="input-field col s3">
          <select id="package-weight-metric">
            <option value="KG">KG</option>
            <option value="LB">LB</option>
            <option value="OZ">OZ</option>
            <option value="MG">MG</option>
            <option value="GR">GR</option>
          </select>
        </div>













        <div class="input-field col s3">
          <input id="shipping-weight" type="text" class="validate">
          <label for="shipping-weight">Shipping Weight</label>
        </div>
        <div class="input-field col s3">
          <select id="shipping-weight-metric">
            <option value="KG">KG</option>
            <option value="LB">LB</option>
            <option value="OZ">OZ</option>
            <option value="MG">MG</option>
            <option value="GR">GR</option>
          </select>
        </div>


        <div class="input-field col s3">
          <input id="item-display-weight" type="text" class="validate">
          <label for="item-display-weight">Item Display Weight</label>
        </div>
        <div class="input-field col s3">
          <select id="item-display-weight-metric">
            <option value="KG">KG</option>
            <option value="LB">LB</option>
            <option value="OZ">OZ</option>
            <option value="MG">MG</option>
            <option value="GR">GR</option>
          </select>
        </div>












        <div class="input-field col s3">
          <input id="item-display-volume" type="text" class="validate">
          <label for="item-display-volume">Item Display Volume</label>
        </div>
        <div class="input-field col s3">
          <select id="item-display-volume-metric">
            <option value="FT">FT</option>
            <option value="IN">IN</option>
            <option value="CM">CM</option>
            <option value="MM">MM</option>
            <option value="M">M</option>
          </select>
        </div>


        <div class="input-field col s3">
          <input id="item-display-length" type="text" class="validate">
          <label for="item-display-length">Item Display Length</label>
        </div>
        <div class="input-field col s3">
          <select id="item-display-length-metric">
            <option value="FT">FT</option>
            <option value="IN">IN</option>
            <option value="CM">CM</option>
            <option value="MM">MM</option>
            <option value="M">M</option>
          </select>
        </div>












        <div class="input-field col s3">
          <input id="item-weight" type="text" class="validate">
          <label for="item-weight">Item Weight</label>
        </div>
        <div class="input-field col s3">
          <select id="item-weight-metric">
            <option value="KG">KG</option>
            <option value="LB">LB</option>
            <option value="OZ">OZ</option>
            <option value="MG">MG</option>
            <option value="GR">GR</option>
          </select>
        </div>


        <div class="input-field col s3">
          <input id="item-length" type="text" class="validate">
          <label for="item-length">Item Length</label>
        </div>
        <div class="input-field col s3">
          <select id="item-length-metric">
            <option value="FT">FT</option>
            <option value="IN">IN</option>
            <option value="CM">CM</option>
            <option value="MM">MM</option>
            <option value="M">M</option>
          </select>
        </div>












        <div class="input-field col s3">
          <input id="item-width" type="text" class="validate">
          <label for="item-width">Item Width</label>
        </div>
        <div class="input-field col s3">
          <select id="item-width-metric">
            <option value="FT">FT</option>
            <option value="IN">IN</option>
            <option value="CM">CM</option>
            <option value="MM">MM</option>
            <option value="M">M</option>
          </select>
        </div>


        <div class="input-field col s3">
          <input id="item-height" type="text" class="validate">
          <label for="item-height">Item Height</label>
        </div>
        <div class="input-field col s3">
          <select id="item-height-metric">
            <option value="FT">FT</option>
            <option value="IN">IN</option>
            <option value="CM">CM</option>
            <option value="MM">MM</option>
            <option value="M">M</option>
          </select>
        </div>






        <div class="input-field col s3">
          <input id="item-display-width" type="text" class="validate">
          <label for="item-display-width">Item Display Width</label>
        </div>
        <div class="input-field col s3">
          <select id="item-display-width-metric">
            <option value="FT">FT</option>
            <option value="IN">IN</option>
            <option value="CM">CM</option>
            <option value="MM">MM</option>
            <option value="M">M</option>
          </select>
        </div>


        <div class="input-field col s3">
          <input id="item-display-height" type="text" class="validate">
          <label for="item-display-height">Item Display Height</label>
        </div>
        <div class="input-field col s3">
          <select id="item-display-height-metric">
            <option value="FT">FT</option>
            <option value="IN">IN</option>
            <option value="CM">CM</option>
            <option value="MM">MM</option>
            <option value="M">M</option>
          </select>
        </div>


      </div>



      <br>
      <h6><b>ATTRIBUTES</b></h6>
      <br>
      <div class="row white" style="border: 1px solid grey;padding:1em;">
        <div class="input-field col s12">
          <input id="item-condition-note" type="text" class="validate">
          <label for="item-condition-note">Item Condition Note</label>
        </div>

        <div class="input-field col s6">
          <input id="max-order-quantity" type="text" class="validate">
          <label for="max-order-quantity">Max Order Quantity</label>
        </div>

        <div class="input-field col s6">
          <input id="number-of-items" type="text" class="validate">
          <label for="number-of-items">Number of Items</label>
        </div>


        <div class="input-field col s6">
          <input id="wattage" type="text" class="validate">
          <label for="wattage">Wattage</label>
        </div>
        <div class="input-field col s6">
          <select id="wattage-metric">
            <option value="Volts">Volts</option>
            <option value="Watts">Watts</option>
            <option value="Kilowatts">Kilowatts</option>
          </select>
        </div>


        <div class="input-field col s6">
          <input id="material-type" type="text" class="validate">
          <label for="material-type">Material Type</label>
        </div>
      </div>




      <br>
      <h6><b>VARIATION</b></h6>
      <br>
      <div class="row white" style="border: 1px solid grey;padding:1em;">
        <div class="input-field col s6">
          <input id="parentage" type="text" class="validate">
          <label for="parentage">Parentage</label>
        </div>

        <div class="input-field col s6">
          <input id="parent-sku" type="text" class="validate">
          <label for="parent-sku">Parent SKU</label>
        </div>



        <div class="input-field col s6">
          <input id="relationship-type" type="text" class="validate">
          <label for="relationship-type">Relationship Type</label>
        </div>

        <div class="input-field col s6">
          <input id="variation-theme" type="text" class="validate">
          <label for="variation-theme">Variation Theme</label>
        </div>
      </div>






      <br>
      <h6><b>OFFER</b></h6>
      <br>
      <div class="row white" style="border: 1px solid grey;padding:1em;">
        <div class="input-field col s6">
          <input id="standard-price" type="text" class="validate">
          <label for="standard-price">Standard Price</label>
        </div>

        <div class="input-field col s6">
          <input id="quantity" type="text" class="validate">
          <label for="quantity">Quantity</label>
        </div>



        <div class="input-field col s6">
          <input id="sale-price" type="text" class="validate">
          <label for="sale-price">Sale Price</label>
        </div>

        <div class="input-field col s6">
          <input id="sale-from" type="text" class="validate">
          <label for="sale-from">Sale From</label>
        </div>

        <div class="input-field col s6">
          <input id="sale-end" type="text" class="validate">
          <label for="sale-end">Sale End</label>
        </div>
      </div>


      <br>
      <h6><b>PFL</b></h6>
      <br>
      <div class="row white" style="border: 1px solid grey;padding:1em;">

        <div class="input-field col s12">
          <input id="pfl-product-name" type="text" class="validate">
          <label for="pfl-product-name">PFL Product Name</label>
        </div>

        <div class="input-field col s12">
          <p class="left">Features</p>
        </div>

        <div class="input-field col s12">
          <div id="feature-summary-editor-div" class="row" style="height: 15em;overflow-y:scroll;">
            <div class="feature-div">
              <div class="input-field col s10">
                <input style="border: 1px solid #E9E9E9;text-indent: 1em;" placeholder="Type features" type="text"
                  class="feature-text validate">
              </div>
              <div class="input-field col s2">
                <a id="add-feature-btn" class="btn-floating green"
                  style="margin-top:1em;height: 40px;width: 40px;position: relative;bottom: 15px;"><i
                    class="material-icons" style="font-size: 30px;position: absolute;top: 0px;left: 0px;">add</i></a>
              </div>
            </div>
          </div>
        </div>

        <div class="col s12">
          <a id="pfl-editor-link" href="#!" class="btn btn-small left">Open Editor</a>
        </div>

      </div>

      {% if perms.WAMSApp.change_product %}
      <a id="save-btn" class="btn">Save</a>
      {% endif %}

      <br><br><br>
    </div>
  </div>

</div>


<div id="upload-image-modal" class="modal">
  <div class="modal-content">
    <h4>Upload Image</h4>


    <div class="file-field input-field">
      <div class="btn">
        <span>File</span>
        <input id="product-image-input" type="file">
      </div>
      <div class="file-path-wrapper">
        <input class="file-path validate" type="text">
      </div>
    </div>

  </div>
  <div class="modal-footer">
    <a href="#!" class="modal-close waves-effect waves-green btn-flat">Cancel</a>
    <a id="upload-image-btn" href="#!" class="waves-effect waves-green btn-flat blue white-text">Upload</a>
  </div>
</div>


<!-- with hidden div -->
<!-- //pflhtml -->
<!-- <div style="position: fixed; top:50%; left: 50%; opacity: 0; pointer-events:none;">
     <div class="pflspecific" id = "pflcan2image">
      <div class="upperleft">
        <img class="brandlogo" src="survey.png" alt="" />
        <div class="ProductId"><p>ndnhfhb</p></div>
      </div>
      <div class="middle">
        <img src="survey.png" alt="" class="productimg" />
      </div>
      <div class="lower"></div>
    </div>

</div> -->

<!--  <div class="pflspecific" id = "pflcan2image">
      <div class="upperleft">
        <img class="brandlogo" src="survey.png" alt="" />
        <div class="ProductId"><p style="margin-top: 0px;">ndnhfhb</p></div>
      </div>
      <div class="middle">
        <img src="survey.png" alt="" class="productimg" />
        <div class="patti">
            <p class="pfl_name">
              Sandeep
            </p>
          </div>

          <div class="lower">
            <div class="leftside">
              fgjdnv
            </div>
            <div class="rightside">
              <img class="barcode" src="survey.png" alt="" />
            </div>
          </div>
          <hr />
          <p
            style="color:darkslategrey; text-align: right; margin: 0px 10px 0px 0px;"
          >
            For more information, please visit www.royalford.com
          </p>
      </div>
     
</div>
 -->

<!-- <span style = "font-family: 'AvenirNextRegular'">
  <span style="color:#521893;">&nbsp;&nbsp;</span>
</span>
<br/> -->


<div id="pfl-div" class="row white" style="height: 297mm;width: 210mm;display: none;">

  <div id="brand-image" class="col s6 offset-s6">
    <br>
    <img id="brand-image-img" src="" style="width: 73.5mm;margin-left:23mm;">
  </div>
  <!-- 
          <div class="col s4 offset-s8" style="margin-top: 1em; display: none;">
            <div id="product-id-main-div" style="padding-left: 1em;">
              <span id="product-id-preview-data" style="display: none;color:#00BCD4;text-align: center;font-size: 9px;width: 100%;"></span>
              <div id="product-id-preview" class="center" style="border: 1px solid black; border-style: dashed;"><h5>Product ID</h5></div>
            </div>
          </div> -->

  <div class="col s12" style="text-align: center; position: absolute;width: 210mm;margin-top: 40mm;">
    <img id="pfl-product-image-preview-img" src="" style="max-width: 90%;max-height: 130mm;object-fit: scale-down;">
  </div>


  <div class="col s12"
    style="background-color:#521893;text-align: center;width: 210mm;padding-bottom: 1em;position: absolute;margin-top: 190mm;width:210mm;height: 20mm;">
    <div id="product-name-preview" class="white-text left"
      style="padding-left: 1em;text-transform: uppercase;margin-top: 6.4mm;font-size: 1.7em;font-family:'AvenirNextRegular';">
    </div>
  </div>

  <div class="col s12"
    style="background-color:white;position: absolute;margin-top: 192.5mm;width:40mm;height: 15mm;margin-left: 156mm;text-align: center;">
    <span id="seller-sku-preview"
      style="font-size: 1.4em;font-family:'AvenirNextRegular'; line-height: 16mm;color:#521893;">RF8334</span>
  </div>


  <!-- Feature Section -->
  <div class="col s12" style="position: absolute;margin-top: 218mm;">
    <span style="color:#521893;font-size: 1.4em;font-family: 'AvenirNext';padding-left: 1em;">Features</span>
  </div>


  <div style="position: absolute;margin-top: 215mm;" class="col s9">
    <div id="features-preview-div" style="padding-left: 1.3em;">
    </div>
  </div>

  <div class="col s3" style="position: absolute;margin-top: 240mm;width:45mm;margin-left:152mm;">
    <br><br>
    <img id="barcode-image-preview-img" src="" style="width: 100%;">
  </div>

  <!-- Footer -->
  <div class="col s12" style="background-color:#521893;position: absolute;margin-top: 287mm;width:210mm;height: 10mm;">
    <div class="white-text" style="font-size: 1.1em;margin-top:-1mm;">
      <p class="right" style="color:#009051;font-size: 0.8em;color:white;font-family:'AvenirNextRegular';">For more
        information, please visit www.royalford.com</p>
    </div>
  </div>

</div>

<!--  <div id="pfl-div" class="col s8 offset-s4" style="background-color: #393939; display: none;">
      <div class="container" style="width: 85%;">
        
        <div class="row white" style="padding-left: 3%;padding-right: 3%;">
          
          <div id="brand-image" class="col s4 offset-s8">
            <img id="brand-image-img" src="/files/images/geepas-1.png" style="width: 100%;">
          </div>

          <div id="product-id-main-div" class="col s4 offset-s8" style="margin-top: 1em;">
            <h6 id="product-id-preview-data" style="color:#00BCD4;text-align: center;"></h6>
          </div>

          <div class="col s12" style="text-align: center;">
            <br>
            <img id="pfl-product-image-preview-img" src="/files/images/juicer.jpeg" style="width: 80%;">
          </div>

          
          <div class="col s12" style="background-color:#FFC400;text-align: center;margin-left: -3%;width: 106%;padding-bottom: 1em;">
            <br>
            <div id="product-name-preview">
            </div>
          </div>          


          <div id="features-preview-div" class="col s9">
            <br><br>
            <div id="feature-preview-container-div" style="border: 1px solid black; border-style: dashed; height: 10em;width: 80%;padding-top: 2em;" class="center">
              <h4>Product Features</h4>
            </div>
            <br><br>
          </div>

          <div class="col s3">
            <br><br>
            <img id="barcode-image-preview-img" src="/files/images/barcode.png" style="width: 100%;">
          
          </div>

          <div class="col s12">
            <hr style="width: 108%;margin-left: -4%;margin-bottom: 1em;color:#EAEAEA;">
          </div>

          <div class="col s12">
            <p class="right" style="color:#009051;margin-bottom: 1.5em;">For more information, please visit www.royalford.com</p>
          </div>

        </div>
      </div>
    </div> -->

<script type="text/javascript" src="{% static 'WAMSApp/js/html2canvas.js' %}"></script>
<script type="text/javascript" src="{% static 'WAMSApp/js/canvas2image.js' %}"></script>
<script type="text/javascript">

  $("#add-feature-btn").click(function () {
    var html_string = `<div class="feature-div">
                <div class="input-field col s10">
                  <input placeholder="Type features" type="text" class="feature-text validate">
                </div>
                <div class="input-field col s2">
                  <a class="delete-feature-btn btn-floating red"><i class="material-icons">remove</i></a>
                </div>
              </div>`;
    $("#feature-summary-editor-div").append(html_string);
  });


  $(document).on('click', ".delete-feature-btn", function () {
    $(this).parent().parent().remove();
  });


  // $('.pflspecific').hide(); 
  $('.tabs').tabs();
  $('.chips').chips();
  $('select').formSelect();
  $('.modal').modal();
  $('body').css('background-color', '#ebebeb');

  $("#heading-title").html("PRODUCT FORM");


  DecoupledEditor
    .create(document.querySelector('.document-editor__editable'), {
      cloudServices: {
      }
    })
    .then(editor => {
      const toolbarContainer = document.querySelector('.document-editor__toolbar');

      toolbarContainer.appendChild(editor.ui.view.toolbar.element);
      //editor.isReadOnly = !response['edit_access'];
      window.editor = editor;
    })
    .catch(err => {
      console.error(err);
    });

  function getCsrfToken() {
    var CSRF_TOKEN = $('input[name="csrfmiddlewaretoken"]').val();
    return CSRF_TOKEN;
  }

  var global_images = {};
  var global_image_key = "main_images";



  function fetch_constant_values() {
    $.ajax({
      url: "/fetch-constant-values/",
      type: "POST",
      headers: {
        'X-CSRFToken': getCsrfToken()
      },
      data: {},
      success: function (response) {
        console.log("Success!", response);
        if (response["status"] == 200) {
          var autocomplete_data = {}
          var material_list = response["material_list"];
          for (var i = 0; i < material_list.length; i++) {
            autocomplete_data[material_list[i]["name"]] = null;
          }
          $('#material-type').autocomplete({
            data: autocomplete_data
          });

          autocomplete_data = {};
          var category_list = response["category_list"];
          for (var i = 0; i < category_list.length; i++) {
            autocomplete_data[category_list[i]["name"]] = null;
          }
          $('#category').autocomplete({
            data: autocomplete_data
          });


          autocomplete_data = {};
          var brand_list = response["brand_list"];
          for (var i = 0; i < brand_list.length; i++) {
            autocomplete_data[brand_list[i]["name"]] = null;
          }
          $('#brand-name').autocomplete({
            data: autocomplete_data
          });


          var product_id_type_list = response["product_id_type_list"];
          var html_string = `<option value="" disabled selected>Choose Product ID Type</option>`;
          for (var i = 0; i < product_id_type_list.length; i++) {
            html_string += `<option value="` + product_id_type_list[i]["name"] + `">` + product_id_type_list[i]["name"] + `</option>`
          }
          $("#product-id-type").html(html_string);
          $('select').formSelect();
        }
        else {
          //M.toast({html:"Duplicate product detected!"});
        }
        //$("#save-btn").removeAttr("disabled");
      },
      error: function (xhr, textstatus, errorthrown) {
        console.log("Please report this error: " + errorthrown + xhr.status + xhr.responseText);
      }
    });
  }

  fetch_constant_values();




  $("#upload-image-btn").click(function () {

    $("#upload-image-btn").attr("disabled", "disabled");

    product_pk = window.location.pathname.split("/")[2];

    var fd = new FormData();

    fd.append("product_pk", product_pk);
    var product_image_input = document.getElementById("product-image-input");
    fd.append('image', product_image_input.files[0]);
    fd.append('image_category', global_image_key);

    $.ajax({
      url: "/upload-product-image/",
      type: "POST",
      headers: {
        'X-CSRFToken': getCsrfToken()
      },
      processData: false,
      contentType: false,
      data: fd,
      success: function (response) {
        console.log("Success!", response);
        $("#upload-image-modal").modal("close");
        $("#upload-image-btn").removeAttr("disabled");
        fetch_product_details();
      },
      error: function (xhr, textstatus, errorthrown) {
        console.log("Please report this error: " + errorthrown + xhr.status + xhr.responseText);
      }
    });
  })


  function fetch_product_details() {
    $.ajax({
      url: "/fetch-product-details/",
      type: "POST",
      headers: {
        'X-CSRFToken': getCsrfToken()
      },
      data: {
        pk: window.location.pathname.split("/")[2]
      },
      success: function (response) {
        console.log("Success!", response);
        $("#pfl-product-name").val(response["pfl_product_name"])

        var pfl_product_features = response["pfl_product_features"]
        // console.log(features)

        $($(".feature-text").get(0)).val(pfl_product_features[0]);

        for (var i = 1; i < pfl_product_features.length; i++) {
          var html_string = `<div class="feature-div">
                <div class="input-field col s10">
                  <input placeholder="Type features" type="text" value = "`+ pfl_product_features[i] + `" class="feature-text validate">
                </div>
                <div class="input-field col s2">
                  <a class="delete-feature-btn btn-floating red"><i class="material-icons">remove</i></a>
                </div>
              </div>`;
          $("#feature-summary-editor-div").append(html_string);
        }

        $("#product-name-amazon-uk").val(response["product_name_amazon_uk"]);
        $("#product-name-amazon-uae").val(response["product_name_amazon_uae"]);
        $("#product-name-sap").val(response["product_name_sap"]);
        $("#product-name-ebay").val(response["product_name_ebay"]);
        $("#category").val(response["category"]);
        $("#subtitle").val(response["subtitle"]);
        $("#brand-name").val(response["brand"]);
        $("#manufacturer").val(response["manufacturer"]);
        $("#product-id").val(response["product_id"]);
        $("#product-id-type").val(response["product_id_type"]);
        $("#seller-sku").val(response["seller_sku"]);
        $("#manufacturer-part-number").val(response["manufacturer_part_number"]);
        $("#barcode-string").val(response["barcode_string"]);
        $("#condition-type").val(response["condition_type"]);
        $("#feed-product-type").val(response["feed_product_type"]);
        $("#update-delete").val(response["update_delete"]);
        $("#recommended-browse-nodes").val(response["recommended_browse_nodes"]);

        window.editor.setData(response["product_description_amazon_uk"]);


        var product_attribute_list_amazon_uk = response["product_attribute_list_amazon_uk"];
        if (product_attribute_list_amazon_uk.length > 0) {
          $("#product-attribute-amazon-uk-1").val(product_attribute_list_amazon_uk[0]);
        }
        for (var i = 1; i < product_attribute_list_amazon_uk.length; i++) {
          $("#add-product-attribute-amazon-uk-btn").click();
          $("#product-attribute-amazon-uk-" + (i + 1)).val(product_attribute_list_amazon_uk[i]);
        }

        var product_attribute_list_amazon_uae = response["product_attribute_list_amazon_uae"];
        if (product_attribute_list_amazon_uae.length > 0) {
          $("#product-attribute-amazon-uae-1").val(product_attribute_list_amazon_uae[0]);
        }
        for (var i = 1; i < product_attribute_list_amazon_uae.length; i++) {
          $("#add-product-attribute-amazon-uae-btn").click();
          $("#product-attribute-amazon-uae-" + (i + 1)).val(product_attribute_list_amazon_uae[i]);
        }

        var product_attribute_list_ebay = response["product_attribute_list_ebay"];
        if (product_attribute_list_ebay.length > 0) {
          $("#product-attribute-ebay-1").val(product_attribute_list_ebay[0]);
        }
        for (var i = 1; i < product_attribute_list_ebay.length; i++) {
          $("#add-product-attribute-ebay-btn").click();
          $("#product-attribute-ebay-" + (i + 1)).val(product_attribute_list_ebay[i]);
        }

        $("#search-terms").val(response["search_terms"]);
        $("#color-map").val(response["color_map"]);
        $("#color").val(response["color"]);
        $("#enclosure-material").val(response["enclosure_material"]);
        $("#cover-material-type").val(response["cover_material_type"]);

        var special_features = response["special_features"];
        if (special_features.length > 0) {
          $("#special-feature-1").val(special_features[0]);
        }
        for (var i = 1; i < special_features.length; i++) {
          $("#add-special-feature-btn").click();
          $("#special-feature-" + (i + 1)).val(special_features[i]);
        }

        $("#special-feature").val(response["special_features"]);
        $("#package-length").val(response["package_length"]);
        $("#package-length-metric").val(response["package_length_metric"]);
        $("#package-width").val(response["package_width"]);
        $("#package-width-metric").val(response["package_width_metric"]);
        $("#package-height").val(response["package_height"]);
        $("#package-height-metric").val(response["package_height_metric"]);
        $("#package-weight").val(response["package_weight"]);
        $("#package-weight-metric").val(response["package_weight_metric"]);
        $("#shipping-weight").val(response["shipping_weight"]);
        $("#shipping-weight-metric").val(response["shipping_weight_metric"]);
        $("#item-display-weight").val(response["item_display_weight"]);
        $("#item-display-weight-metric").val(response["item_display_weight_metric"]);
        $("#item-display-volume").val(response["item_display_volume"]);
        $("#item-display-volume-metric").val(response["item_display_volume_metric"]);
        $("#item-display-length").val(response["item_display_length"]);
        $("#item-display-length-metric").val(response["item_display_length_metric"]);
        $("#item-weight").val(response["item_weight"]);
        $("#item-weight-metric").val(response["item_weight_metric"]);
        $("#item-length").val(response["item_length"]);
        $("#item-length-metric").val(response["item_length_metric"]);
        $("#item-width").val(response["item_width"]);
        $("#item-width-metric").val(response["item_width_metric"]);
        $("#item-height").val(response["item_height"]);
        $("#item-height-metric").val(response["item_height_metric"]);
        $("#item-display-width").val(response["item_display_width"]);
        $("#item-display-width-metric").val(response["item_display_width_metric"]);
        $("#item-display-height").val(response["item_display_height"]);
        $("#item-display-height-metric").val(response["item_display_height_metric"]);
        $("#item-condition-note").val(response["item_condition_note"]);
        $("#max-order-quantity").val(response["max_order_quantity"]);
        $("#number-of-items").val(response["number_of_items"]);
        $("#wattage").val(response["wattage"]);
        $("#wattage-metric").val(response["wattage_metric"]);
        $("#material-type").val(response["material_type"]);
        $("#parentage").val(response["parentage"]);
        $("#parent-sku").val(response["parent_sku"]);
        $("#relationship-type").val(response["relationship_type"]);
        $("#variation-theme").val(response["variation_theme"]);
        $("#standard-price").val(response["standard_price"]);
        $("#quantity").val(response["quantity"]);
        $("#sale-price").val(response["sale_price"]);
        $("#sale-from").val(response["sale_from"]);
        $("#sale-end").val(response["sale_end"]);


        global_images = response["images"];
        update_grid_images(global_image_key);

        //forpfl
        $('#brand-image-img').attr("src", response["brand_logo"]);
        $('#product-id-preview-data').text(response["product_id_type"])
        if (global_images["main_images"].length > 0) {
          $('#pfl-product-image-preview-img').attr("src", global_images["main_images"][0]["url"]);
        }
        $('#barcode-image-preview-img').attr("src", response["barcode"]);

        $("#pfl-editor-link").attr("href", "/pfl/" + response["pfl_pk"]);

        M.updateTextFields();
        $('select').formSelect();
      },
      error: function (xhr, textstatus, errorthrown) {
        console.log("Please report this error: " + errorthrown + xhr.status + xhr.responseText);
      }
    });
  }

  fetch_product_details();

  var product_attribute_amazon_uk_cnt = 1;
  $("#add-product-attribute-amazon-uk-btn").click(function () {
    product_attribute_amazon_uk_cnt++;

    var html_string = `<div class="input-field col s11">
        <input id="product-attribute-amazon-uk-`+ product_attribute_amazon_uk_cnt + `" type="text" class="validate">
        <label for="product-attribute-amazon-uk-`+ product_attribute_amazon_uk_cnt + `">Product Attribute ` + product_attribute_amazon_uk_cnt + `</label>
      </div>`

    $("#product-attributes-amazon-uk-div").append(html_string);
  });


  var product_attribute_amazon_uae_cnt = 1;
  $("#add-product-attribute-amazon-uae-btn").click(function () {
    product_attribute_amazon_uae_cnt++;

    var html_string = `<div class="input-field col s11">
        <input id="product-attribute-amazon-uae-`+ product_attribute_amazon_uae_cnt + `" type="text" class="validate">
        <label for="product-attribute-amazon-uae-`+ product_attribute_amazon_uae_cnt + `">Product Attribute ` + product_attribute_amazon_uae_cnt + `</label>
      </div>`

    $("#product-attributes-amazon-uae-div").append(html_string);
  });


  var product_attribute_ebay_cnt = 1;
  $("#add-product-attribute-ebay-btn").click(function () {
    product_attribute_ebay_cnt++;

    var html_string = `<div class="input-field col s11">
        <input id="product-attribute-ebay-`+ product_attribute_ebay_cnt + `" type="text" class="validate">
        <label for="product-attribute-ebay-`+ product_attribute_ebay_cnt + `">Product Attribute ` + product_attribute_ebay_cnt + `</label>
      </div>`

    $("#product-attributes-ebay-div").append(html_string);
  });


  var special_feature_cnt = 1;
  $("#add-special-feature-btn").click(function () {
    special_feature_cnt++;

    var html_string = `<div class="input-field col s11">
        <input id="special-feature-`+ special_feature_cnt + `" type="text" class="validate">
        <label for="special-feature-`+ special_feature_cnt + `">Special Feature ` + special_feature_cnt + `</label>
      </div>`

    $("#special-features-div").append(html_string);
  });




  function update_grid_images_main_images(key) {
    var html_string = "";
    for (var i = 0; i < global_images[key].length; i++) {
      console.log(key);
      var checked = "";
      if (global_images[key][i]["is_main_image"] == true)
        checked = "checked";
      html_string += `<div class="col s4" style="padding:1em;">
        <img class="materialboxed" src="`+ global_images[key][i]["url"] + `" style="width: 100%;">
        <label>
            <input value="`+ global_images[key][i]["pk"] + `" name="group1" type="radio" ` + checked + ` />
            <span></span>
          </label>
      </div>`;
    }
    html_string += `<div class="col s4">
        <a href="#upload-image-modal" class="modal-trigger" style="position: absolute;margin-left: 1em;margin-top: 0.5em;"><i class="material-icons">add</i></a>
      </div> `;


    html_string += `<div class="col s12"><br><br><br><a href="#!" id="main-image-select-save-btn"><i class="material-icons">save</i></a></div>`;

    $("#graphics-section").html(html_string);
    $('.materialboxed').materialbox();


    $("#main-image-select-save-btn").click(function () {

      var fd = new FormData();

      var checked_pk = $("input[name=group1]:checked").val();
      fd.append("checked_pk", checked_pk);
      fd.append("product_pk", window.location.pathname.split("/")[2]);

      $.ajax({
        url: "/update-main-image/",
        type: "POST",
        headers: {
          'X-CSRFToken': getCsrfToken()
        },
        processData: false,
        contentType: false,
        data: fd,
        success: function (response) {
          console.log("Success!", response);
          if (response["status"] == 200) {
            M.toast({ html: "Main image updated successfully!" });
          }
          else {
            M.toast({ html: "Error updating main image!" });
          }
        },
        error: function (xhr, textstatus, errorthrown) {
          console.log("Please report this error: " + errorthrown + xhr.status + xhr.responseText);
        }
      });
    });
  }






  function update_grid_images_sub_images(key) {
    var html_string = "";
    for (var i = 0; i < global_images[key].length; i++) {
      var checked = "";
      if (global_images[key][i]["is_sub_image"] == true)
        checked = "checked";
      html_string += `<div class="col s4" style="padding:1em;">
        <img class="materialboxed" src="`+ global_images[key][i]["url"] + `" style="width: 100%;">
        <input value="`+ global_images[key][i]["sub_image_index"] + `" id="subcheck_` + global_images[key][i]["pk"] + `" type="text" class="validate">
      </div>`;
    }
    html_string += `<div class="col s4">
        <a href="#upload-image-modal" class="modal-trigger" style="position: absolute;margin-left: 1em;margin-top: 0.5em;"><i class="material-icons">add</i></a>
      </div> `;


    html_string += `<div class="col s12"><br><br><br><a href="#!" id="sub-image-select-save-btn"><i class="material-icons">save</i></a></div>`;

    $("#graphics-section").html(html_string);
    $('.materialboxed').materialbox();


    $("#sub-image-select-save-btn").click(function () {

      var fd = new FormData();

      var sub_image = [];
      for (var i = 0; i < global_images[key].length; i++) {
        var temp_dict = {};
        temp_dict["pk"] = global_images[key][i]["pk"];
        temp_dict["sub_image_index"] = $("#subcheck_" + global_images[key][i]["pk"]).val();
        sub_image.push(temp_dict);
      }


      fd.append("sub_images", JSON.stringify(sub_image));
      fd.append("product_pk", window.location.pathname.split("/")[2]);

      $.ajax({
        url: "/update-sub-images/",
        type: "POST",
        headers: {
          'X-CSRFToken': getCsrfToken()
        },
        processData: false,
        contentType: false,
        data: fd,
        success: function (response) {
          console.log("Success!", response);
          if (response["status"] == 200) {
            M.toast({ html: "Sub images updated successfully!" });
          }
          else {
            M.toast({ html: "Error updating sub images!" });
          }
        },
        error: function (xhr, textstatus, errorthrown) {
          console.log("Please report this error: " + errorthrown + xhr.status + xhr.responseText);
        }
      });
    });
  }




  function update_grid_images(key) {
    if (key == "main_images") {
      update_grid_images_main_images(key);
      return;
    }
    if (key == "sub_images") {
      update_grid_images_sub_images(key);
      return;
    }


    var html_string = "";
    for (var i = 0; i < global_images[key].length; i++) {
      html_string += `<div class="col s4" style="padding:1em;">
    <img class="materialboxed" src="`+ global_images[key][i] + `" style="width: 100%;">
  </div>`;
    }
    html_string += `<div class="col s4">
    <a href="#upload-image-modal" class="modal-trigger" style="position: absolute;margin-left: 1em;margin-top: 0.5em;"><i class="material-icons">add</i></a>
  </div> `;

    $("#graphics-section").html(html_string);
    $('.materialboxed').materialbox();
  }



  $("#images-category").change(function () {

    if ($("#images-category").val() == "Main Images") {
      update_grid_images("main_images");
      global_image_key = "main_images";
    }
    else if ($("#images-category").val() == "Sub Images") {
      update_grid_images("sub_images");
      global_image_key = "sub_images";
    }
    else if ($("#images-category").val() == "PFL Images") {
      update_grid_images("pfl_images");
      global_image_key = "pfl_images";
    }
    else if ($("#images-category").val() == "PFL Generated Images") {
      update_grid_images("pfl_generated_images");
      global_image_key = "pfl_generated_images";
    }
    else if ($("#images-category").val() == "White Background Images") {
      update_grid_images("white_background_images");
      global_image_key = "white_background_images";
    }
    else if ($("#images-category").val() == "Lifestyle Images") {
      update_grid_images("lifestyle_images");
      global_image_key = "lifestyle_images";
    }
    else if ($("#images-category").val() == "Certificate Images") {
      update_grid_images("certificate_images");
      global_image_key = "certificate_images";
    }
    else if ($("#images-category").val() == "Giftbox Images") {
      update_grid_images("giftbox_images");
      global_image_key = "giftbox_images";
    }
    else if ($("#images-category").val() == "Diecut Images") {
      update_grid_images("diecut_images");
      global_image_key = "diecut_images";
    }
    else if ($("#images-category").val() == "A+ Content Images") {
      update_grid_images("aplus_content_images");
      global_image_key = "aplus_content_images";
    }
    else if ($("#images-category").val() == "Ads Images") {
      update_grid_images("ads_images");
      global_image_key = "ads_images";
    }
    else if ($("#images-category").val() == "Unedited Images") {
      update_grid_images("unedited_images");
      global_image_key = "unedited_images";
    }
  });



  function save_product() {

    $("#save-btn").attr("disabled", "disabled");

    var ele = $('#pfl-div');
    console.log(ele);

    var product_pk = window.location.pathname.split("/")[2]

    var image_data;

    $('#pfl-div').css("display", "block");
    var ele = $('#pfl-div')[0];
    var scaleBy = 5;
    var w = 1000;
    var h = 1000;
    var canvas = document.createElement('canvas');
    canvas.width = w * scaleBy;
    canvas.height = h * scaleBy;
    canvas.style.width = w + 'px';
    canvas.style.height = h + 'px';
    var context = canvas.getContext('2d');
    context.scale(scaleBy, scaleBy);

    var pfl_product_name = $("#pfl-product-name").val();
    var pfl_product_features = [];

    $('#features-preview-div').append(`<br/><br/>`);

    for (var i = 0; i < $(".feature-text").length; i++) {
      pfl_product_features.push($($(".feature-text").get(i)).val());
      $('#features-preview-div').append(` <span style = "font-family: 'AvenirNextRegular'">
  <span style="color:#521893;font-weight:1000;">. </span>
  `+ $($(".feature-text").get(i)).val() + `
</span><br>`)
    }

    $("#product-name-preview").text(pfl_product_name);

    html2canvas(ele, {
      canvas: canvas,
      onrendered: function (canvas) {
        $('#pfl-div').css("display", "none");
        var canWidth = canvas.width;
        var canHeight = canvas.height;
        var img = Canvas2Image.convertToJPEG(canvas, canWidth, canHeight);
        image_data = $(img).attr("src");
        // $('.pflspecific').hide();
        //Canvas2Image.saveAsImage(canvas, canWidth , canHeight , "jpg");


        var product_name_amazon_uk = $("#product-name-amazon-uk").val();
        var product_name_amazon_uae = $("#product-name-amazon-uae").val();
        var product_name_ebay = $("#product-name-ebay").val();
        var product_name_sap = $("#product-name-sap").val();
        var category = $("#category").val();
        var subtitle = $("#subtitle").val();
        var brand = $("#brand-name").val();
        var manufacturer = $("#manufacturer").val();
        var product_id = $("#product-id").val();
        var product_id_type = $("#product-id-type").val();
        var seller_sku = $("#seller-sku").val();
        var manufacturer_part_number = $("#manufacturer-part-number").val();
        var barcode_string = $("#barcode-string").val()
        var condition_type = $("#condition-type").val();
        var feed_product_type = $("#feed-product-type").val();
        var update_delete = $("#update-delete").val();
        var recommended_browse_nodes = $("#recommended-browse-nodes").val();
        var product_description_amazon_uk = window.editor.getData();


        var product_attribute_data_amazon_uk = [];
        for (var i = 1; i <= product_attribute_amazon_uk_cnt; i++) {
          if ($("#product-attribute-amazon-uk-" + i).val() != "") {
            product_attribute_data_amazon_uk.push($("#product-attribute-amazon-uk-" + i).val());
          }
        }
        product_attribute_data_amazon_uk = JSON.stringify(product_attribute_data_amazon_uk);


        var product_attribute_data_amazon_uae = [];
        for (var i = 1; i <= product_attribute_amazon_uae_cnt; i++) {
          if ($("#product-attribute-amazon-uae-" + i).val() != "") {
            product_attribute_data_amazon_uae.push($("#product-attribute-amazon-uae-" + i).val());
          }
        }
        product_attribute_data_amazon_uae = JSON.stringify(product_attribute_data_amazon_uae);


        var product_attribute_data_ebay = [];
        for (var i = 1; i <= product_attribute_ebay_cnt; i++) {
          if ($("#product-attribute-ebay-" + i).val() != "") {
            product_attribute_data_ebay.push($("#product-attribute-ebay-" + i).val());
          }
        }
        product_attribute_data_ebay = JSON.stringify(product_attribute_data_ebay);


        var search_terms = $("#search-terms").val();
        var color_map = $("#color-map").val();
        var color = $("#color").val();
        var enclosure_material = $("#enclosure-material").val();
        var cover_material_type = $("#cover-material-type").val();


        var special_feature_data = [];
        for (var i = 1; i <= special_feature_cnt; i++) {
          if ($("#special-feature-" + i).val() != "") {
            special_feature_data.push($("#special-feature-" + i).val());
          }
        }

        var special_feature_data = JSON.stringify(special_feature_data);
        var package_length = $("#package-length").val();
        var package_length_metric = $("#package-length-metric").val();
        var package_width = $("#package-width").val();
        var package_width_metric = $("#package-width-metric").val();
        var package_height = $("#package-height").val();
        var package_height_metric = $("#package-height-metric").val();
        var package_weight = $("#package-weight").val();
        var package_weight_metric = $("#package-weight-metric").val();
        var shipping_weight = $("#shipping-weight").val();
        var shipping_weight_metric = $("#shipping-weight-metric").val();
        var item_display_weight = $("#item-display-weight").val();
        var item_display_weight_metric = $("#item-display-weight-metric").val();
        var item_display_volume = $("#item-display-volume").val();
        var item_display_volume_metric = $("#item-display-volume-metric").val();
        var item_display_length = $("#item-display-length").val();
        var item_display_length_metric = $("#item-display-length-metric").val();
        var item_weight = $("#item-weight").val();
        var item_weight_metric = $("#item-weight-metric").val();
        var item_length = $("#item-length").val();
        var item_length_metric = $("#item-length-metric").val();
        var item_width = $("#item-width").val();
        var item_width_metric = $("#item-width-metric").val();
        var item_height = $("#item-height").val();
        var item_height_metric = $("#item-height-metric").val();
        var item_display_width = $("#item-display-width").val();
        var item_display_width_metric = $("#item-display-width-metric").val();
        var item_display_height = $("#item-display-height").val();
        var item_display_height_metric = $("#item-display-height-metric").val();
        var item_condition_note = $("#item-condition-note").val();
        var max_order_quantity = $("#max-order-quantity").val();
        var number_of_items = $("#number-of-items").val();
        var wattage = $("#wattage").val();
        var wattage_metric = $("#wattage-metric").val();
        var material_type = $("#material-type").val();
        var parentage = $("#parentage").val();
        var parent_sku = $("#parent-sku").val();
        var relationship_type = $("#relationship-type").val();
        var variation_theme = $("#variation-theme").val();
        var standard_price = $("#standard-price").val();
        var quantity = $("#quantity").val();
        var sale_price = $("#sale-price").val();
        var sale_from = $("#sale-from").val();
        var sale_end = $("#sale-end").val();
        var product_pk = window.location.pathname.split("/")[2];

        var fd = new FormData();

        fd.append('pfl_product_name', pfl_product_name)
        fd.append('pfl_product_features', JSON.stringify(pfl_product_features));
        fd.append('image_data', image_data)
        fd.append('product_pk', product_pk)
        fd.append('product_name_sap', product_name_sap);
        fd.append('product_name_amazon_uk', product_name_amazon_uk);
        fd.append('product_name_amazon_uae', product_name_amazon_uae);
        fd.append('product_name_ebay', product_name_ebay);
        fd.append('category', category);
        fd.append('subtitle', subtitle);
        fd.append('brand', brand);
        fd.append('manufacturer', manufacturer);
        fd.append('product_id', product_id);
        fd.append('product_id_type', product_id_type);
        fd.append('seller_sku', seller_sku);
        fd.append('manufacturer_part_number', manufacturer_part_number);
        fd.append('barcode_string', barcode_string);
        fd.append('condition_type', condition_type);
        fd.append('feed_product_type', feed_product_type);
        fd.append('update_delete', update_delete);
        fd.append('recommended_browse_nodes', recommended_browse_nodes);
        fd.append('product_description_amazon_uk', product_description_amazon_uk);
        fd.append('product_attribute_list_amazon_uk', product_attribute_data_amazon_uk);
        fd.append('product_attribute_list_amazon_uae', product_attribute_data_amazon_uae);
        fd.append('product_attribute_list_ebay', product_attribute_data_ebay);
        fd.append('search_terms', search_terms);
        fd.append('color_map', color_map);
        fd.append('color', color);
        fd.append('enclosure_material', enclosure_material);
        fd.append('cover_material_type', cover_material_type);
        fd.append('special_features', special_feature_data);
        fd.append('package_length', package_length);
        fd.append('package_length_metric', package_length_metric);
        fd.append('package_width', package_width);
        fd.append('package_width_metric', package_width_metric);
        fd.append('package_height', package_height);
        fd.append('package_height_metric', package_height_metric);
        fd.append('package_weight', package_weight);
        fd.append('package_weight_metric', package_weight_metric);
        fd.append('shipping_weight', shipping_weight);
        fd.append('shipping_weight_metric', shipping_weight_metric);
        fd.append('item_display_weight', item_display_weight);
        fd.append('item_display_weight_metric', item_display_weight_metric);
        fd.append('item_display_volume', item_display_volume);
        fd.append('item_display_volume_metric', item_display_volume_metric);
        fd.append('item_display_length', item_display_length);
        fd.append('item_display_length_metric', item_display_length_metric);
        fd.append('item_weight', item_weight);
        fd.append('item_weight_metric', item_weight_metric);
        fd.append('item_length', item_length);
        fd.append('item_length_metric', item_length_metric);
        fd.append('item_width', item_width);
        fd.append('item_width_metric', item_width_metric);
        fd.append('item_height', item_height);
        fd.append('item_height_metric', item_height_metric);
        fd.append('item_display_width', item_display_width);
        fd.append('item_display_width_metric', item_display_width_metric);
        fd.append('item_display_height', item_display_height);
        fd.append('item_display_height_metric', item_display_height_metric);
        fd.append('item_condition_note', item_condition_note);
        fd.append('max_order_quantity', max_order_quantity);
        fd.append('number_of_items', number_of_items);
        fd.append('wattage', wattage);
        fd.append('wattage_metric', wattage_metric);
        fd.append('material_type', material_type);
        fd.append('parentage', parentage);
        fd.append('parent_sku', parent_sku);
        fd.append('relationship_type', relationship_type);
        fd.append('variation_theme', variation_theme);
        fd.append('standard_price', standard_price);
        fd.append('quantity', quantity);
        fd.append('sale_price', sale_price);
        fd.append('sale_from', sale_from);
        fd.append('sale_end', sale_end);

        $.ajax({
          url: "/save-product/",
          type: "POST",
          headers: {
            'X-CSRFToken': getCsrfToken()
          },
          processData: false,
          contentType: false,
          data: fd,
          success: function (response) {

            console.log("Success!", response);
            if (response["status"] == 200) {
              M.toast({ html: "Product saved successfully!" });
            }
            else {
              M.toast({ html: "Error saving product!" });
            }
            $("#save-btn").removeAttr("disabled");
          },
          error: function (xhr, textstatus, errorthrown) {
            console.log("Please report this error: " + errorthrown + xhr.status + xhr.responseText);
          }
        });
      }
    });
  }


  $("#save-btn").click(function () {
    save_product();
  });

</script>

{% endblock %}