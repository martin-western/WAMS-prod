{% extends 'WAMSApp/base.html' %}

{% block content %}

{% load static %}

<style type="text/css">
  @font-face {
    font-family: AvenirNext;
    src: url("{% static 'WAMSApp/fonts/Avenir-Next-Font/AvenirNextLTPro-Demi.otf' %}");
  }

  @font-face {
    font-family: AvenirNextBold;
    src: url("{% static 'WAMSApp/fonts/Avenir-Next-Font/AvenirNextLTPro-Bold.otf' %}");
  }

  @font-face {
    font-family: AvenirNextBold;
    src: url("{% static 'WAMSApp/fonts/Avenir-Next-Font/AvenirNextLTPro-Bold.otf' %}");
  }

  .ck.ck-content ul,
  .ck.ck-content ul li {
    list-style-type: inherit;
  }

  .ck.ck-content ul {
    padding-left: 40px;
  }

  .ck.ck-content strong {
    font-weight: bold;
  }

  .flex-container-space-btw {
    display: flex;
    justify-content: space-between;
  }

  .flex-container-space-btw>div {
    margin-top: 15px;
    width: 7vw;
  }


  .img-wrapper {
    position: relative;
  }

  .img-responsive {
    width: 100%;
    height: auto;
  }

  .img-overlay {
    position: absolute;
    top: 1em;
    bottom: 0;
    right: 1em;
    text-align: center;
  }

  .redd:hover {
    background-color: red !important;
    color: white !important;
  }

  .greenn:hover {
    background-color: #009051 !important;
    color: white !important;
  }

  .bluee:hover {
    background-color: blue !important;
    color: white !important;
  }

  .yelloww:hover {
    background-color: orange !important;
    color: white !important;
  }

  .purplee:hover {
    background-color: #512de8 !important;
    color: white !important;
  }

  .maroonn:hover {
    background-color: maroon !important;
    color: white !important;
  }

  .homee:hover {
    background-color: #521893 !important;
    color: white !important;
  }

  .miniimage+input {
    width: 50% !important;
    display: block;
  }

  input[type="checkbox"].filled-in:checked+span:before {
    background-color: #512de8 !important
  }

  input[type="checkbox"].filled-in:checked+span:after {
    background-color: #512de8 !important
  }

  .img-overlay:before {
    content: ' ';
    display: block;
    height: 10%;
  }


  a .active {
    background-color: #512da8 !important;
  }


  /*tabs*/

  .tab-content {
    margin-top: 20px;
    max-height: 80vh;
    overflow: auto;
    overflow-x: hidden;
  }

  input:focus {
    border-color: #512da8 !important;
  }

  input:select {
    border-color: #512da8 !important;
  }

  .tab-pane div.row {
    padding: 20px !important;
  }

  .savebtn {
    position: fixed;
    top: 20px;
    left: 50px;
    background-color: #512da8;
  }

  li span {
    color: black !important;
  }

  img.materialboxed {
    width: 100px;
    height: 100px;
    background-color: white;
  }

  .tab-pane h4 {
    display: none;
  }

  .miniimage {
    display: block;
    height: 80px;
  }

  .image-section {
    overflow-y: scroll;
    overflow-x: hidden;
  }

  ::-webkit-scrollbar {
    width: 0px;
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background: gray;
  }


  .input-field:not(.left-section) {
    padding: 0px 50px 0px 50px !important;
    margin-top: 20px !important;
  }


  input:not([type]),
  input[type=text],
  input[type=password],
  input[type=email],
  input[type=url],
  input[type=time],
  input[type=date],
  input[type=datetime],
  input[type=datetime-local],
  input[type=tel],
  input[type=number],
  input[type=search],
  textarea.materialize-textarea {
    border: none !important;
    border-bottom: 2px solid #f7f7f7 !important;
    padding-left: 10px !important;
    font-family: 'AvenirNext' !important;
    font-weight:
  }

  input:not([type]):focus:not([readonly]),
  input[type=text]:focus:not([readonly]),
  input[type=password]:focus:not([readonly]),
  input[type=email]:focus:not([readonly]),
  input[type=url]:focus:not([readonly]),
  input[type=time]:focus:not([readonly]),
  input[type=date]:focus:not([readonly]),
  input[type=datetime]:focus:not([readonly]),
  input[type=datetime-local]:focus:not([readonly]),
  input[type=tel]:focus:not([readonly]),
  input[type=number]:focus:not([readonly]),
  input[type=search]:focus:not([readonly]),
  textarea.materialize-textarea:focus:not([readonly])>label {
    border-bottom: 1px solid #512ea8 !important;
    box-shadow: 0 1px 0 0 #f00 !important;
    border-bottom: none !important;
    box-shadow: none !important;
  }

  label {
    margin-left: 50px !important;
  }

  .input-field:not(.left-section) input:focus+label {
    color: #512ea8 !important;
  }

  .row .input-field:not(.left-section) input:focus {
    border-bottom: 1px solid #512ea8 !important;
    box-shadow: 0 1px 0 0 #512ea8 !important
  }

  .left-section .select-wrapper ul {
    position: relative;
    top: -300px !important;
  }

  .material-placeholder {}

  .preview-img {
    height: 100% !important;
    width: 100% !important;
    object-fit: contain;
  }

  .image-section {
    padding: 0 !important;
  }



  .padding-zero {
    padding: 0 !important;
  }

  .graphics-section {
    padding: 10px 0 !important;
    margin: 0;
  }

  .feature-container>p {
    display: flex;
    align-items: center;
  }

  .feature-container ul {
    margin: 10px 0;
  }

  .feature-list {
    color: grey;
    font-size: 12px;
  }

  .product-info-parent {

    padding: 0 20px;
  }

  .product-info {
    font-size: 14px;
    color: grey;
    font-family: 'AvenirNextRegular';
  }

  .product-info-tab>li>a {
    font-size: 14px !important;
    color: grey !important;
    padding: 0 5px;
  }

  .product-info-tab>li>.active {
    /* background-color: #80808091 !important; */
    color: #972CC6 !important;
    background-color: white !important;
    border-right: .5px solid rgba(128, 128, 128, 0.418);
  }


  .product-info-tab {
    display: flex;
    flex-direction: column !important;
    width: 100%;
    height: auto;
    background-color: white;
    border-right: .5px solid rgba(128, 128, 128, 0.418);
    margin: 10px 0;
  }

  .product-info-tab .tab>a {
    text-align: left;
    color: #512da8;
    font-size: 14px !important;
  }

  .product-info-container {}

  .product-info {
    padding: 20px;
  }

  .right-container {
    padding: 0 30px !important;
  }

  .right-container h5 {
    color: #512da8;
    font-size: 20px;
  }

  .feature-title {
    color: #512da8;
    font-size: 14px;
  }

  .sku-info {
    color: grey;
    font-size: 12px;
  }


  /* disable bottom border from tabs */
  li.indicator {
    display: none;
  }


  /*  Sourav Code */

  .row {
    margin: 0 !important;

  }

  .margin-zero {
    margin: 0 !important;
  }

  .bg-white {
    background-color: white;
  }

  .text-grey {
    color: grey;
  }

  .no-shadows {
    box-shadow: none !important;
  }

  .avenier-next {
    font-family: 'AvenirNext';
  }


  .breadcrumb-container {
    border-bottom: .5px solid rgba(128, 128, 128, 0.384);
  }

  .breadcrumb:before {
    color: grey;
    font-size: 14px;

  }

  .breadcrumb {
    color: grey;
    font-family: 'AvenirNextRegular';
    font-size: 14px;
  }

  .active-breadcrumb {
    color: grey !important;
    font-family: 'AvenirNextRegular';
    font-size: 14px;
  }

  .active-breadcrumb:before {
    color: grey;
  }

  .breadcrumb-container nav {
    height: 50px;
  }

  .nav-wrapper {
    height: 50px !important;
    display: flex;
    align-items: center;
  }

  .content-left-container {

    min-height: 100vh;
  }

  .content-right-container {
    height: 100% !important;
    padding: 10px !important;

    border-left: .5px solid rgba(128, 128, 128, 0.39);


  }

  .content-right-container ul {
    padding: 10px !important;
  }

  .content-right-container ul>li:before {
    content: "•";
    display: inline-block;
    color: #321DD6;
    margin-right: 5px;
  }


  .content-right-container ul>li {
    font-family: 'AvenirNextRegular';
    font-size: 14px;
    color: #757575;
    margin-bottom: 10px;
  }

  .special-features-title {
    color: #321DD6;
    font-size: 16px;
  }

  .brand-title {
    color: grey;
    font-family: 'AvenirNextRegular';
    font-size: 16px;
  }

  .product-title {
    font-family: 'AvenirNext';
    font-size: 18px;
    line-height: 1.5;
  }

  .product-id-sku-container {
    display: flex;
    align-items: center;
    background-color: #F8EDFF;
    padding: 10px;
  }

  .product-id-sku-container>p {
    color: #972CC6;
    font-family: 'AvenirNextRegular';
    margin: 0 10px 0 0;
  }

  .product-category-container {
    padding: 10px 0;
  }

  .product-category-container .category-title {
    color: #ADADAD;
    font-size: 14px;
    font-family: 'AvenirNextRegular';
  }

  .product-category-container>.row {
    margin-bottom: 15px !important;
  }

  .product-category-container .category-info {
    color: #5A5A5A;
    font-size: 14px;
    font-family: 'AvenirNextRegular';
    line-height: 1.2 !important;
  }

  .social-icon-container {
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0;
    height: 60px;
    border-top: .5px solid rgba(128, 128, 128, 0.37);
    border-bottom: .5px solid rgba(128, 128, 128, 0.37);
  }

  .fab {
    font-size: 25px;
    margin: 0 10px;
  }

  .slider-container {
    width: 100%;
    padding: 0 5px;
  }

  .slider-for {
    height: auto;
  }

  .slider-nav {
    height: auto;
    margin-top: 20px;
    padding: 0 8px;
    position: relative;
  }

  .slick-prev {
    position: absolute;
    left: -12px;
  }

  .slick-next {
    position: absolute;
    right: -12px;
  }

  .slick-track {
    display: flex !important;
    justify-content: center !important;
  }

  .slick-prev:before,
  .slick-next:before {

    color: #CCCCCC;
  }

  .img-fluid-preview {
    width: 100% !important;
  }

  .slick-slide {
    padding: 2px !important;
  }

  .img-fluid-nav {
    width: 100% !important;
    margin: 0 4px;
  }

  .product-price-outdoor-container {
    background-color: #3FB223;
    padding: 10px 10px 5px 10px;
    border-radius: 5px;
  }

  .product-price {
    margin: 0;
    color: white;
    font-family: 'AvenirNextRegular';
    font-size: 13px;

  }

  .product-stock-warehouse-container {
    background-color: white;
    border-radius: 5px;
    border: 1px solid #321DD6;
    padding: 10px 10px 5px 10px;
  }

  .product-stock {
    margin: 0;
    color: #321DD6;
    font-family: 'AvenirNextRegular';
    font-size: 13px;
  }

  .stock-warehouse {
    font-family: 'AvenirNextRegular !important';
    font-size: 12px !important;
    border: none;
    color: #321DD6;
  }

  .stock-warehouse:focus {
    outline: none;
  }

  .outdoor-price {
    font-family: 'AvenirNextRegular !important';
    font-size: 12px !important;
    background-color: #3FB223;
    border: none;
    color: white;
  }

  .outdoor-price:focus {
    outline: none;
  }

  .outdoor-price-container .select-wrapper input.select-dropdown {
    border-bottom: none !important;
    font-size: 10px;
    margin: 0;
    color: white;
    height: 20px;
    font-weight: 200;
  }

  .outdoor-price-container .select-wrapper .caret {
    right: -20px;
    fill: white;
  }

  .product-stock-warehouse-container .select-wrapper input.select-dropdown {
    border-bottom: none !important;
    font-size: 10px;
    margin: 0;
    color: #321DD6;
    height: 20px;
    font-weight: 200;
  }

  .product-stock-warehouse-container .select-wrapper .caret {
    right: -20px;
    fill: #321DD6;
  }

  .dimension-tab-info {
    font-family: 'AvenirNext !important';
    color: #ADADAD;
    font-size: 16px;
    padding-right: 10px;
  }

  .dimension-tab-info-value {
    font-family: 'AvenirNext !important';
    color: #747474;
    font-size: 16px;
  }

  .dimension-tab-container table.striped>tbody>tr:nth-child(odd) {
    background-color: #EDF8FF;
  }
</style>


<style type="text/css">
  .image-section-dropdown .select-wrapper input.select-dropdown {
    border: none !important;
    bottom: 2px !important;
    margin-bottom: 0px !important;
    font-size: 14px !important;
  }

  input.active {
    border-bottom-color: #512da8 !important;
  }
</style>


<div>
  <div class="row breadcrumb-container">
    <nav class="no-shadows">
      <div class="nav-wrapper white ">
        <div class="col s12 ">
          <a href="#!" class="breadcrumb ">Products</a>
          <a href="#!" class="breadcrumb ">Product Listings</a>
          <a href="#!" class="breadcrumb active-breadcrumb">Product Details Page</a>
        </div>
      </div>
    </nav>
  </div>

  <div class="row bg-white" style="">
    <div class="row col l9 s12 content-left-container padding-zero">
      <div class="row bg-white" style="padding: 10px;">
        <div class="col l5 s12">

          <div class="slider-container margin-zero ">
            <div class="slider slider-for ">
              <div>
                <img class="img-fluid-preview"
                  src="http://www.geepas.com/assets/images/products/orginal/GLED3215PHD.jpg" alt="Image Description">
              </div>
              <div>
                <img class="img-fluid-preview"
                  src="http://www.geepas.com/assets/images/products/orginal/GLED3210CHD.jpg" alt="Image Description">
              </div>
              <div>
                <img class="img-fluid-preview" src="http://www.geepas.com/assets/images/products/orginal/GLE3202EHD.jpg"
                  alt="Image Description">
              </div>
              <div>
                <img class="img-fluid-preview"
                  src="http://www.geepas.com/assets/images/products/orginal/GLED4059SXHD.jpg" alt="Image Description">
              </div>
              <div>
                <img class="img-fluid-preview"
                  src="http://www.geepas.com/assets/images/products/orginal/GLED5006XFHD.jpg" alt="Image Description">
              </div>

            </div>
            <div class="slider slider-nav">
              <div>
                <img class="img-fluid-nav" src="http://www.geepas.com/assets/images/products/orginal/GLED3215PHD.jpg"
                  alt="Image Description">
              </div>
              <div>
                <img class="img-fluid-nav" src="http://www.geepas.com/assets/images/products/orginal/GLED3210CHD.jpg"
                  alt="Image Description">
              </div>
              <div>
                <img class="img-fluid-nav" src="http://www.geepas.com/assets/images/products/orginal/GLE3202EHD.jpg"
                  alt="Image Description">
              </div>
              <div>
                <img class="img-fluid-nav" src="http://www.geepas.com/assets/images/products/orginal/GLED4059SXHD.jpg"
                  alt="Image Description">
              </div>
              <div>
                <img class="img-fluid-nav" src="http://www.geepas.com/assets/images/products/orginal/GLED5006XFHD.jpg"
                  alt="Image Description">
              </div>
            </div>

          </div>
        </div>
        <div class="col l7 s12 product-info-container">
          <h6 class="brand-title">
            Geepas
          </h6>
          <h6 class="product-title">
            Geepas Product Name. This can be of three lines and or more as name are long for products
          </h6>
          <!-- <div class="product-id-sku-container">
            <p class="product-id">Product id: 60002763576</p>
            <p class="separator">|</p>
            <p class="seller-sku">Seller SKU: FRH786</p c>
          </div> -->
          <div class="product-category-container">
            <div class="row">
              <div class="col s3 category-title padding-zero">
                Product ID:
              </div>
              <div class="col s9 category-info padding-zero">
                60000072654762
              </div>
            </div>
            <div class="row">
              <div class="col s3 category-title padding-zero">
                Seller SKU:
              </div>
              <div class="col s9 category-info padding-zero">
                GP23424
              </div>
            </div>
            <div class="row">
              <div class="col s3 category-title padding-zero">
                SAP Name:
              </div>
              <div class="col s9 category-info padding-zero">
                Amazon product name, this again can be of three lines or more
              </div>
            </div>
            <div class="row">
              <div class="col s3 category-title padding-zero">
                Category:
              </div>
              <div class="col s9 category-info padding-zero">
                Home Appliances
              </div>
            </div>
            <div class="row">
              <div class="col s3 category-title padding-zero">
                Sub - Category:
              </div>
              <div class="col s9 category-info padding-zero">
                Grinder
              </div>
            </div>
            <div class="row">
              <div class="col s3 category-title padding-zero">
                Color Group
              </div>
              <div class="col s9 category-info padding-zero">
                Electric Blue
              </div>
            </div>
          </div>
          <div class="product-price-stock-container">
            <div class="row">
              <div class="col s6 l4 " style="padding: 0 .75rem 0 0;">
                <div class="product-price-outdoor-container">
                  <div class="row product-price-container">
                    <p class="product-price">
                      AED 19,240
                    </p>
                  </div>
                  <div class="row outdoor-price-container">
                    <div class="col l5"></div>
                    <div class="col l7">
                      <select class="outdoor-price">
                        <option value="" disabled selected>outdoor price</option>
                        <option value="1">AED 2000</option>
                        <option value="2">AED 3000</option>
                        <option value="3">AED 2100</option>
                      </select>
                    </div>

                  </div>
                </div>
              </div>
              <div class="col s6 l7 " style="padding: 0  0 0 .75rem;">
                <div class="product-stock-warehouse-container">
                  <div class="row">
                    <p class="product-stock">
                      AED 19,240
                    </p>
                  </div>
                  <div class="row">
                    <div class="col l5 s6"></div>
                    <div class="col l7 s6">
                      <select class=" stock-warehouse">
                        <option value="" selected>Jabel Ali Warehouse, Dubai UAE</option>
                        <option value="1">AED 2000</option>
                        <option value="2">AED 3000</option>
                        <option value="3">AED 2100</option>
                      </select>
                    </div>

                  </div>
                </div>
              </div>
              <div class="col l1 s0"></div>
            </div>
          </div>
        </div>
      </div>



    </div>
    <div class="col l3 s12 content-right-container bg-white">
      <h6 class="special-features-title">
        Special Features
      </h6>
      <ul>
        <li>
          Geepas stainless steel 3 jars - Wet and Dry grinding, Liquidizing, Chutney making
        </li>
        <li>
          Jar Capacity: 1.25 Litre liquidizing jar, 0.8 Litre multi purpose jar, 0.35 Litre chutney jar
        </li>
        <li>
          The regular Memory foam pillows are not just comfortable, but also provides relief from backaches, headaches,
          neck issues or other pain related problems which we face due to stress
        </li>
        <li>
          This cervical contour pillow comes with a removable zip cover | Our pillow cover’s hypoallergenic properties
          fight off allergens and is perfect for sensitive skin | Ultra Soft, Removable & Washable. | Best Pillow for
          sleeping!
        </li>
        <li>
          Memory Foam Pillow is perfect for anyone who experiences tossing and turning, snoring, overheating, shoulder
          aches, neck and back pain, congestion blockage, or simply wishes to improve their overall sleep quality.
        </li>
      </ul>
    </div>
  </div>
  <div class="row padding-zero bg-white">
    <div class="col s12 row padding-zero">
      <ul class="social-icon-container">
        <li>
          <a href="#">
            <i class="fab fa-facebook black-text"></i>
          </a>
        </li>
        <li>
          <a href="#">
            <i class="fab fa-twitter  black-text"></i>
          </a>
        </li>
        <li>
          <a href="#">
            <i class="fab fa-instagram  black-text "></i>
          </a>
        </li>
        <li>
          <a href="#">
            <i class="fab fa-snapchat  black-text "></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
  <div class="row padding-zero  bg-white">
    <div class="col s12 row padding-zero">
      <div class="col s3 padding-zero">
        <ul class="tabs product-info-tab">
          <li class="tab "><a href="#test1">DESCRIPTION</a></li>
          <li class="tab "><a class="active" href="#test3">DIMENSIONS</a></li>
          <li class="tab "><a href="#test4">SPECIFICATIONS</a></li>
        </ul>
      </div>
      <div class="col s9  padding-zero product-info-container">
        <div id="test1" class="product-info">
          The tabs structure consists of an unordered list of tabs that have hashes corresponding to tab ids. Then
          when
          you click on each tab, only the container with the corresponding
        </div>

        <div id="test3" class="product-info dimension-tab-container">
          <div class="row">
            <div class="col l6">
              <table class="striped">
                <tbody>
                  <tr>
                    <td class="dimension-tab-info">Package Dimensions (L x B x H)</td>
                    <td class="dimension-tab-info-value">24 centimeters</td>
                  </tr>
                  <tr>
                    <td class="dimension-tab-info">Item Dimensions (L x B x H)</td>
                    <td class="dimension-tab-info-value">24 centimeters</td>
                  </tr>

                </tbody>
              </table>
            </div>
            <div class="col l6">
              <table class="striped">
                <tbody>
                  <tr>
                    <td class="dimension-tab-info">Item Display (L x B x H)</td class="dimension-tab-info">
                    <td class="dimension-tab-info-value">24 centimeters</td>
                  </tr>
                  <tr>
                    <td class="dimension-tab-info">Item Weight (L x B x H)</td class="dimension-tab-info">
                    <td class="dimension-tab-info-value">24 grams</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div id="test4" class="product-info">
          touch enabled devices to switch tabs. Make sure you keep the tab content divs in the same wrapping
          container.
          You can also set the responsiveThreshold option to a screen width in pixels where the swipeable
          functionality w
        </div>
      </div>
    </div>
  </div>


</div>






<div id="download-export-list-modal" class="modal" style="border-radius: 5px;">
  <div class="modal-content">
    <h5 style="font-family: 'AvenirNext';font-size: 18px;">EXPORT PRODUCT</h5>
    <br>
    <div class="row">
      <div class="input-field col s6" style="padding-left: 0em !important;">
        <select id="export-format">
          <option value="Amazon UK" selected>Amazon UK</option>
          <option value="Amazon UAE">Amazon UAE</option>
          <option value="Ebay">Ebay</option>
          <option value="Noon">Noon</option>
          <!-- <option value="Ebay" style="font-family: 'AvenirNextRegular';">Ebay</option>   -->
        </select>
        <label style="margin-left: 0em !important;">Export Format</label>
      </div>

      <div class="input-field col s6">
      </div>
    </div>
  </div>
  <div class="modal-footer" style="margin-bottom: 15px">
    <a href="#!" class="modal-close waves-effect btn-flat" style="margin-right: 20px;">Close</a>
    <a id="download-product-btn" href="#!" class="waves-effect btn-flat white-text"
      style="margin-right: 20px;background-color: #521893 !important;">Download</a>
  </div>
</div>


<script type="text/javascript">

  $('.tabs').tabs();
  $('.chips').chips();
  $('select').formSelect();
  $('.modal').modal();
  $('body').css('background-color', '#ebebeb');
  $('.tabs').tabs();

  // slider product listing 

  $('.slider-for').slick({
    slidesToShow: 1,
    slidesToScroll: 1,
    arrows: false,
    fade: true,
    asNavFor: '.slider-nav',

  });
  $('.slider-nav').slick({
    slidesToShow: 4,
    slidesToScroll: 1,
    asNavFor: '.slider-for',
    dots: false,
    centerMode: true,
    focusOnSelect: false,
    vertical: false,
    arrows: true,
    focusOnSelect: true

  });

  // initialized materialize css select
  $("select").formSelect();

  $('.slider-down-button').click(function () {
    $('.slider-nav').slick('slickPrev');
  })

  $('.slider-up-button').click(function () {
    $('.slider-nav').slick('slickNext');
  })



  var global_verification_status = false;
  var global_delete_image_pk = null;

  //Page reload prevent logic
  let savecounter = false;
  $('#save-btn').click(() => {
    savecounter = false;
  })

  $('input').click(function () {
    savecounter = true;
  })

  function preventDefault() {
    if (savecounter) {
      alert('Please save the details before refreshing!');
    }
    else {
      window.close();
    }
  }

  $('#close-btn').click(function () {
    preventDefault();
  })


  $("#download-product-btn").click(function () {

    var export_format = $("#export-format").val();

    $.ajax({
      url: "/download-product/",
      type: "POST",
      headers: {
        'X-CSRFToken': getCsrfToken()
      },
      data: {
        product_pk: window.location.pathname.split("/")[2],
        export_format: export_format
      },
      success: function (response) {
        console.log("Success!", response);
        $("#download-export-list-modal").modal("close");
        var file_path = response["file_path"]
        window.open(file_path);
      },
      error: function (xhr, textstatus, errorthrown) {
        console.log("Please report this error: " + errorthrown + xhr.status + xhr.responseText);
      }
    });

  });

  window.addEventListener('beforeunload', function (e) {
    if (savecounter) {
      e.preventDefault();
      e.returnValue = '';
    }
    else
      window.close();
  });

  $("#pending-icon").click(function () {
    if (global_verification_status) {
      call_verify_api(0);
    }
  });

  $("#verified-icon").click(function () {
    if (!global_verification_status) {
      call_verify_api(1);
    }
  });

  function call_verify_api(verify) {
    var fd = new FormData()
    fd.append("product_pk", window.location.pathname.split("/")[2]);
    fd.append("verify", verify);

    $.ajax({
      url: "/verify-product/",
      type: "POST",
      headers: {
        'X-CSRFToken': getCsrfToken()
      },
      processData: false,
      contentType: false,
      data: fd,
      success: function (response) {
        console.log("Success!", response);
        if (response["status"] == 200) {
          if (verify == 1) {
            set_verify(true);
            global_verification_status = true;
            M.toast({ html: "Product status changed to verified" });
          }
          else {
            set_verify(false);
            global_verification_status = false;
            M.toast({ html: "Product status changed to pending" });
          }
        }
        else if (response["status"] == 403) {
          M.toast({ html: "You do not have access to update the status!" });
        }
        else {
          M.toast({ html: "Error updating the status!" });
        }
      },
      error: function (xhr, textstatus, errorthrown) {
        console.log("Please report this error: " + errorthrown + xhr.status + xhr.responseText);
      }
    });
  }

  $(document).ready(function () {
    $('.tabs').tabs();
  });

  $('#barcode-string').characterCounter();

  $("#download-image-btn").click(function () {

    $("#download-image-btn").attr("disabled", "disabled");
    var high_def_url = $($(".preview-img")[0]).attr("high_def_url");
    var image_links = [];
    image_links.push({
      "key": "high_def_url",
      "url": high_def_url
    })

    $.ajax({
      url: "/download-images-s3/",
      type: "POST",
      headers: {
        'X-CSRFToken': getCsrfToken()
      },
      data: {
        links: JSON.stringify(image_links)
      },
      success: function (response) {
        console.log("Success! ", response);
        $("#download-image-btn").removeAttr("disabled");
        if (response["status"] == 200) {
          var local_link = response["local_links"][0]["url"];

          var a = document.createElement('a');
          a.href = local_link;
          var filename = high_def_url.split("/")[high_def_url.split("/").length - 1];
          a.download = filename;
          a.click();
        }
      },
      error: function (xhr, textstatus, errorthrown) {
        console.log("Please report this error: " + errorthrown + xhr.status + xhr.responseText);
        $("#download-image-btn").removeAttr("disabled");
      }
    });
  });

  var pfl_feature_cnt = 2;

  $("#add-feature-btn").click(function () {
    var html_string = `<div class="feature-div">
                         <div class="input-field col s9">
                           <input class="feature-text" id="pfl-feature-`+ pfl_feature_cnt + `" type="text" >
                           <label for="pfl-feature-`+ pfl_feature_cnt + `">Feature</label>
                         </div>

                        <div class="input-field col s1">
                          <a href="#!" class="delete-feature-btn btn-floating red" style="transform: scale(0.7);box-shadow: none;"><i class="material-icons">remove</i></a>
                        </div>
                      </div>`;
    $("#feature-summary-editor-div").append(html_string);
    pfl_feature_cnt++;
  });


  $(document).on('click', ".delete-feature-btn", function () {
    $(this).parent().parent().remove();
  });

  // $('.pflspecific').hide(); 

  $("#heading-title").html("PRODUCT FORM");



  function getCsrfToken() {
    var CSRF_TOKEN = $('input[name="csrfmiddlewaretoken"]').val();
    return CSRF_TOKEN;
  }

  var global_images = {};
  var global_image_key = "all_images";

  function fetch_constant_values() {
    $.ajax({
      url: "/fetch-constant-values/",
      type: "POST",
      headers: {
        'X-CSRFToken': getCsrfToken()
      },
      data: {},
      success: function (response) {
        console.log("Success!", response);
        if (response["status"] == 200) {
          var autocomplete_data = {}
          var material_list = response["material_list"];
          for (var i = 0; i < material_list.length; i++) {
            autocomplete_data[material_list[i]["name"]] = null;
          }
          $('#material-type').autocomplete({
            data: autocomplete_data
          });

          autocomplete_data = {};
          var ebay_category_list = response["ebay_category_list"];
          for (var i = 0; i < ebay_category_list.length; i++) {
            autocomplete_data[ebay_category_list[i]["name"] + "|" + ebay_category_list[i]["category_id"]] = null;
          }
          $('#category').autocomplete({
            data: autocomplete_data,
            onAutocomplete: function (val) {
              var category_id = val.split("|")
              category_id = category_id[category_id.length - 1];
              $("#category").val(category_id);
            }
          });


          autocomplete_data = {};
          var brand_list = response["brand_list"];
          for (var i = 0; i < brand_list.length; i++) {
            autocomplete_data[brand_list[i]["name"]] = null;
          }
          $('#brand-name').autocomplete({
            data: autocomplete_data
          });


          var product_id_type_list = response["product_id_type_list"];
          var html_string = `<option value="" selected>Choose Product ID Type</option>`;
          for (var i = 0; i < product_id_type_list.length; i++) {
            html_string += `<option value="` + product_id_type_list[i]["name"] + `">` + product_id_type_list[i]["name"] + `</option>`
          }




          $("#product-id-type").html(html_string);
          $('select').formSelect();
        }
        else {
          //M.toast({html:"Duplicate product detected!"});
        }
        //$("#save-btn").removeAttr("disabled");
      },
      error: function (xhr, textstatus, errorthrown) {
        console.log("Please report this error: " + errorthrown + xhr.status + xhr.responseText);
      }
    });
  }

  fetch_constant_values();


  function fetch_product_images_details() {
    $.ajax({
      url: "/fetch-product-details/",
      type: "POST",
      headers: {
        'X-CSRFToken': getCsrfToken()
      },
      data: {
        pk: window.location.pathname.split("/")[2]
      },
      success: function (response) {
        console.log("Success!", response);

        if (response["status"] == 200) {
          $('.material-placeholder').remove();
          $('.main-image').append(`<img class = "preview-img materialboxed" src='` + response["repr_image_url"] + `' high_def_url="` + response["repr_high_def_url"] + `">`)
          $('.materialboxed').materialbox();

          global_images = response["images"];

          $("#all-images-option").html("All Images (" + global_images["all_images"].length + ")");
          $("#main-images-option").html("Main Images (" + global_images["main_images"].length + ")");
          $("#sub-images-option").html("Sub Images (" + global_images["sub_images"].length + ")");
          $("#pfl-images-option").html("PFL Images (" + global_images["pfl_images"].length + ")");
          $("#pfl-generated-images-option").html("PFL Generated Images (" + global_images["pfl_generated_images"].length + ")");
          $("#white-background-images-option").html("White Background Images (" + global_images["white_background_images"].length + ")");
          $("#lifestyle-images-option").html("Lifestyle Images (" + global_images["lifestyle_images"].length + ")");
          $("#certificate-images-option").html("Certificate Images (" + global_images["certificate_images"].length + ")");
          $("#giftbox-images-option").html("Giftbox Images (" + global_images["giftbox_images"].length + ")");
          $("#diecut-images-option").html("Diecut Images (" + global_images["diecut_images"].length + ")");
          $("#aplus-content-images-option").html("A+ Content Images (" + global_images["aplus_content_images"].length + ")");
          $("#ads-images-option").html("Ads Images (" + global_images["ads_images"].length + ")");
          $("#unedited-images-option").html("Unedited Images (" + global_images["unedited_images"].length + ")");

          update_grid_images(global_image_key);

          $('#brand-image-img').attr("src", response["brand_logo"]);
          if (global_images["main_images"].length > 0) {
            $('#pfl-product-image-preview-img').attr("src", global_images["main_images"][0]["main-url"]);
          }
          $('#barcode-image-preview-img').attr("src", response["barcode_image_url"]);

          M.updateTextFields();
          $('select').formSelect();
        }
        else {
          M.toast({ html: "Error fetching images information" });
        }
      },
      error: function (xhr, textstatus, errorthrown) {
        console.log("Please report this error: " + errorthrown + xhr.status + xhr.responseText);
      }
    });
  }


  $("#upload-image-btn").click(function () {

    $("#upload-image-btn").attr("disabled", "disabled");
    $("#upload-preloader").show();

    product_pk = window.location.pathname.split("/")[2];

    var fd = new FormData();

    fd.append("product_pk", product_pk);
    var product_image_input = document.getElementById("product-image-input");

    fd.append('image_count', product_image_input.files.length);
    for (var i = 0; i < product_image_input.files.length; i++) {
      fd.append('image_' + i, product_image_input.files[i]);
    }


    fd.append('image_category', global_image_key);

    $.ajax({
      url: "/upload-product-image/",
      type: "POST",
      headers: {
        'X-CSRFToken': getCsrfToken()
      },
      processData: false,
      contentType: false,
      data: fd,
      success: function (response) {
        console.log("Success!", response);
        $("#upload-preloader").hide();
        $("#upload-image-btn").removeAttr("disabled");

        if (response["status"] == 200) {
          $("#upload-image-modal").modal("close");
          M.toast({ html: "Successfully uploaded images!" });
          fetch_product_images_details();
        }
        else if (response["status"] == 403) {
          M.toast({ html: "You do not have permission to upload images!" });
        }
        else {
          M.toast({ html: "Error uploading images!" });
        }
      },
      error: function (xhr, textstatus, errorthrown) {
        console.log("Please report this error: " + errorthrown + xhr.status + xhr.responseText);
        $("#upload-preloader").hide();
      }
    });
  })

  function set_verify(verified) {
    if (verified == true) {
      $("#pending-icon").css("background-color", "#f7f7f7");
      $("#pending-icon").css("color", "gray");
      $("#verified-icon").css("background-color", "#009051");
      $("#verified-icon").css("color", "white");
    }
    else {
      $("#verified-icon").css("background-color", "#f7f7f7");
      $("#verified-icon").css("color", "gray");
      $("#pending-icon").css("background-color", "orange");
      $("#pending-icon").css("color", "white");
    }
  }

  function fetch_product_details() {
    $.ajax({
      url: "/fetch-product-details/",
      type: "POST",
      headers: {
        'X-CSRFToken': getCsrfToken()
      },
      data: {
        pk: window.location.pathname.split("/")[2]
      },
      success: function (response) {
        console.log("Success!", response);

        global_verification_status = response["verified"];

        if (response["verified"] == true) {
          set_verify(true);
        }
        else {
          set_verify(false);
        }

        $("#pfl-product-name").val(response["pfl_product_name"])
        var pfl_product_features = response["pfl_product_features"]
        $('.material-placeholder').remove();
        $('.main-image').append(`<img class = "preview-img materialboxed" src='` + response["repr_image_url"] + `' high_def_url="` + response["repr_high_def_url"] + `">`)
        $('.materialboxed').materialbox();

        for (var i = 0; i < pfl_product_features.length; i++) {
          $("#pfl-feature-" + (i + 1)).val(pfl_product_features[i]);
          if ((i + 1) != pfl_product_features.length) {
            $("#add-feature-btn").click();
          }
        }

        $("#product-name-amazon-uk").val(response["product_name_amazon_uk"]);
        $("#product-name-amazon-uae").val(response["product_name_amazon_uae"]);
        $("#product-name-sap").val(response["product_name_sap"]);
        $("#product-name-ebay").val(response["product_name_ebay"]);
        $("#product-name-noon").val(response["product_name_noon"]);
        $("#category").val(response["category"]);
        $("#subtitle").val(response["subtitle"]);
        $("#brand-name").val(response["brand"]);
        $("#manufacturer").val(response["manufacturer"]);
        $("#product-id").val(response["product_id"]);
        $("#product-id-type").val(response["product_id_type"]);
        $("#seller-sku").val(response["seller_sku"]);
        $("#manufacturer-part-number").val(response["manufacturer_part_number"]);
        $("#barcode-string").val(response["barcode_string"]);
        $("#noon-product-type").val(response["noon_product_type"]);
        $("#noon-product-subtype").val(response["noon_product_subtype"]);
        $("#noon-model-name").val(response["noon_model_name"]);
        $("#noon-model-number").val(response["noon_model_number"]);

        $("#condition-type").val(response["condition_type"]);
        $("#feed-product-type").val(response["feed_product_type"]);
        $("#update-delete").val(response["update_delete"]);
        $("#recommended-browse-nodes").val(response["recommended_browse_nodes"]);



        var product_attribute_list_amazon_uk = response["product_attribute_list_amazon_uk"];
        if (product_attribute_list_amazon_uk.length > 0) {
          $("#product-attribute-amazon-uk-1").val(product_attribute_list_amazon_uk[0]);
        }
        for (var i = 1; i < product_attribute_list_amazon_uk.length; i++) {
          $("#add-product-attribute-amazon-uk-btn").click();
          $("#product-attribute-amazon-uk-" + (i + 1)).val(product_attribute_list_amazon_uk[i]);
        }

        var product_attribute_list_amazon_uae = response["product_attribute_list_amazon_uae"];
        if (product_attribute_list_amazon_uae.length > 0) {
          $("#product-attribute-amazon-uae-1").val(product_attribute_list_amazon_uae[0]);
        }
        for (var i = 1; i < product_attribute_list_amazon_uae.length; i++) {
          $("#add-product-attribute-amazon-uae-btn").click();
          $("#product-attribute-amazon-uae-" + (i + 1)).val(product_attribute_list_amazon_uae[i]);
        }

        var product_attribute_list_ebay = response["product_attribute_list_ebay"];
        if (product_attribute_list_ebay.length > 0) {
          $("#product-attribute-ebay-1").val(product_attribute_list_ebay[0]);
        }
        for (var i = 1; i < product_attribute_list_ebay.length; i++) {
          $("#add-product-attribute-ebay-btn").click();
          $("#product-attribute-ebay-" + (i + 1)).val(product_attribute_list_ebay[i]);
        }

        var product_attribute_list_noon = response["product_attribute_list_noon"];
        if (product_attribute_list_noon.length > 0) {
          $("#product-attribute-noon-1").val(product_attribute_list_noon[0]);
        }
        for (var i = 1; i < product_attribute_list_noon.length; i++) {
          $("#add-product-attribute-noon-btn").click();
          $("#product-attribute-noon-" + (i + 1)).val(product_attribute_list_noon[i]);
        }

        $("#search-terms").val(response["search_terms"]);
        $("#color-map").val(response["color_map"]);
        $("#color").val(response["color"]);
        $("#enclosure-material").val(response["enclosure_material"]);
        $("#cover-material-type").val(response["cover_material_type"]);

        var special_features = response["special_features"];
        if (special_features.length > 0) {
          $("#special-feature-1").val(special_features[0]);
        }
        for (var i = 1; i < special_features.length; i++) {
          $("#add-special-feature-btn").click();
          $("#special-feature-" + (i + 1)).val(special_features[i]);
        }

        $("#special-feature").val(response["special_features"]);
        $("#package-length").val(response["package_length"]);
        $("#package-length-metric").val(response["package_length_metric"]);
        $("#package-width").val(response["package_width"]);
        $("#package-width-metric").val(response["package_width_metric"]);
        $("#package-height").val(response["package_height"]);
        $("#package-height-metric").val(response["package_height_metric"]);
        $("#package-weight").val(response["package_weight"]);
        $("#package-weight-metric").val(response["package_weight_metric"]);
        $("#shipping-weight").val(response["shipping_weight"]);
        $("#shipping-weight-metric").val(response["shipping_weight_metric"]);
        $("#item-display-weight").val(response["item_display_weight"]);
        $("#item-display-weight-metric").val(response["item_display_weight_metric"]);
        $("#item-display-volume").val(response["item_display_volume"]);
        $("#item-display-volume-metric").val(response["item_display_volume_metric"]);
        $("#item-display-length").val(response["item_display_length"]);
        $("#item-display-length-metric").val(response["item_display_length_metric"]);
        $("#item-weight").val(response["item_weight"]);
        $("#item-weight-metric").val(response["item_weight_metric"]);
        $("#item-length").val(response["item_length"]);
        $("#item-length-metric").val(response["item_length_metric"]);
        $("#item-width").val(response["item_width"]);
        $("#item-width-metric").val(response["item_width_metric"]);
        $("#item-height").val(response["item_height"]);
        $("#item-height-metric").val(response["item_height_metric"]);
        $("#item-display-width").val(response["item_display_width"]);
        $("#item-display-width-metric").val(response["item_display_width_metric"]);
        $("#item-display-height").val(response["item_display_height"]);
        $("#item-display-height-metric").val(response["item_display_height_metric"]);
        $("#item-count").val(response["item_count"]);
        $("#item-count-metric").val(response["item_count_metric"]);
        $("#item-condition-note").val(response["item_condition_note"]);
        $("#max-order-quantity").val(response["max_order_quantity"]);
        $("#number-of-items").val(response["number_of_items"]);
        $("#wattage").val(response["wattage"]);
        $("#wattage-metric").val(response["wattage_metric"]);
        $("#material-type").val(response["material_type"]);
        $("#parentage").val(response["parentage"]);
        $("#parent-sku").val(response["parent_sku"]);
        $("#relationship-type").val(response["relationship_type"]);
        $("#variation-theme").val(response["variation_theme"]);
        $("#standard-price").val(response["standard_price"]);
        $("#quantity").val(response["quantity"]);
        $("#sale-price").val(response["sale_price"]);
        $("#sale-from").val(response["sale_from"]);
        $("#sale-end").val(response["sale_end"]);

        $("#noon-msrp-ae").val(response["noon_msrp_ae"]);
        $("#noon-msrp-ae-unit").val(response["noon_msrp_ae_unit"]);



        global_images = response["images"];

        $("#all-images-option").html("All Images (" + global_images["all_images"].length + ")");
        $("#main-images-option").html("Main Images (" + global_images["main_images"].length + ")");
        $("#sub-images-option").html("Sub Images (" + global_images["sub_images"].length + ")");
        $("#pfl-images-option").html("PFL Images (" + global_images["pfl_images"].length + ")");
        $("#pfl-generated-images-option").html("PFL Generated Images (" + global_images["pfl_generated_images"].length + ")");
        $("#white-background-images-option").html("White Background Images (" + global_images["white_background_images"].length + ")");
        $("#lifestyle-images-option").html("Lifestyle Images (" + global_images["lifestyle_images"].length + ")");
        $("#certificate-images-option").html("Certificate Images (" + global_images["certificate_images"].length + ")");
        $("#giftbox-images-option").html("Giftbox Images (" + global_images["giftbox_images"].length + ")");
        $("#diecut-images-option").html("Diecut Images (" + global_images["diecut_images"].length + ")");
        $("#aplus-content-images-option").html("A+ Content Images (" + global_images["aplus_content_images"].length + ")");
        $("#ads-images-option").html("Ads Images (" + global_images["ads_images"].length + ")");
        $("#unedited-images-option").html("Unedited Images (" + global_images["unedited_images"].length + ")");

        update_grid_images(global_image_key);

        $('#brand-image-img').attr("src", response["brand_logo"]);
        if (global_images["main_images"].length > 0) {
          $('#pfl-product-image-preview-img').attr("src", global_images["main_images"][0]["main-url"]);
        }
        $('#barcode-image-preview-img').attr("src", response["barcode_image_url"]);

        $("#pfl-editor-link").attr("href", "/pfl/" + response["pfl_pk"]);

        M.updateTextFields();
        $('select').formSelect();
      },
      error: function (xhr, textstatus, errorthrown) {
        console.log("Please report this error: " + errorthrown + xhr.status + xhr.responseText);
      }
    });
  }

  fetch_product_details();


</script>

{% endblock %}