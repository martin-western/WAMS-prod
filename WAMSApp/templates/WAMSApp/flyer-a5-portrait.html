{% load static %}

<!DOCTYPE html>
<html lang="en" style="height: 100%;">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  
  <title>OmnyComm</title>

  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"> -->
  <link rel="stylesheet" href="{% static 'WAMSApp/css/materialize.min.css' %}">

  <link href="{% static 'WAMSApp/css/style.css' %}" type="text/css" rel="stylesheet" media="screen,projection"/>

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.13/themes/base/jquery-ui.css"> -->

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gridstack.js/0.3.0/gridstack.min.css" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

</head>

<body class="scroll-style-1">

  <style type="text/css">
    @font-face {
      font-family: AvenirNext;
      src: url("{% static 'WAMSApp/fonts/Avenir-Next-Font/AvenirNextLTPro-Demi.otf' %}");
    }

    @font-face {
      font-family: AvenirNextBold;
      src: url("{% static 'WAMSApp/fonts/Avenir-Next-Font/AvenirNextLTPro-Bold.otf' %}");
    }


    @font-face {
      font-family: AvenirNextRegular;
      src: url("{% static 'WAMSApp/fonts/Avenir-Next-Font/AvenirNextLTPro-Regular.otf' %}");
    }

    @font-face {
      font-family: AvenirNext-Flyer;
      src: url("{% static 'WAMSApp/fonts/Avenir-Next-Font/AvenirNextLTPro-DemiCn.otf' %}");
    }

    @font-face {
      font-family: Helvetica;
      src: url("{% static 'WAMSApp/fonts/Helvetica/Helvetica.ttf' %}");
    }

    @font-face {
      font-family: BebasNeueRegular;
      src: url("{% static 'WAMSApp/fonts/general/BebasNeueRegular.otf' %}");
    }

    @font-face {
      font-family: GothamBookRegular;
      src: url("{% static 'WAMSApp/fonts/general/GothamBookRegular.otf' %}");
    }

    @font-face {
      font-family: FrankRegular;
      src: url("{% static 'WAMSApp/fonts/general/FrankRegular.otf' %}");
    }

    .spinner-layer {
      border-color: white;  
    }

    li span {
      color: black !important;
    }

    body{
      font-family: 'AvenirNext';
    }


    .rotate {

    /* Safari */
    -webkit-transform: rotate(-90deg);

    /* Firefox */
    -moz-transform: rotate(-90deg);

    /* IE */
    -ms-transform: rotate(-90deg);

    /* Opera */
    -o-transform: rotate(-90deg);

    float: left;

    }

    .flyer-search::-webkit-input-placeholder {
       font-size:14px;
       font-family: 'AvenirNextRegular';
    }


    .scroll-style-1::-webkit-scrollbar-track
    {
      -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.3);
      background-color: #F5F5F5;
    }

    .scroll-style-1::-webkit-scrollbar
    {
      width: 3px;
      background-color: #F5F5F5;
    }

    .scroll-style-1::-webkit-scrollbar-thumb
    {
      background-color: #000000;
    }

    li span {
      font: AvenirNextRegular !important;
      font-size: 12px !important;
    }

    .select-wrapper input.select-dropdown {
      font: AvenirNextRegular !important;
      font-size: 12px !important; 
    }

    .grid-stack > .grid-stack-item > .grid-stack-item-content {
      left: 3px !important;
      right: 3px !important;
    }

    /*.grid-stack .grid-stack-placeholder > .placeholder-content {
      left: 2px;
      right: 2px;
    }
    .grid-stack > .grid-stack-item > .grid-stack-item-content {
      left: 2px;
      right: 2px;
    }*/

    .a4-text {
      position: relative;
      bottom: -40px;
    }
    .a4-text-bottom {
      position: relative;
      bottom: 40px;
    }





    .grid-stack > .grid-stack-item {
  min-width: 4.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-width="1"] {
  width: 4.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-x="1"] {
  left: 4.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="1"] {
  min-width: 4.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="1"] {
  max-width: 4.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-width="2"] {
  width: 8.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-x="2"] {
  left: 8.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="2"] {
  min-width: 8.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="2"] {
  max-width: 8.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-width="3"] {
  width: 12.5%;
}
.grid-stack > .grid-stack-item[data-gs-x="3"] {
  left: 12.5%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="3"] {
  min-width: 12.5%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="3"] {
  max-width: 12.5%;
}
.grid-stack > .grid-stack-item[data-gs-width="4"] {
  width: 16.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-x="4"] {
  left: 16.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="4"] {
  min-width: 16.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="4"] {
  max-width: 16.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-width="5"] {
  width: 20.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-x="5"] {
  left: 20.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="5"] {
  min-width: 20.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="5"] {
  max-width: 20.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-width="6"] {
  width: 25%;
}
.grid-stack > .grid-stack-item[data-gs-x="6"] {
  left: 25%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="6"] {
  min-width: 25%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="6"] {
  max-width: 25%;
}
.grid-stack > .grid-stack-item[data-gs-width="7"] {
  width: 29.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-x="7"] {
  left: 29.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="7"] {
  min-width: 29.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="7"] {
  max-width: 29.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-width="8"] {
  width: 33.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-x="8"] {
  left: 33.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="8"] {
  min-width: 33.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="8"] {
  max-width: 33.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-width="9"] {
  width: 37.5%;
}
.grid-stack > .grid-stack-item[data-gs-x="9"] {
  left: 37.5%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="9"] {
  min-width: 37.5%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="9"] {
  max-width: 37.5%;
}
.grid-stack > .grid-stack-item[data-gs-width="10"] {
  width: 41.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-x="10"] {
  left: 41.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="10"] {
  min-width: 41.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="10"] {
  max-width: 41.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-width="11"] {
  width: 45.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-x="11"] {
  left: 45.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="11"] {
  min-width: 45.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="11"] {
  max-width: 45.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-width="12"] {
  width: 50%;
}
.grid-stack > .grid-stack-item[data-gs-x="12"] {
  left: 50%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="12"] {
  min-width: 50%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="12"] {
  max-width: 50%;
}
.grid-stack > .grid-stack-item[data-gs-width="13"] {
  width: 54.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-x="13"] {
  left: 54.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="13"] {
  min-width: 54.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="13"] {
  max-width: 54.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-width="14"] {
  width: 58.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-x="14"] {
  left: 58.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="14"] {
  min-width: 58.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="14"] {
  max-width: 58.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-width="15"] {
  width: 62.5%;
}
.grid-stack > .grid-stack-item[data-gs-x="15"] {
  left: 62.5%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="15"] {
  min-width: 62.5%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="15"] {
  max-width: 62.5%;
}
.grid-stack > .grid-stack-item[data-gs-width="16"] {
  width: 66.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-x="16"] {
  left: 66.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="16"] {
  min-width: 66.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="16"] {
  max-width: 66.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-width="17"] {
  width: 70.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-x="17"] {
  left: 70.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="17"] {
  min-width: 70.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="17"] {
  max-width: 70.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-width="18"] {
  width: 75%;
}
.grid-stack > .grid-stack-item[data-gs-x="18"] {
  left: 75%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="18"] {
  min-width: 75%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="18"] {
  max-width: 75%;
}
.grid-stack > .grid-stack-item[data-gs-width="19"] {
  width: 79.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-x="19"] {
  left: 79.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="19"] {
  min-width: 79.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="19"] {
  max-width: 79.1666666667%;
}
.grid-stack > .grid-stack-item[data-gs-width="20"] {
  width: 83.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-x="20"] {
  left: 83.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="20"] {
  min-width: 83.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="20"] {
  max-width: 83.3333333333%;
}
.grid-stack > .grid-stack-item[data-gs-width="21"] {
  width: 87.5%;
}
.grid-stack > .grid-stack-item[data-gs-x="21"] {
  left: 87.5%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="21"] {
  min-width: 87.5%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="21"] {
  max-width: 87.5%;
}
.grid-stack > .grid-stack-item[data-gs-width="22"] {
  width: 91.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-x="22"] {
  left: 91.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="22"] {
  min-width: 91.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="22"] {
  max-width: 91.6666666667%;
}
.grid-stack > .grid-stack-item[data-gs-width="23"] {
  width: 95.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-x="23"] {
  left: 95.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="23"] {
  min-width: 95.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="23"] {
  max-width: 95.8333333333%;
}
.grid-stack > .grid-stack-item[data-gs-width="24"] {
  width: 100%;
}
.grid-stack > .grid-stack-item[data-gs-x="24"] {
  left: 100%;
}
.grid-stack > .grid-stack-item[data-gs-min-width="24"] {
  min-width: 100%;
}
.grid-stack > .grid-stack-item[data-gs-max-width="24"] {
  max-width: 100%;
}









.font-to-avenir {
      font: AvenirNext;
    }
    .grid-item-img-container {
      height: 80%;
      width: 100%;
      /*align-items: center;
      display: flex;*/
    }
    .grid-item-footer-container {
      height: 20%;
      width: 100%;
      /* background-color: red; */
      margin:0;
      display: flex;
      padding: 5px;
    }
    .grid-item-footer-container {
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
    }
    .footer-bottom {
      display: flex !important;
      flex-direction: row !important;
      justify-content: space-between !important;
    }
    .grid-item-footer-left {
      display: flex;
      flex-direction: column;
      width: 70% ;
      justify-content: center  !important;
      text-align: left;
    }
    .grid-item-footer-right {
      display: flex;
      flex-direction: column;
      max-width: 80px;
      justify-content: flex-end  !important;
      text-align: right;
      /*background: yellow;*/
      /*padding: 1%;*/
    }
    .grid-item-footer-right > input {
      text-align: right;
      background: yellow;
      padding-right: 5px;
    }
    .footer-bottom-left-input {
      border: none;
      font-size: 12px;
      width: 100%;
    }
    .footer-bottom-left-input:focus {
      outline: none;
      border-bottom: 1px solid rgba(136, 136, 136, 0.521);
    }
    .grid-item-text {
      font-size: 8.5px;
      margin:0;
    }
    .grid-item-text-2 {
      font-size: 12px;
      margin:0;
    }
    .grid-item-text-3 {
      font-size: 18px;
      margin:0;
    }
    .grid-item-text-4 {
      font-size: 8.5px;
      margin:0;
    }

    .grid-item-footer-left > input {
      background-color: transparent
    }
    .grid-stack-item-content {
      /*width: 100% !important;
      height: 100%;*/
      position: relative;
    }

    .custom-slider::-webkit-slider-thumb {
      background-color: #521893 !important;
    }


    .flyer-item-box {
      display: flex;
      align-items: center;
    }



    /* grid item sticker */ 
    .grid-item-sticker {  
      position: absolute; 
      top: 10px; 
      right: 10px;  
    } 
    .grid-item-sticker > img {  
      height: auto; 
      width: 40px;  
      border-radius: 0 0 0 0; 
    } 
  .center-vertically {  
    display: flex;  
    align-items: center;  
  } 
  .center-horizontally {  
    display: flex;  
    justify-content: center;  
  } 
  .left-horizontally {  
    display: flex;  
    align-items: center;  
    justify-content: flex-start;  
  } 
  .right-horizontally { 
    display: flex;  
    align-items: center;  
    justify-content: flex-end;  
  } 
  .align-right {  
    text-align: right;  
  } 
  .align-left { 
    text-align: left; 
  } 
  .align-center { 
    text-align: center; 
  } 
/* Checkbox */  
  .checkbox-flyer[type="checkbox"].filled-in:checked + span:not(.lever):after   
  { 
      border: 2px solid #521893;    
      background-color: #521893;  
  } 
    
/* Radio button */  
  [type="radio"]:checked + span:after,  
  [type="radio"].with-gap:checked + span:before,  
  [type="radio"].with-gap:checked + span:after {  
   border: 2px solid #521893; 
  } 
  [type="radio"]:checked + span:after,  
  [type="radio"].with-gap:checked + span:after {  
    background-color: #521893;  
  } 
  input[type=range]+.thumb {  
    background-color: #521893;  
  }




  /* strikethrough code */
  .strikethrough {
    text-decoration:line-through;
    text-align: right;
  }
  .footer-top {
    display: flex; 
    flex-direction: row;
  }
  .footer-top-left {
    width: 50%;
  }
  .footer-top-right {
    width: 50%;
  }
  .footer-top-right > input {
    font-size: 8.5px;
    border: none;
    width: 100%;
    text-align: right;
    background: transparent;
  }
    
  </style>

  {% csrf_token %}
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/0.10.0/lodash.min.js"></script>

  <script type="text/javascript" src="{% static 'WAMSApp/js/jquery.js' %}"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js" type="text/javascript"></script>

  <script type="text/javascript" src="{% static 'WAMSApp/js/jquery.dataTables.min.js' %}"></script>
  <!-- <script type="text/javascript" src="{% static 'WAMSApp/js/materialize-.js' %}"></script> -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>



  <!-- <script type="text/javascript" src="{% static 'WAMSApp/js/gridstack.min.js' %}"></script> -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/gridstack@0.3.0/dist/gridstack.all.js"></script>
  <script type="text/javascript" src="{% static 'WAMSApp/js/gridstack.jQueryUI.min.js' %}"></script>

  
  <div class="row" style="margin-bottom: 0em;">

    <div class="scroll-style-1 col m4" style="position: fixed;height: 100vh;overflow-y: scroll;background-color: #EAEAEA;z-index: 99;">
      <div class="row white" style="margin-bottom: 0em;">
        <div class="col s1" style="margin-top: 0.4em;">
          <i class="material-icons" style="position: absolute;margin-top: 0.5em;margin-left: 0.5em;color: #717171;">search</i>
        </div>
        <div class="input-field col s11" style="margin-bottom: 0em;margin-top: 0.4em;">
          <input id="autocomplete-input" placeholder="Search by product name" type="text" class="validate flyer-search" style="border-bottom: none;box-shadow: none;text-indent: 0.5em;">
        </div>
      </div>
      
      <div class="row">

        <!-- Product Basket -->
        <div class="col s12" style="width: 90%;margin-left: 5%;padding-top: 1em;margin-top: 1em;">
          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.4em;margin-left: -0.5em;">shopping_basket</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Product Basket</span>
          </span>
          
          <div id="product-basket-list-div" class="scroll-style-1 row white hoverable" style="margin-top:0.5em;min-height:6em;max-height: 20em;overflow-y: auto;padding-left: 1.2em;padding-right: 0.4em;padding-top: 0.8em;">
          </div>
        </div>


        <!-- Image Categories -->
        <div class="col s12" style="width: 90%;margin-left: 5%;margin-top: 1em;">
          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.5em;margin-left: -0.5em;">image</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Image Categories</span>
          </span>

          <div class="scroll-style-1 row white hoverable" style="margin-top:0.5em;">
            <div class="input-field col s8" style="margin-top: 0em;">
              <select id="image-categories-thumbnails-select" style="font-size: 0.8em;">
                <option value="all_images" id="all-images-option">All Images</option>
                <option value="main_images" id="main-images-option">Main Images</option>
                <option value="sub_images" id="sub-images-option">Sub Images</option>
                <option value="pfl_images" id="pfl-images-option">PFL Images</option>
                <option value="white_background_images" id="white-background-images-option">White Background Images</option>
                <option value="lifestyle_images" id="lifestyle-images-option">Lifestyle Images</option>
                <option value="certificate_images" id="certificate-images-option">Certificate Images</option>
                <option value="giftbox_images" id="giftbox-images-option">Giftbox Images</option>
                <option value="diecut_images" id="diecut-images-option">Diecut Images</option>
                <option value="aplus_content_images" id="aplus-content-images-option">A+ Content Images</option>
                <option value="ads_images" id="ads-images-option">Ads Images</option>
                <option value="unedited_images" id="unedited-images-option">Unedited Images</option>
                <option value="transparent_images" id="transparent-images-option">Transparent Images</option>
              </select>
            </div>

            <div class="col s12">
              <div id="image-categories-thumbnails-div" class="scroll-style-1 row" style="max-height: 10em;overflow-y:auto;margin-bottom: 0em;">
              </div>
            </div>
          </div>
        </div>


        <!-- External Image Categories -->
        <div class="col s12" style="width: 90%;margin-left: 5%;margin-top: 1em;">
          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.5em;margin-left: -0.5em;">image</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">External Image Categories</span>
            <!-- <a href="#upload-image-modal" id="import-btn" class="disabled" style="position: absolute;">  
              <i class="material-icons" title="Add Image" style="
                color: gray;
                padding: 8px;
                margin-top: -10px;">
                add_photo_alternate
              </i>
            </a> -->
            <a href="#upload-image-modal" id="import-btn" class="modal-trigger" style="position: absolute;margin-left: 0.5em;margin-top: -0.2em;">
              <i class="material-icons" style="font-size: 1.5em;color:#717171;">add_photo_alternate</i>
            </a>
          </span>
          <!-- <i class="material-icons" style="position: absolute;font-size: 1.5em;margin-left: -0.5em;">image</i> -->

          <div class="scroll-style-1 row white hoverable" style="margin-top:0.5em;">
            <div class="col s12">
              <div id="external-image-categories-thumbnails-div" class="scroll-style-1 row" style="min-height:3em;max-height: 10em;overflow-y:auto;margin-bottom: 0em;">
              </div>
            </div>
          </div>
        </div>



        <!-- Background Image Bucket -->
        <div class="col s12" style="width: 90%;margin-left: 5%;margin-top: 1em;position: relative;">
          <span style="font-family: 'AvenirNextRegular';color:#717171;margin-bottom: 1em;">
            <i class="material-icons" style="position: absolute;font-size: 1.5em;margin-left: -0.5em;">image</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Background Image Bucket</span>
            <a href="#add-new-bg-modal" class="right modal-trigger btn-floating btn-small waves-effect waves-light green" style="transform: scale(0.7);position: absolute;right: 0px;top: -8px; ">
              <i class="material-icons">add</i>
            </a>
          </span>

          <div id="background-image-bucket-thumbnails-div" class="scroll-style-1 row white hoverable" style="margin-top:0.5em;max-height:10em;overflow-y:auto;padding-top: 0.6em;">
          </div>
        </div>

        <!-- Border Settings -->        
        <div class="col s12" style="width: 90%;margin-left: 5%;margin-top: 1em;">

          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.3em;margin-left: -0.5em;">border_all</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Border Settings</span>
          </span>
          
          <div class="row white hoverable" style="margin-top:0.5em;padding-top:0.6em;padding-bottom: 0.6em;">
            <div class="col s6" style="margin-top: 1em;">
              <label>
                <input id="border-option" class="filled-in checkbox-flyer" type="checkbox" checked />
                <span class="left" style="font-size: 14px;font-family: 'AvenirNext';">Border Visible</span>
              </label>
            </div>

            <div class="input-field col s6">
              <span>Border Color</span>
              <input id="border-color" type="color" value="#EBEBEB"> 
            </div>

          </div>

          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.3em;margin-left: -0.5em;">dashboard</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Header Logos</span>
          </span>
          <div class="row white hoverable" style="margin-top:0.5em;padding-top:0.6em;padding-bottom: 0.6em;">
            <div class="col s12" style="margin: 8px 0">
              <label>
                <input id="super-brand-option" type="checkbox" class="filled-in checkbox-flyer" checked />
                <span class="left" style="font-size: 14px;font-family: 'AvenirNext';">Superbrands</span>
              </label>
            </div>
            <div class="col s12" style="margin: 8px 0">
              <label>
                <input id="iso-option" type="checkbox" class="filled-in checkbox-flyer" checked />
                <span class="left" style="font-size: 14px;font-family: 'AvenirNext';">ISO</span>
              </label>
            </div>
            <div class="col s12" style="margin: 8px 0">
              <label>
                <input id="consumer-option" type="checkbox" class="filled-in checkbox-flyer" checked />
                <span class="left" style="font-size: 14px;font-family: 'AvenirNext';">Tagline</span>
              </label>
            </div>
            <div class="col s12" style="margin: 8px 0">
              <label>
                <input id="small-brand-option" type="checkbox" class="filled-in checkbox-flyer" checked />
                <span class="left" style="font-size: 14px;font-family: 'AvenirNext';">Brand (Container)</span>
              </label>
            </div>
            <div class="col s12" style="margin: 8px 0">
              <label>
                <input id="white-option" type="checkbox" class="filled-in checkbox-flyer" checked />
                <span class="left" style="font-size: 14px;font-family: 'AvenirNext';">White (Container)</span>
              </label>
            </div>
          </div>
          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.3em;margin-left: -0.5em;">camera_font</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Image Resizer</span>
          </span>
          <div class="row white  hoverable" style="margin-top:0.5em;padding-top:0.6em;padding-bottom: 0.6em;">
            <div class="col s12">
                <p class="range-field" style="width:100%;">
                  <input class="custom-slider" type="range" id="image-resizer" min="10" max="150" value="100" />
                </p>
            </div>
          </div>

          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.3em;margin-left: -0.5em;">compare</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Resize All Images</span>
          </span>
          <div class="row white  hoverable" style="margin-top:0.5em;padding-top:0.6em;padding-bottom: 0.6em;">
            <div class="col s12">
                <p class="range-field" style="width:100%;">
                  <input class="custom-slider" type="range" id="all-image-resizer" min="10" max="150" value="100" />
                </p>
            </div>
          </div>


          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.3em;margin-left: -0.5em;">transform</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Resize Price Box</span>
          </span>
          <div class="row white  hoverable" style="margin-top:0.5em;padding-top:0.6em;padding-bottom: 0.6em;">
            <div class="col s12">
                <p class="range-field" style="width:100%;">
                  <input class="custom-slider" type="range" id="price-resizer" min="10" max="150" value="80" />
                </p>
            </div>
          </div>


          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.3em;margin-left: -0.5em;">book</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Promotional Tags</span>
          </span>
          <div class="row white hoverable" style="margin-top:0.5em;padding: 1em;">
            <div class="col s6">
              <span style="font-family: 'AvenirNext';color:#717171;">
                <span style="font-size: 14px;font-weight: bold;">Apply to All</span>
              </span>
              <form action="#">
                <p>
                  <label>
                    <input id="global-none" value="None" name="group1" type="radio" checked />
                    <span>None</span>
                  </label>
                </p>
                <p>
                  <label>
                    <input id="global-sale" value="Sale" name="group1" type="radio" />
                    <span>Sale</span>
                  </label>
                </p>
                <p>
                  <label>
                    <input id="global-combo" value="Combo Offers" name="group1" type="radio" />
                    <span>Combo Offers</span>
                  </label>
                </p>
                <p>
                  <label>
                    <input id="global-wow" value="Wow" name="group1" type="radio"  />
                    <span>Wow</span>
                  </label>
                </p>
                <p>
                  <label>
                    <input id="global-warranty" type="checkbox" class="filled-in checkbox-flyer" />
                    <span>Warranty</span>
                  </label>
                </p>
              </form>
            </div>
            <div class="col s6">
              <span style="font-family: 'AvenirNext';color:#717171;">
                <span style="font-size: 14px;font-weight: bold;">Apply to One</span>
              </span>
              <form action="#">
                <p>
                  <label>
                    <input id="local-none" value="None" name="group2" type="radio" checked />
                    <span>None</span>
                  </label>
                </p>
                <p>
                  <label>
                    <input id="local-sale" value="Sale" name="group2" type="radio" />
                    <span>Sale</span>
                  </label>
                </p>
                <p>
                  <label>
                    <input id="local-combo" value="Combo Offers" name="group2" type="radio" />
                    <span>Combo Offers</span>
                  </label>
                </p>
                <p>
                  <label>
                    <input id="local-wow" value="Wow" name="group2" type="radio"  />
                    <span>Wow</span>
                  </label>
                </p>
                <p>
                  <label>
                    <input id="local-warranty" type="checkbox" class="filled-in checkbox-flyer" />
                    <span>Warranty</span>
                  </label>
                </p>
              </form>
            </div>
          </div>



          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.3em;margin-left: -0.5em;">transform</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Resize Promotional Tags</span>
          </span>
          <div class="row white hoverable" style="margin-top:0.5em;padding-top:0.6em;padding-bottom: 0.6em;">
            <div class="col s12">
                <p class="range-field" style="width:100%;">
                  <input class="custom-slider" type="range" id="promo-resizer" min="10" max="80" value="40" />
                </p>
            </div>
          </div>


          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.3em;margin-left: -0.5em;">transform</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Resize All Promotional Tags</span>
          </span>
          <div class="row white hoverable" style="margin-top:0.5em;padding-top:0.6em;padding-bottom: 0.6em;">
            <div class="col s12">
                <p class="range-field" style="width:100%;">
                  <input class="custom-slider" type="range" id="all-promo-resizer" min="10" max="80" value="40" />
                </p>
            </div>
          </div>



        </div>

























         <!-- Product Title Settings -->        
        <div class="col s12" style="width: 90%;margin-left: 5%;margin-top: 1em;">

          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.3em;margin-left: -0.5em;">font_download</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Product Title Settings</span>
          </span>
          
          <div class="row white hoverable" style="margin-top:0.5em;padding:5px">
            <div class="input-field col s6" style="margin-top: 1em !important;">
              <input id="product-title-font-size" type="number" value="12">
              <label for="product-title-font-size">Font Size</label>  
            </div>

            <div class="input-field col s6" style="margin-bottom: 1em;">
              <select id="product-title-font-family">
                <option value="Arial">Arial</option> 
                <option value="Impact">Impact</option>
                <option value="Helvetica" selected>Helvetica</option>
                <option value="AvenirNextRegular">AvenirNextRegular</option>
                <option value="BebasNeueRegular">Bebas Neue Regular</option>
                <option value="FrankRegular">Frank Regular</option>
                <option value="GothamBookRegular">Gotham Book Regular</option>
              </select>
              <label>Font Family</label>
            </div>

            <div class="input-field col s6" style="margin-bottom: 1em;">
              <select id="product-title-font-weight">
                <option value="normal">Normal</option> 
                <option value="bold">Bold</option>
              </select>
              <label>Font Weight</label>
            </div>  

            <div class="input-field col s6" style="margin-top: 2em !important;">
              <span>Font Color</span>
              <input id="product-title-font-color" type="color" value="#181818"> 
            </div>

          </div>
        </div>



         <!-- Price Box Settings -->        
        <div class="col s12" style="width: 90%;margin-left: 5%;margin-top: 1em;">

          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.3em;margin-left: -0.5em;">font_download</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Price Box Settings</span>
          </span>
          
          <div class="row white hoverable" style="margin-top:0.5em;">
            <!-- Font Size -->
            <div class="input-field col s6" style="margin-top: 2em !important;">
              <input id="product-price-font-size" type="number" value="18">
              <label for="product-price-font-size">Price Font Size</label>
            </div>

            <div class="input-field col s6" style="margin-top: 2em !important;">
              <input id="currency-font-size" type="number" value="8.5">
              <label for="currency-font-size">Currency Font Size</label>  
            </div>


            <!-- Font Family -->
            <div class="input-field col s6" style="margin-bottom: 1em;">
              <select id="product-price-font-family">
                <option value="Arial">Arial</option> 
                <option value="Impact">Impact</option>
                <option value="Helvetica" selected>Helvetica</option>
                <option value="AvenirNextRegular">AvenirNextRegular</option>
                <option value="BebasNeueRegular">Bebas Neue Regular</option>
                <option value="FrankRegular">Frank Regular</option>
                <option value="GothamBookRegular">Gotham Book Regular</option>
              </select>
              <label>Price Font Family</label>
            </div>

            <div class="input-field col s6" style="margin-bottom: 1em;">
              <select id="currency-font-family">
                <option value="Arial">Arial</option> 
                <option value="Impact">Impact</option>
                <option value="Helvetica" selected>Helvetica</option>
                <option value="AvenirNextRegular">AvenirNextRegular</option>
                <option value="BebasNeueRegular">Bebas Neue Regular</option>
                <option value="FrankRegular">Frank Regular</option>
                <option value="GothamBookRegular">Gotham Book Regular</option>
              </select>
              <label>Currency Font Family</label>
            </div>


            <!-- Font Weight -->
            <div class="input-field col s6" style="margin-bottom: 1em;">
              <select id="product-price-font-weight">
                <option value="normal">Normal</option> 
                <option value="bold">Bold</option>
              </select>
              <label>Price Font Weight</label>
            </div>

            <div class="input-field col s6" style="margin-bottom: 1em;">
              <select id="currency-font-weight">
                <option value="normal">Normal</option> 
                <option value="bold">Bold</option>
              </select>
              <label>Currency Font Weight</label>
            </div>


            <!-- Font Color -->
            <div class="input-field col s6" style="margin-top: 2em !important;">
              <span>Price Font Color</span>
              <input id="product-price-font-color" type="color" value="#181818"> 
            </div>

            
            <div class="input-field col s6" style="margin-top: 2em !important;">
              <span>Currency Font Color</span>
              <input id="currency-font-color" type="color" value="#181818"> 
            </div>


            <div class="input-field col s6" style="margin-top: 1em !important;">
              <input id="currency-unit" type="text" value="AED">
              <label for="currency-unit">Currency</label>  
            </div>

            <div class="input-field col s6" style="margin-top: 2em !important;">
              <span>Box BG Color</span>
              <input id="price-box-bg-color" type="color" value="#FBF00B"> 
            </div>

          </div>
        </div>



        <!-- Strike Price Settings -->
        <div class="col s12" style="width: 90%;margin-left: 5%;margin-top: 1em;">

          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.3em;margin-left: -0.5em;">font_download</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Strike Price Settings</span>
          </span>
          
          <div class="row white hoverable" style="margin-top:0.5em;">

            <!-- Font Size -->
            <div class="input-field col s6" style="margin-top: 2em;">
              <input id="product-strikeprice-font-size" type="number" value="8.5">
              <label for="product-strikeprice-font-size">Price Font Size</label>
            </div>

            <!-- Font Family -->
            <div class="input-field col s6" style="margin-top: 2em">
              <select id="product-strikeprice-font-family">
                <option value="Arial">Arial</option> 
                <option value="Impact">Impact</option>
                <option value="Helvetica" selected>Helvetica</option>
                <option value="AvenirNextRegular">AvenirNextRegular</option>
                <option value="BebasNeueRegular">Bebas Neue Regular</option>
                <option value="FrankRegular">Frank Regular</option>
                <option value="GothamBookRegular">Gotham Book Regular</option>
              </select>
              <label>Price Font Family</label>
            </div>


            <!-- Font Weight -->
            <div class="input-field col s6" style="margin-bottom: 1em;">
              <select id="product-strikeprice-font-weight">
                <option value="normal">Normal</option> 
                <option value="bold">Bold</option>
              </select>
              <label>Price Font Weight</label>
            </div>


            <!-- Font Color -->
            <div class="input-field col s6" style="margin-top: 2em !important;">
              <span>Price Font Color</span>
              <input id="product-strikeprice-font-color" type="color" value="#181818"> 
            </div>

            <!-- Show/Hide -->
            <div class="col s12" style="margin: 8px 0">
              <label>
                <input id="strikeprice-option" type="checkbox" class="filled-in checkbox-flyer" checked />
                <span class="left" style="font-size: 14px;font-family: 'AvenirNext';">Strike Price Visible</span>
              </label>
            </div>


          </div>
        </div>





        <!-- Header Footer Settings -->        
        <div class="col s12" style="width: 90%;margin-left: 5%;margin-top: 1em;">

          <span style="font-family: 'AvenirNextRegular';color:#717171;">
            <i class="material-icons" style="position: absolute;font-size: 1.3em;margin-left: -0.5em;">view_day</i>
            <span style="margin-left: 1.5em;font-size: 14px;font-weight: bold;">Header/Footer Settings</span>
          </span>
          
          <div class="row white hoverable" style="margin-top:0.5em;padding:5px;">
            <div class="input-field col s6" style="margin-top: 0em !important;">
              <p style="font-family: 'AvenirNext'; font-size: 14px;margin-bottom: 0em;">Header Color</p>
              <input id="header-color" type="color" value="#181818">  
            </div>

            <div class="input-field col s6" style="margin-top: 0em !important;">
              <p style="font-family: 'AvenirNext'; font-size: 14px;margin-bottom: 0em;">Footer Color</p>
              <input id="footer-color" type="color" value="#181818">
            </div>
          </div>
        </div>


        


        <div class="col s12" style="width: 90%;margin-left: 5%;padding-right: 0em;">
          <a id="save-flyer-template-btn" class="btn right hoverable" style="background-color: #521893;font-size: 14px;font-family: 'AvenirNext';">Save</a>
        </div>
        
      </div>

    </div>


    <div class="col m8 offset-m4" style="background-color: #393939;">
      <div>
        <div class="row" style="margin-left: auto;">
          <div class="col s12 center" style="padding-left: 0em;padding-right: 0em;">
            <br>
            <a class="btn" href="/flyer-dashboard" title="Home" style="background-color: #717171;position:absolute;text-transform: none;margin-left: 0em;"><i class="material-icons">home</i></a>
            <a id="add-grid-item-btn" class="btn" title="Add Grid Item" style="background-color: #717171;position:absolute;text-transform: none;margin-left: 4em;"><i class="material-icons">add</i></a>
            <a id="delete-grid-item-btn" class="btn" title="Delete Grid Item" style="background-color: #717171;position:absolute;text-transform: none;margin-left: 8em;"><i class="material-icons">delete</i></a>
            <a id="refresh-template-btn" class="btn " title="Reset Template" style="background-color: #717171;position:absolute;text-transform: none;margin-left: 12em;"><i class="material-icons">refresh</i></a>
            <a id="hide-cursor-btn" cursor-status="on" class="btn " title="Hide cursor" style="background-color: #717171;position:absolute;text-transform: none;margin-left: 16em;"><i class="material-icons">center_focus_strong</i></a>
            <a id="increase-height-btn" class="btn " title="Increase Height" style="background-color: #717171;position:absolute;text-transform: none;margin-left: 20em;"><i class="material-icons">keyboard_arrow_up</i></a>
            <a id="decrease-height-btn" class="btn " title="Decrease Height" style="background-color: #717171;position:absolute;text-transform: none;margin-left: 24em;"><i class="material-icons">keyboard_arrow_down</i></a>

            <a id="download-flyer-btn" class="btn green hoverable" style="width:10em;text-align: left;text-transform: none;margin-left: 170mm;position: relative;">Download<i class="material-icons right">file_download</i>
              <div id="loader-div" class="preloader-wrapper small active" style = "display:none;position: absolute;left: -50px; top: 0px;">
                <div class="spinner-layer spinner-green-only">
                  <div class="circle-clipper left">
                    <div class="circle"></div>
                  </div><div class="gap-patch">
                    <div class="circle"></div>
                  </div><div class="circle-clipper right">
                    <div class="circle"></div>
                  </div>
                </div>
              </div>
            </a>
          </div>
        </div>


        <div class="a4-container">
          <p style="color: silver;" class="a4-text">A5</p>
        </div>
        <hr style="border-bottom: 1px dashed silver;opacity: .3;margin:0;">
        <div id="flyer-div" class="row white" style="text-align: center;margin-left: auto;margin-right: auto; height: 210mm;width: 148mm;margin-bottom: 0em;">

         <div id="header-div" class="col s12 row valign-wrapper" style="background-color: #181818;text-align: center;width: 148mm;padding: 20px;">  
            <div class="col s6 left-horizontally">  
              <img id="super-brand-img" src="/files/super-brand.png" style="display:none;max-width: 73.5mm;max-height:15mm; margin-right:10px;"> 
              <img id="iso-img" src="/files/iso.png" style="display:none;max-width: 73.5mm;max-height:15mm;margin-right:10px">  
              <img id="consumer-img" src="/files/consumer.png" style="display:none;max-width: 73.5mm;max-height:15mm;margin-right:10px;max-height: 40px;">
              <!-- <div> 
                <p class="white-text">    
                </p>  
              </div> -->  
                  
            </div>  
            <div class="col s6 right-horizontally" style="">  
              <img id="brand-image-img" src="" style="max-width: 73.5mm;max-height:15mm;">  
            </div>  
          </div>


          <div id="flyer-grid" class="col s12" style="width: 148mm;">
            <div id="grid-stack-div" class="grid-stack" data-gs-width="24" data-gs-animate="yes" data-gs-column="24" style="max-height: 260mm;">
              
            </div>
          </div>


          <div id="footer-div" class="col s12" style="background-color:#181818;position: absolute;margin-top: 200mm;width:148mm;height: 10mm;">
            <div class="white-text" style="font-size: 1.1em;margin-top:-1mm;">
              <p class="right" style="font-size: 0.8em;color:white;font-family:'AvenirNextRegular';">For more information, please visit www.geepas.com</p>
            </div>
          </div>


        </div>
        <hr style="border-bottom: 1px dashed silver;opacity: .3;margin:0">
        <div class="a4-container-bottom">
          <p style="color: silver;" class="a4-text-bottom">A5</p>
        </div>

      </div>
    </div>
  </div>

  <div id="price-info-modal" class="modal">
    <div class="modal-content">
      <h5 style="font-family: 'AvenirNext';font-size: 18px">PRODUCT INFO</h5>
      <br>
      <div class="row">
        <div class="input-field col s8">
          <input id="product-info-name" type="text" class="validate">
          <label for="product-info-name">Product Name</label>
        </div>

        <div class="input-field col s4">
          <input id="product-info-price" type="text" class="validate">
          <label for="product-info-price">Product Price</label>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect btn-flat">Cancel</a>
      <a id="product-info-save-btn" href="#!" class="modal-close waves-effect btn-flat white-text" style="background-color: #521893;">Save</a>
    </div>
  </div>


  <div id="upload-image-modal" class="modal">
  <div class="modal-content">
    <h4 style="font-family:'AvenirNext';font-size:18px;">Upload Image</h4>
    <div class="file-field input-field">
      <div class="btn" style = "background-color: #512da8">
        <span style="font-size:14px;">File</span>
        <input id="product-image-input" type="file" multiple>
      </div>
      <div class="file-path-wrapper">
        <input class="file-path validate" type="text">
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <a href="#!" class="modal-close waves-effect waves-green btn-flat">Cancel</a>
    <a id="upload-image-btn" href="#!" class="waves-effect waves-green btn-flat blue white-text" style="background-color:#009051 !important ;">Upload</a>
    <div class="progress" id = "upload-preloader" style = "display:none;margin: 0px !important;background-color: white !important;">
      <div class="indeterminate" style = "background-color: #512de8;"></div>
    </div>
  </div>
</div>




  <div id="add-new-bg-modal" class="modal">
    <div class="modal-content">
      <h5 style="font-family: 'AvenirNext';font-size: 18px">NEW BACKGROUND IMAGE</h5>
      <br>
      <div class="row">
        
        <div class="file-field input-field col s10">
          <div class="btn" style="background-color: #521893;">
            <span>File</span>
            <input id="new-bg-image" type="file">
          </div>
          <div class="file-path-wrapper">
            <input class="file-path validate" type="text">
          </div>
        </div>

      </div>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect btn-flat">Cancel</a>
      <a id="upload-new-bg-image-btn" href="#!" class="waves-effect btn-flat white-text" style="background-color: #521893;">Save</a>
    </div>
  </div>

  <script type="text/javascript" src="{% static 'WAMSApp/js/canvas2image.js' %}"></script>
  <script type="text/javascript" src="{% static 'WAMSApp/js/html2canvas.min2.js' %}"></script>
  <!-- <script type="text/javascript" src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script> -->
  <script type="text/javascript">


    $('.sidenav').sidenav({
      "inDuration": 150,
      "outDuration": 150
    });

    $("select").formSelect();
    $('.modal').modal();

    $(document).on("change", "#super-brand-option", function(){
      if($("#super-brand-option").prop("checked"))
      {
        $("#super-brand-img").show();
        global_super_brand_logo = true;
      }
      else
      {
        $("#super-brand-img").hide();
        global_super_brand_logo = false;
      }
    });

    $(document).on("change", "#iso-option", function(){
      if($("#iso-option").prop("checked"))
      {
        $("#iso-img").show();
        global_iso_logo = true;
      }
      else
      {
        $("#iso-img").hide();
        global_iso_logo = false;
      }
    });

    $(document).on("change", "#consumer-option", function(){
      if($("#consumer-option").prop("checked"))
      {
        $("#consumer-img").show();
        global_consumer_logo = true;
      }
      else
      {
        $("#consumer-img").hide();
        global_consumer_logo = false;
      }
    });

    $(document).on("change", "#small-brand-option", function(){
      if($("#small-brand-option").prop("checked"))
      {
        $(".brand-text").show();
        global_brand_name_visible = true;
      }
      else
      {
        $(".brand-text").hide();
        global_brand_name_visible = false;
      }
    });

    $(document).on("change", "#white-option", function(){
      if($("#white-option").prop("checked"))
      {
        $(".grid-stack-item-content").css("background-color", "white");
        global_white_container = true;
      }
      else
      {
        $(".grid-stack-item-content").css("background-color", "transparent");
        global_white_container = false;
      }
    });


    $('input[type=radio][name=group1]').change(function() {
        if (this.value == "None") {
            $("#local-none").click();
            $(".banner-img").attr("src", "");
            $(".banner-img").hide();
        }
        else if (this.value == "Sale") {
            $("#local-sale").click();
            $(".banner-img").attr("src", "/files/banner1.png");
            $(".banner-img").show();
        }
        else if(this.value == "Combo Offers")
        {
            $("#local-combo").click();
            $(".banner-img").attr("src", "/files/combo.png");
            $(".banner-img").show();
        }
        else if(this.value == "Wow")
        {
            $("#local-wow").click();
            $(".banner-img").attr("src", "/files/wow.png");
            $(".banner-img").show();
        }
    });

    $("#global-warranty").change(function(){
      if($("#global-warranty").prop("checked")==true)
      {
        $(".banner-img-left").attr("src", "/files/warranty.png");
        $("#local-warranty").prop("checked", true);
      }
      else
      {
        $(".banner-img-left").attr("src", "");
        $("#local-warranty").prop("checked", false);
      }
    });

    $('input[type=radio][name=group2]').change(function() {
        if (this.value == "None") {
            $("#banner-img-"+global_selected_grid_id).attr("src", "");
            $("#banner-img-"+global_selected_grid_id).hide();
        }
        else if (this.value == "Sale") {
            $("#banner-img-"+global_selected_grid_id).attr("src", "/files/banner1.png");
            $("#banner-img-"+global_selected_grid_id).show();
        }
        else if(this.value == "Combo Offers")
        {
            $("#banner-img-"+global_selected_grid_id).attr("src", "/files/combo.png");
            $("#banner-img-"+global_selected_grid_id).show();
        }
        else if(this.value == "Wow")
        { 
            $("#banner-img-"+global_selected_grid_id).attr("src", "/files/wow.png");
            $("#banner-img-"+global_selected_grid_id).show();
        }
    });

    $("#local-warranty").change(function(){
      if($("#local-warranty").prop("checked"))
      {
        $("#banner-img-left-"+global_selected_grid_id).attr("src", "/files/warranty.png");
      }
      else
      {
        $("#banner-img-left-"+global_selected_grid_id).attr("src", "");
      }
    });
    



    var elems  = document.querySelectorAll("input[type=range]");  
    M.Range.init(elems);


    var global_product_bucket_list = [];
    var global_selected_product_pk = "";
    var global_selected_product_name = "";
    var global_product_images_dict = {};
    var global_selected_grid_id = "";
    var global_template_data = {};
    var global_selected_product_info_id = "";
    var global_background_images_bucket = [];
    var global_brand_name = "";
    var global_external_image_bucket = [];
    
    var global_currency_unit = "AED"
    var global_border_visible = true;
    var global_border_color = "#E9E9E9";
    var global_background_image_url = "none";
    var global_product_title_font_size = "12";
    var global_product_title_font_family = "AvenirNextRegular";
    var global_product_title_font_weight = "normal";
    var global_product_title_font_color = "#181818";
    var global_price_font_size = "12";
    var global_price_font_family = "AvenirNextRegular";
    var global_price_font_weight = "normal";
    var global_price_font_color = "#181818";
    var global_strikeprice_font_size = "12";
    var global_strikeprice_font_family = "AvenirNextRegular";
    var global_strikeprice_font_weight = "normal";
    var global_strikeprice_font_color = "#181818";
    var global_currency_font_size = "12";
    var global_currency_font_family = "AvenirNextRegular";
    var global_currency_font_weight = "normal";
    var global_currency_font_color = "#181818";
    var global_price_box_bg_color = "#fbf00b";
    var global_header_color = "#181818";
    var global_footer_color = "#181818";
    var global_all_promo_resizer = "40";
    var global_all_image_resizer = "100";
    var global_super_brand_logo = false;
    var global_iso_logo = false;
    var global_consumer_logo = false;
    var global_brand_name_visible = false;
    var global_white_container = false;
    var global_price_resizer = "100";
    var global_strikeprice_visible = false;



    $("#download-flyer-btn").click(function(e){

      $("#download-flyer-btn").attr("disabled", "disabled");
      $("#loader-div").show();

      var total_grids = $(".grid-stack-item").length;
      var image_links = [];
      var original_bg_image_url = "none";
      if ($("#flyer-div").css("background-image")!="none" ){
        image_links.push({"key": "background_image", "url": $("#flyer-div").css("background-image").split("\"")[1]});
        original_bg_image_url = $("#flyer-div").css("background-image").split("\"")[1];
      }

      for (var i = 0; i <total_grids; i++){
        var grid_id = $($(".grid-stack-item")[i]).attr("grid-id");
        if($("#gridimg-"+grid_id).attr('src')!="null")
        {
          image_links.push({"key": "gridimg-" + grid_id, "url": $("#gridimg-"+grid_id).attr('src')});
        }
      }

      if($("#brand-image-img").attr("src")!="")
      {
        image_links.push({"key": "brand-image-img", "url": $("#brand-image-img").attr("src")});
      }

      console.log("Image Links: ", image_links);

      $.ajax({
        url: "/download-images-s3/",
        type: "POST",
        headers:{
          'X-CSRFToken':getCsrfToken()
        },
        data: { 
          links : JSON.stringify(image_links)
        },
        success: function(response) {
            console.log("Success! ", response);

            if(response["status"]==200)
            {
              //[{"key": "grind-1", "url": "aws/im1.png"}, {}]
              var local_links = response["local_links"];
              
              for(var i=0;i<response["local_links"].length;i++){
                if (local_links[i]["key"] != "background_image"){
                  $("#"+local_links[i]["key"]).attr("src", local_links[i]["url"]);
                }
                else
                {
                  $("#flyer-div").css("background-image", "url('" +local_links[i]["url"]+ "')");
                }
              }

              e.preventDefault();

              var scale = 5;
              var div = document.getElementById('flyer-div');
              var canvas = document.createElement('canvas');
              var h = div.scrollHeight;
              var ratio = canvas.width/canvas.height;
              var w = h * ratio;
              canvas.width = scale*window.devicePixelRatio*div.scrollWidth;
              canvas.height = scale*window.devicePixelRatio*div.scrollHeight;
              canvas.style.width = w + 'px';
              canvas.style.height = h + 'px';
              var context = canvas.getContext('2d');
              context.scale(scale, scale);


              

              $(".divgrid").parent().parent().css("border", "none");
              if($("#border-option").prop("checked"))
              {
                //$(".divgrid").css("border-bottom", "2px solid #E9E9E9");
                //$(".divgrid").parent().parent().css("border", "2px solid #E9E9E9");
              }
              else
              {
                $(".divgrid").parent().parent().css("border-bottom", "none");
                $(".divgrid").parent().parent().parent().css("border", "none");
              }

              function dataURLtoBlob(dataurl) {
                var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
                    bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
                while(n--){
                    u8arr[n] = bstr.charCodeAt(n);
                }
                return new Blob([u8arr], {type:mime});
              }


              //Hide placeholder
              $(".product-title-info").removeAttr("placeholder");
              $(".product-title-info-description").removeAttr("placeholder");
              $(".product-price-info").removeAttr("placeholder");
              //$(".product-strikeprice-info").removeAttr("placeholder");

              window.scrollTo(0,0);
              html2canvas(div, {canvas:canvas, scrollX:-1, scrollY:0}).then(function(canvas) {
                    console.log("Downloading it!!!");

                    $("#download-flyer-btn").removeAttr("disabled");
                    $("#loader-div").hide();
                    
                    var dataURI = canvas.toDataURL("image/jpeg").replace("image/jpeg", "image/octet-stream");

                    var blob = dataURLtoBlob(dataURI);
                    var objurl = URL.createObjectURL(blob);
                    
                    var a = document.createElement('a');
                    a.download = 'flyer_image_'+(window.location.pathname.split("/")[2])+'.jpg';
                    a.href = objurl;
                    a.click();

                    $("#divgrid-"+global_selected_grid_id).parent().parent().css("border", "0.14em dashed");

                    $(".product-title-info-title").attr("placeholder", "product name");
                    $(".product-title-info-description").attr("placeholder", "description");
                    $(".product-price-info").attr("placeholder", "price");


                    $("#flyer-div").css("background-image", "url('" +original_bg_image_url+ "')");
                    //$(".product-strikeprice-info").attr("placeholder", "strikeprice");

                    // var image_data = canvas.toDataURL();

                    // var fd = new FormData();
                    // fd.append('image_data', image_data);
                    // fd.append('flyer_pk', window.location.pathname.split("/")[2]);

                    // $.ajax({
                    //   url: "/save-flyer-in-bucket/",
                    //   type: "POST",
                    //   headers:{
                    //     'X-CSRFToken':getCsrfToken()
                    //   },
                    //   processData: false,
                    //   contentType: false,
                    //   data: fd,
                    //   success: function(response) {
                    //     console.log("Success!", response);
                    //   },
                    //   error: function(xhr, textstatus, errorthrown) {
                    //     console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
                    //   }
                    // });
              });
            }
        },
        error: function(xhr, textstatus, errorthrown) {
          console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
        }
      });

    });

    $(document).on('click', '.productinfobtn', function(){
        global_selected_product_info_id = this.id.split("-")[1]
    });


    $(document).on("change", "#border-option", function(){
      if($("#border-option").prop("checked"))
        global_border_visible  = true;
      else
        global_border_visible  = false;
      set_border_style();
    });

    $("#upload-new-bg-image-btn").click(function(){

      var fd = new FormData();
      var bg_image = document.getElementById("new-bg-image"); 
      fd.append('bg_image', bg_image.files[0]);
      fd.append('flyer_pk', window.location.pathname.split("/")[2])

      $.ajax({
        url: "/upload-new-flyer-bg-image/",
        type: "POST",
        headers:{
          'X-CSRFToken':getCsrfToken()
        },
        processData: false,
        contentType: false,
        data: fd,
        success: function(response) {
          console.log("Success!", response);
          if(response["status"]==200)
          {
            global_background_images_bucket.push({"pk":response["bg_image_pk"], "url":response["bg_image_url"]});
            update_background_image_bucket();
            $("#add-new-bg-modal").modal("close");
          }
          else if(response["status"]==403)
          {
            M.toast({html: "You do not have permission to add background images!"});
          }
          else
          {
            M.toast({html: "Error adding background images!"}); 
          }
        },
        error: function(xhr, textstatus, errorthrown) {
          console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
        }
      });

    })


    $(document).on("change", "#product-title-font-size", function(){
        $(".product-title-info").css("font-size", this.value+"px");
        global_product_title_font_size = this.value;
    });

    $(document).on("change", "#product-price-font-size", function(){
        $(".product-price-info").css("font-size", this.value+"px");
        global_price_font_size = this.value;
    });

    $(document).on("change", "#currency-font-size", function(){
        $(".product-currency-info").css("font-size", this.value+"px");
        global_currency_font_size = this.value;
    });

    $(document).on("change", "#product-strikeprice-font-size", function(){
        $(".product-strikeprice-info").css("font-size", this.value+"px");
        global_strikeprice_font_size = this.value;
    });


    $(document).on("change", "#product-title-font-weight", function(){
        $(".product-title-info").css("font-weight", this.value);
        global_product_title_font_weight = this.value;
    });

    $(document).on("change", "#product-price-font-weight", function(){
        $(".product-price-info").css("font-weight", this.value);
        global_price_font_weight = this.value;
    });

    $(document).on("change", "#currency-font-weight", function(){
        $(".product-currency-info").css("font-weight", this.value);
        global_currency_font_weight = this.value;
    });

    $(document).on("change", "#product-strikeprice-font-weight", function(){
        $(".product-strikeprice-info").css("font-weight", this.value);
        global_strikeprice_font_weight = this.value;
    });



    $(document).on("change", "#product-title-font-color", function(){
        $(".product-title-info").css("color", this.value);
        global_product_title_font_color = this.value;
    });

    $(document).on("change", "#product-price-font-color", function(){
        $(".product-price-info").css("color", this.value);
        global_price_font_color = this.value;
    });

    $(document).on("change", "#currency-font-color", function(){
        $(".product-currency-info").css("color", this.value);
        global_currency_font_color = this.value;
    });

    $(document).on("change", "#product-strikeprice-font-color", function(){
        $(".product-strikeprice-info").css("color", this.value);
        global_strikeprice_font_color = this.value;
    });


    $(document).on("change", "#product-title-font-family", function(){
        $(".product-title-info").css("font-family", this.value);
        global_product_title_font_family = this.value;
    });
    $(document).on("change", "#product-price-font-family", function(){
        $(".product-price-info").css("font-family", this.value);
        global_price_font_family = this.value;
    });
    $(document).on("change", "#currency-font-family", function(){
        $(".product-currency-info").css("font-family", this.value);
        global_currency_font_family = this.value;
    });
    $(document).on("change", "#product-strikeprice-font-family", function(){
        $(".product-strikeprice-info").css("font-family", this.value);
        global_strikeprice_font_family = this.value;
    });


    $(document).on("change", "#header-color", function(){
        $("#header-div").css("background-color", this.value);
        global_header_color = this.value;
    });


    $(document).on("change", "#footer-color", function(){
        $("#footer-div").css("background-color", this.value);
        global_footer_color = this.value;
    });


    $(document).on("keyup", "#currency-unit", function(){
        $(".product-currency-info").val(this.value);
        global_currency_unit = this.value;
    });

    $(document).on("change", "#price-box-bg-color", function(){
      $(".grid-item-footer-right input").css("background", this.value);
      global_price_box_bg_color = this.value;
    });


    $(document).on("change", "#border-color", function(){
      global_border_color = this.value;
      if($("#border-option").prop("checked"))
      {
        $(".divgrid").parent().parent().parent().css("border", "2px solid "+this.value);
      }
    });


    $(document).on("change", "#strikeprice-option", function(){
      if($("#strikeprice-option").prop("checked"))
      {
        $(".footer-top-right").show();
        global_strikeprice_visible = true;
      }
      else
      {
        $(".footer-top-right").hide();
        global_strikeprice_visible = false;
      }
    });




    $("#image-resizer").change(function() {
      var R = $("#image-resizer").val();

      $("#gridimg-"+global_selected_grid_id).css("max-width", R+"%");
      $("#gridimg-"+global_selected_grid_id).attr("resizer", R);
    });

    $("#all-image-resizer").change(function() {
      var R = $("#all-image-resizer").val();

      var grid_images = $(".grid-images");
      for(var i=0;i<grid_images.length;i++)
      {
        $(grid_images[i]).css("max-width", R+"%");
        $(grid_images[i]).attr("resizer", R);
      }
      $("#image-resizer").val(R);
      global_all_image_resizer = R;
    });


    $("#price-resizer").change(function() {
      var R = $("#price-resizer").val();
      $(".grid-item-footer-right").css("max-width", R+"px");
      global_price_resizer = R;
    });


    $("#all-promo-resizer").change(function() {
      var R = $("#all-promo-resizer").val();
      global_all_promo_resizer = R;
      $(".grid-item-sticker img").css("width", R+"px");
      $("#promo-resizer").val(R);    
      $(".grid-item-sticker img").attr("resizer", R);
      $(".banner-img-left").css("width", R+"px");
      $(".banner-img-left").attr("resizer", R);
    });

    $("#promo-resizer").change(function() {
      var R = $("#promo-resizer").val();
      $("#banner-img-"+global_selected_grid_id).css("width", R+"px");
      $("#banner-img-"+global_selected_grid_id).attr("resizer", R);

      $("#banner-img-left-"+global_selected_grid_id).css("width", R+"px");
      $("#banner-img-left-"+global_selected_grid_id).attr("resizer", R);      
    });   


    $("#product-info-save-btn").click(function(){

        var product_name = $("#product-info-name").val();
        var product_price = $("#product-info-price").val();

        $("#productinfoname-"+global_selected_product_info_id).html(product_name);
        $("#productinfoprice-"+global_selected_product_info_id).html(product_price);
    });



    function create_unit_flyer_html(flyer_dict)
    {
      var grid_id = flyer_dict["grid-id"];
      var product_title = flyer_dict["product-title"];
      var product_info = flyer_dict["product-info"];
      var price = flyer_dict["price"];
      var strikeprice = flyer_dict["strikeprice"];
      var currency = flyer_dict["currency"];
      var image_url = flyer_dict["image-url"];
      var banner_img = flyer_dict["banner-img"];
      var image_resizer = flyer_dict["image-resizer"];
      var promo_resizer = flyer_dict["promo-resizer"];
      var width = flyer_dict["width"];
      var height = flyer_dict["height"];
      var x = flyer_dict["x"];
      var y = flyer_dict["y"];
      var warranty_display = flyer_dict["warranty-display"];

      var background_color = "background-color: transparent";
      if( $("#white-option").prop("checked"))
      {
        background_color = "background-color: white";
      }

      var warranty_display_url = "";
      if(warranty_display)
      {
        warranty_display_url = "/files/warranty.png";
      }

      var html_string = 
          `<div grid-id="`+grid_id+`" class="grid-stack-item" data-gs-width=`+width+` data-gs-height=`+height+` data-gs-x=`+x+` data-gs-y=`+y+` style="text-align:center;padding:0em !important;">
            <div class="grid-stack-item-content hoverable" style="border: 2px solid `+global_border_color+`;`+background_color+`">
              <div class="grid-item-img-container">
                <a id="gridbox-`+grid_id+`" href="#!" class="flyer-item-box" style="color:black;height:100%;width:100%;">
                  <div class="divgrid" id="divgrid-`+grid_id+`" style="text-align: center;background-color:transparent;display:flex;justify-content:center;align-item:center;height:auto;width:100%">
                      <img class="grid-images" resizer="`+image_resizer+`" id="gridimg-`+grid_id+`" src="`+image_url+`" style="padding:0em;max-width:`+image_resizer+`%;height:auto;"/>
                  </div>
                </a>
                <div class="grid-item-sticker">
                  <img class="banner-img" id="banner-img-`+grid_id+`" src="`+banner_img+`" style="width: `+promo_resizer+`px" resizer="`+promo_resizer+`" />
                </div>
                <div style="position: absolute;left:10px;top:10px;">
                  <img class="banner-img-left" id="banner-img-left-`+grid_id+`" src="`+warranty_display_url+`" style="width: `+promo_resizer+`px" resizer="`+promo_resizer+`" />
                </div>
              </div>
              <div class="grid-item-footer-container" > 
                <div class="footer-top">
                  <div class="footer-top-left valign-wrapper">
                    <p class="grid-item-text brand-text" style="text-align:left;"></p>
                  </div>
                  <div class="footer-top-right">
                    <p id="product-strikeprice-info-`+grid_id+`" class="grid-item-text-4 strikethrough product-strikeprice-info browser-default" type="text" contenteditable="true">`+strikeprice+`</p>
                  </div>
                </div>
                <div class="footer-bottom">
                  <div class="grid-item-footer-left">
                      <input id="product-title-info2-`+grid_id+`" class=" font-to-avenir footer-bottom-left-input product-title-info product-title-info-title browser-default" type="text" name="name" placeholder="product name" value="`+product_title+`">
                      <input id="product-title-info-`+grid_id+`" class="footer-bottom-left-input product-title-info product-title-info-description font-to-avenir browser-default" type="text" name="description" placeholder="description" value="`+product_info+`">
                  </div>
                  <div class="grid-item-footer-right">
                      <input id="product-currency-info-`+grid_id+`" class="grid-item-text footer-bottom-left-input product-currency-info font-to-avenir browser-default" type="text" name="currency" placeholder="currency" value="`+currency+`" >
                      <input id="product-price-info-`+grid_id+`" class="grid-item-text-3 footer-bottom-left-input product-price-info font-to-avenir browser-default" type="text" name="price" placeholder="price" value="`+price+`">
                  </div>
                </div>
              </div>
            </div>
          </div>`

        return html_string;
    }


    function select_cell(grid_id)
    {
      global_selected_grid_id = grid_id;

      $("#divgrid-1").parent().parent().css("border", "0.14em dashed");

      $("#image-resizer").val($("#gridimg-"+global_selected_grid_id).attr("resizer"));
      $("#promo-resizer").val($("#banner-img-"+global_selected_grid_id).attr("resizer"));

      var banner_img = $("#banner-img-"+global_selected_grid_id).attr("src");
      if(banner_img=="")
      {
        $("#local-none").click();
      } 
      else if(banner_img=="/files/combo.png")
      {
        $("#local-combo").click();
      }
      else if(banner_img=="/files/banner1.png")
      {
        $("#local-sale").click();
      }
      else if(banner_img=="/files/wow.png")
      {
        $("#local-wow").click();
      }
      
      var banner_img_url = $("#banner-img-left-"+global_selected_grid_id).attr("src");
      if(banner_img_url!="")
      {
        $("#local-warranty").prop("checked", true);
      }
      else
      {
        $("#local-warranty").prop("checked", false);
      }
    }

    var grid_cnt = 0;

    function create_flyer_grid()
    {
      var item_data = global_template_data["item-data"];

      grid_cnt = item_data.length+1;
      var html_string = '';
      for(var i=0; i< item_data.length; i ++)
      {
        var flyer_dict = {}
        flyer_dict["grid-id"] = i+1;
        flyer_dict["product-title"] = item_data[i]["data"]["title"];
        flyer_dict["product-info"] = item_data[i]["data"]["description"];
        flyer_dict["price"] = item_data[i]["data"]["price"];
        flyer_dict["strikeprice"] = item_data[i]["data"]["strikeprice"];
        flyer_dict["image-url"] = item_data[i]["data"]["image-url"];
        flyer_dict["banner-img"] = item_data[i]["data"]["banner-img"];
        flyer_dict["image-resizer"] = item_data[i]["data"]["image-resizer"];
        flyer_dict["promo-resizer"] = item_data[i]["data"]["promo-resizer"];
        flyer_dict["width"] = item_data[i]["container"]["width"];
        flyer_dict["height"] = item_data[i]["container"]["height"];
        flyer_dict["x"] = item_data[i]["container"]["x"];
        flyer_dict["y"] = item_data[i]["container"]["y"];
        flyer_dict["warranty-display"] = item_data[i]["data"]["warranty-display"];

        var temp_html = create_unit_flyer_html(flyer_dict);
        html_string += temp_html;
      }
       
      $('#grid-stack-div').html(html_string);
      $('.grid-stack').gridstack({
        animate: true,
        removable: true,
        verticalMargin: 6,
        column: 24,
        cellHeight: 30,
        resizable: {
          handles: 'e, se, s, sw, w'
        }
      });

      $(".brand-text").html(global_brand_name);
      $(".product-currency-info").val(global_currency_unit)

      select_cell(1);
    }



  
    $("#refresh-template-btn").click(function (){

      global_template_data["item-data"] = [];

      var grid = $('.grid-stack').data('gridstack');

      grid.destroy();
      var html_string = `<div id="grid-stack-div" class="grid-stack" data-gs-width="24" data-gs-animate="yes" data-gs-column="24" style="max-height: 260mm;">`
      $("#flyer-grid").html(html_string);
      create_flyer_grid();
      set_editor_style();
    });


    $("#hide-cursor-btn").click(function() {

      if($("#hide-cursor-btn").attr("cursor-status")=="on") //Make cursor invisible
      {
        $("#hide-cursor-btn").attr("cursor-status", "off");
        $("#divgrid-"+global_selected_grid_id).parent().parent().css("border", "none");
        if($("#border-option").prop("checked"))
        {
          //$("#divgrid-"+global_selected_grid_id).css("border-bottom", "2px solid #E9E9E9");
        }
        else
        {
          $("#divgrid-"+global_selected_grid_id).parent().parent().css("border-bottom", "none");
        }
      }
      else  //Make cursor visible
      {
        $("#hide-cursor-btn").attr("cursor-status", "on");
        $("#divgrid-"+global_selected_grid_id).parent().parent().css("border", "0.14em dashed");
      }
    });


    $("#increase-height-btn").click(function(){
      var grid_items = $(".grid-stack-item");
      var grid = $('.grid-stack').data('gridstack');
      for(var i=0;i<grid_items.length;i++)
      {
        var old_height = $(grid_items[i]).attr("data-gs-height");
        var old_width = $(grid_items[i]).attr("data-gs-width");
        var new_height = parseInt(old_height)+1;

        el = $(grid_items[i]);
        console.log(el);
        grid.resize(el, old_width, new_height);
      }
    });

    $("#decrease-height-btn").click(function(){
      var grid_items = $(".grid-stack-item");
      var grid = $('.grid-stack').data('gridstack');
      for(var i=0;i<grid_items.length;i++)
      {
        var old_height = $(grid_items[i]).attr("data-gs-height");
        var old_width = $(grid_items[i]).attr("data-gs-width");
        var new_height = parseInt(old_height)-1;

        el = $(grid_items[i]);
        console.log(el);
        grid.resize(el, old_width, new_height);
      }
    });    



    $("#add-grid-item-btn").click(function(){

      var i = grid_cnt+1;
      grid_cnt += 1;
      console.log(i);

      var flyer_dict = {};

      flyer_dict["grid-id"] = (i+1);
      flyer_dict["product-title"] = "";
      flyer_dict["product-info"] = "";
      flyer_dict["price"] = "";
      flyer_dict["strikeprice"] = "strikeprice";
      flyer_dict["currency"] = global_currency_unit;
      flyer_dict["image-url"] = "";
      flyer_dict["image-resizer"] = global_all_image_resizer;
      flyer_dict["promo-resizer"] = global_all_promo_resizer;
      flyer_dict["banner-img"] = "";
      flyer_dict["width"] = "3";
      flyer_dict["height"] = "3";
      flyer_dict["x"] = "7";
      flyer_dict["y"] = "7";
      flyer_dict["warranty-display"] = $("#global-warranty").prop("checked");

      var html_string = create_unit_flyer_html(flyer_dict);


      $("#grid-stack-div").append(html_string);

      var grid = $('.grid-stack').data('gridstack');
      var el = $('.grid-stack').children()[$('.grid-stack').children().length-1];
      grid.addWidget(el, 0, 0, 3, 3, true);

      set_editor_style();
    });


    $("#delete-grid-item-btn").click(function(){
      var el =  $(".grid-stack-item[grid-id="+global_selected_grid_id+"]");
      var grid = $('.grid-stack').data('gridstack');
      grid.removeWidget(el);
    })


    function render_fetures()
    {
      var html_string = `<br><br>`;
      var feature_text = $(".feature-text");
      for(var i=0;i<feature_text.length;i++)
      {
        html_string += `<h6>- `+feature_text[i].value+`</h6>`

      }
      $("#features-preview-div").html(html_string);
    }


    $("#product-name-input").keyup(function(){
      $("#product-name-preview").html($("#product-name-input").val());
    });

    

    function getCsrfToken() {
      var CSRF_TOKEN = $('input[name="csrfmiddlewaretoken"]').val();
      return CSRF_TOKEN;
    }


    function add_to_product_basket()
    {
      var product_name = $("#autocomplete-input").val();


      $.ajax({
        url: "/add-product-flyer-bucket/",
        type: "POST",
        headers:{
          'X-CSRFToken':getCsrfToken()
        },
        data: {
          product_name: product_name,
          flyer_pk: window.location.pathname.split("/")[2]
        },
        success: function(response) {
          console.log("Success!", response);
          if(response["status"]==200)
          {
            global_product_bucket_list.push({"product_bucket_pk": response["product_pk"], "product_bucket_name":response["product_name"], "product_bucket_image_url": response["product_image_url"], "seller_sku": response["seller_sku"]});
            global_product_images_dict[response["product_pk"]] = response["images"];
            set_product_basket();
          }
          else if(response["status"]==403)
          {
            M.toast({html: "You do not have permission to add products to flyer bucket!"});
          }
          else
          {
            M.toast({html: "Error adding product to flyer bucket!"}); 
          }
        },
        error: function(xhr, textstatus, errorthrown) {
          console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
        }
      });


      $("#autocomplete-input").val("");

    }

    function fetch_product_list_autocomplete()
    {
      $.ajax({
        url: "/fetch-product-list-flyer-pfl/",
        type: "POST",
        headers:{
          'X-CSRFToken':getCsrfToken()
        },
        data: {
          "flyer_pk": window.location.pathname.split("/")[2]
        },
        success: function(response) {
          console.log("Success!", response);

          var autocomplete_data = {};
          var product_list = response["product_list"];
          for(var i=0;i<product_list.length;i++)
          {
            autocomplete_data[product_list[i]["product_name_autocomplete"]] = product_list[i]["main_image_url"]; 
          }

          $('#autocomplete-input').autocomplete({
            data: autocomplete_data,
            minLength: 3,
            limit: 50,
            onAutocomplete: function()
            {
              add_to_product_basket();
            }
          });
        },
        error: function(xhr, textstatus, errorthrown) {
          console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
        }
      });
    }

    fetch_product_list_autocomplete();



    $(document).on('click', '.product-basket-card-btn', function(){
      $(".product-basket-card").css('background-color', "white");

      console.log($($(this).children()[0]));
      $($(this).children()[0]).children()[1].style.background = "#f6eeff";

      global_selected_product_pk = this.id.split("_")[1];
      global_selected_product_name = $("#product-basket-card-name-"+global_selected_product_pk).attr("title");

      $("#all-images-option").html("All Images ("+global_product_images_dict[global_selected_product_pk]["all_images"].length+")");
      $("#main-images-option").html("Main Images ("+global_product_images_dict[global_selected_product_pk]["main_images"].length+")");
      $("#sub-images-option").html("Sub Images ("+global_product_images_dict[global_selected_product_pk]["sub_images"].length+")");
      $("#pfl-images-option").html("PFL Images ("+global_product_images_dict[global_selected_product_pk]["pfl_images"].length+")");
      $("#white-background-images-option").html("White Background Images ("+global_product_images_dict[global_selected_product_pk]["white_background_images"].length+")");
      $("#lifestyle-images-option").html("Lifestyle Images ("+global_product_images_dict[global_selected_product_pk]["lifestyle_images"].length+")");
      $("#certificate-images-option").html("Certificate Images ("+global_product_images_dict[global_selected_product_pk]["certificate_images"].length+")");
      $("#giftbox-images-option").html("Giftbox Images ("+global_product_images_dict[global_selected_product_pk]["giftbox_images"].length+")");
      $("#diecut-images-option").html("Diecut Images ("+global_product_images_dict[global_selected_product_pk]["diecut_images"].length+")");
      $("#aplus-content-images-option").html("A+ Content Images ("+global_product_images_dict[global_selected_product_pk]["aplus_content_images"].length+")");
      $("#ads-images-option").html("Ads Images ("+global_product_images_dict[global_selected_product_pk]["ads_images"].length+")");
      $("#unedited-images-option").html("Unedited Images ("+global_product_images_dict[global_selected_product_pk]["unedited_images"].length+")");
      $("#transparent-images-option").html("Transparent Images ("+global_product_images_dict[global_selected_product_pk]["transparent_images"].length+")");

      update_image_categories("all_images");
      $("#image-categories-thumbnails-select").val("all_images");
      $("select").formSelect();

    });

    function set_product_basket()
    {
      //Product Basket needs to be updated
      var html_string = "";
      for(var i=0;i<global_product_bucket_list.length;i++)
      {
        var short_product_name = global_product_bucket_list[i]["product_bucket_name"];
        var char_length = 50;
        if(short_product_name.length>char_length)
        {
          short_product_name = short_product_name.substring(0, char_length) + "...";
        }

        html_string += `
          <a href="#!" class="product-basket-card-btn" id="basket_`+global_product_bucket_list[i]["product_bucket_pk"]+`">
            <div class="row" style="border: 2px solid #E9E9E9;margin-right:0em;">
              <div class="col s4" style="padding-left:0em;margin-right:0em;padding-right:0em;">
                <div class="img-box" style="border-right: 2px solid #E9E9E9;text-align:center;padding-top:0.5em;">
                  <img src="`+global_product_bucket_list[i]["product_bucket_image_url"]+`" style="width:80%;max-height:5em;margin-left:0;object-fit: cover;object-position:center;">
                </div>
              </div>
              <div class="product-basket-card col s8">
                <div style="padding-left:0em;height:6em;">
                  <div style="padding-top:1em;font-family:'AvenirNext';color:#521893;" title="`+global_product_bucket_list[i]["product_bucket_name"]+`" id="product-basket-card-name-`+global_product_bucket_list[i]["product_bucket_pk"]+`">`+
                  short_product_name+`
                  </div>
                  <div style="padding-top:1em;font-family:'AvenirNextRegular';color:black;margin-top:-1em;font-size:0.8em;">`+
                  global_product_bucket_list[i]["seller_sku"]+`
                  </div>
                </div>
              </div>
            </div>
          </a>`;
      }

        $("#product-basket-list-div").html(html_string);
        $($(".product-basket-card-btn")[$(".product-basket-card-btn").length-1]).click();
    }



    function update_image_categories(key)
    {
      var html_string = "";

      var images = global_product_images_dict[global_selected_product_pk][key];
      for(var i=0;i<images.length;i++)
      {
        html_string += `<div class="col s3" style="padding-top:0.2em;margin-bottom:1.4em;">
          <div style="border:2px solid #E9E9E9;text-align:center;padding-top:0.5em;">
            <a class="imgselect" id="imgselect_`+images[i]["pk"]+`" href="#!"><img src="`+images[i]["url"]+`" style="width:90%;height:3em;object-fit:cover;" high-res-url="`+images[i]["high-res-url"]+`"></a>
          </div>
        </div>`;
      }

      $("#image-categories-thumbnails-div").html(html_string);
    }



    function update_background_image_bucket()
    {
      var html_string = "";

      var images = global_background_images_bucket;
      for(var i=0;i<images.length;i++)
      {
        html_string += `<div class="col s3" style="padding-top:0.2em;margin-bottom:1.4em;">
          <div style="border:2px solid #E9E9E9;text-align:center;padding-top:0.4em;">
            <a class="bgimgselect" id="bgimgselect_`+images[i]["pk"]+`" href="#!">
              <img src="`+images[i]["url"]+`" style="width:90%;height:3em;object-fit:cover;">
            </a>
          </div>
        </div>`;
      }

      $("#background-image-bucket-thumbnails-div").html(html_string);
    }

    function update_external_image_bucket()
    {
      var html_string = "";

      var images = global_external_image_bucket;
      for(var i=0;i<images.length;i++)
      {
        html_string += `<div class="col s3" style="padding-top:0.2em;margin-bottom:1.4em;">
          <div style="border:2px solid #E9E9E9;text-align:center;padding-top:0.4em;">
            <a class="imgselect2" href="#!">
              <img src="`+images[i]["url"]+`" high-res-url="`+images[i]["high-res-url"]+`" style="width:90%;height:3em;object-fit:cover;">
            </a>
          </div>
        </div>`;
      }

      $("#external-image-categories-thumbnails-div").html(html_string); 
    }


    function set_product_name()
    {
      $("#product-name-preview").html(global_product_name);
      $("#product-name-input").val(global_product_name);
      M.updateTextFields();
    }


    $(document).on('click', '.imgselect', function(){

        var image_pk = this.id.split("_")[1];
        //var image_url = $(this).children()[0].src;
        var image_url = $($(this).children()[0]).attr("high-res-url");
        console.log(image_pk, image_url, global_selected_grid_id);
        $("#gridimg-"+global_selected_grid_id).attr("src", image_url);
        //if($("#product-title-info2-"+global_selected_grid_id).val()=="")
        $("#product-title-info2-"+global_selected_grid_id).val(global_selected_product_name);
        $("#default404-"+global_selected_grid_id).hide();
        $("#gridimg-"+global_selected_grid_id).show();
        $("#divgrid-"+global_selected_grid_id).css("background-color", "transparent");
    });

    $(document).on('click', '.imgselect2', function(){

        var image_pk = this.id.split("_")[1];
        //var image_url = $(this).children()[0].src;
        var image_url = $($(this).children()[0]).attr("high-res-url");
        console.log(image_pk, image_url, global_selected_grid_id);
        $("#gridimg-"+global_selected_grid_id).attr("src", image_url);
        $("#gridimg-"+global_selected_grid_id).show();
        $("#divgrid-"+global_selected_grid_id).css("background-color", "transparent");
    });


    $(document).on('click', '.bgimgselect', function(){
        var image_pk = this.id.split("_")[1];
        var image_url = $(this).children()[0].src
        global_background_image_url = image_url;

        $("#flyer-div").css("background-image", "url("+image_url+")");
        $("#flyer-div").css("background-position", "center");
        $("#flyer-div").css("background-size", "100% 210mm");
    });



    $("#image-categories-thumbnails-select").on("change", function(){
      update_image_categories($("#image-categories-thumbnails-select").val());
    });


    function set_brand_image(url)
    {
      $("#brand-image-img").attr("src", url);
    } 

    function fetch_flyer_details()
    {
      $.ajax({
        url: "/fetch-flyer-details/",
        type: "POST",
        headers:{
          'X-CSRFToken':getCsrfToken()
        },
        data: {
          pk: window.location.pathname.split("/")[2]
        },
        success: function(response) {
          console.log("Success!", response);

          global_product_bucket_list = response["product_bucket_list"];
          global_product_images_dict = response['images'];
          global_template_data = response["template_data"];
          global_background_images_bucket = response["background_images_bucket"];
          global_external_image_bucket = response["external_images_bucket_list"];
          global_brand_name = response["brand-name"];

          var common = global_template_data["common"];


          global_background_image_url = common["background-image-url"]
          global_border_visible = common["border-visible"];
          global_border_color = common["border-color"];
          global_super_brand_logo = common["super-brand-logo"];
          global_iso_logo = common["iso-logo"];
          global_consumer_logo = common["consumer-logo"];
          global_brand_name_visible = common["brand-name-visible"];
          global_white_container = common["white-container"];
          global_price_resizer = common["price-resizer"];
          global_product_title_font_size = common["product-title-font-size"];
          global_product_title_font_family = common["product-title-font-family"];
          global_product_title_font_weight = common["product-title-font-weight"];
          global_product_title_font_color = common["product-title-font-color"];
          global_price_font_size = common["price-font-size"];
          global_price_font_family = common["price-font-family"];
          global_price_font_weight = common["price-font-weight"];
          global_price_font_color = common["price-font-color"];
          global_currency_font_size = common["currency-font-size"];
          global_currency_font_family = common["currency-font-family"];
          global_currency_font_weight = common["currency-font-weight"];
          global_currency_font_color = common["currency-font-color"];
          global_currency_unit = common["currency-unit"];
          global_price_box_bg_color = common["price-box-bg-color"];
          global_strikeprice_font_size = common["strikeprice-font-size"];
          global_strikeprice_font_family = common["strikeprice-font-family"];
          global_strikeprice_font_weight = common["strikeprice-font-weight"];
          global_strikeprice_font_color = common["strikeprice-font-color"];
          global_strikeprice_visible = common["strikeprice-visible"]   
          global_header_color = common["header-color"];
          global_footer_color = common["footer-color"];
          global_all_promo_resizer = common["all-promo-resizer"]
          global_all_image_resizer = common["all-image-resizer"]

          update_editor_settings();
          create_flyer_grid();
          set_editor_style();


          set_product_basket();
          update_background_image_bucket();
          update_external_image_bucket();
          set_brand_image(response["brand_image_url"]);
        },
        error: function(xhr, textstatus, errorthrown) {
          console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
        }
      });
    }



    $(document).on("click", ".flyer-item-box", function(){
        global_selected_grid_id = this.id.split("-")[1];
        $(".divgrid").parent().parent().css("border", "none");
        if($("#border-option").prop("checked"))
        {
          //$(".divgrid").css("border-bottom", "2px solid #E9E9E9");
          //$(".divgrid").css("border-bottom", "none");
          //$(".divgrid").parent().parent().css("border", "2px solid #E9E9E9");
        }
        else
        {
          $(".divgrid").parent().parent().css("border-bottom", "none");
          //$(".divgrid").parent().parent().css("border", "none");
        }

        $("#divgrid-"+global_selected_grid_id).parent().parent().css("border", "0.14em dashed");

        $("#image-resizer").val($("#gridimg-"+global_selected_grid_id).attr("resizer"));
        $("#promo-resizer").val($("#banner-img-"+global_selected_grid_id).attr("resizer"));

        var banner_img = $("#banner-img-"+global_selected_grid_id).attr("src");
        if(banner_img=="")
        {
          $("#local-none").click();
        } 
        else if(banner_img=="/files/combo.png")
        {
          $("#local-combo").click();
        }
        else if(banner_img=="/files/banner1.png")
        {
          $("#local-sale").click();
        }
        else if(banner_img=="/files/wow.png")
        {
          $("#local-wow").click();
        }
        

        var banner_img_url = $("#banner-img-left-"+global_selected_grid_id).attr("src");
        if(banner_img_url!="")
        {
          $("#local-warranty").prop("checked", true);
        }
        else
        {
          $("#local-warranty").prop("checked", false);
        }

    });

    fetch_flyer_details();


    $("#save-flyer-template-btn").click(function(){
      
      $("#save-flyer-template-btn").attr("disabled", "disabled");

      var grid_stack_items = $(".grid-stack-item");
      global_template_data = {};
      var item_data = [];
      for(var i=0;i<grid_stack_items.length;i++)
      {
        var width = $(grid_stack_items[i]).attr("data-gs-width");
        var height = $(grid_stack_items[i]).attr("data-gs-height");
        var x = $(grid_stack_items[i]).attr("data-gs-x");
        var y = $(grid_stack_items[i]).attr("data-gs-y");

        var grid_id = $(grid_stack_items[i]).attr("grid-id");

        var image_url = $("#gridimg-"+grid_id).attr("src");
        var banner_img = $("#banner-img-"+grid_id).attr("src");
        var image_resizer = $("#gridimg-"+grid_id).attr("resizer");
        var promo_resizer = $("#banner-img-"+grid_id).attr("resizer");
        var product_title = $("#product-title-info2-"+grid_id).val();
        var description = $("#product-title-info-"+grid_id).val();
        var price = $("#product-price-info-"+grid_id).val();
        var strikeprice = $("#product-strikeprice-info-"+grid_id).html();

        var warranty_display = false;
        if($("#banner-img-left-"+grid_id).attr("src")!="")
          warranty_display = true;

        var temp_dict = {
          "container": {
            "width": width,
            "height": height,
            "x": x,
            "y": y
          },
          "data": {
            "image-url": image_url,
            "banner-img": banner_img,
            "warranty-display": warranty_display,
            "image-resizer": image_resizer,
            "promo-resizer": promo_resizer,
            "price": price,
            "strikeprice": strikeprice,
            "title": product_title,
            "description": description,
            "price": price
          }
        }

        console.log(temp_dict);

        item_data.push(temp_dict);
      }
      global_template_data["item-data"] = item_data;

      var common = {
        "background-image-url": global_background_image_url,
        "border-visible": global_border_visible,
        "border-color": global_border_color,
        "super-brand-logo": global_super_brand_logo,
        "iso-logo": global_iso_logo,
        "consumer-logo": global_consumer_logo,
        "brand-name-visible": global_brand_name_visible,
        "white-container": global_white_container,
        "price-resizer": global_price_resizer,
        "product-title-font-size": global_product_title_font_size,
        "product-title-font-family": global_product_title_font_family,
        "product-title-font-weight": global_product_title_font_weight,
        "product-title-font-color": global_product_title_font_color,
        "price-font-size": global_price_font_size,
        "price-font-family": global_price_font_family,
        "price-font-weight": global_price_font_weight,
        "price-font-color": global_price_font_color,
        "currency-font-size": global_currency_font_size,
        "currency-font-family": global_currency_font_family,
        "currency-font-weight": global_currency_font_weight,
        "currency-font-color": global_currency_font_color,
        "currency-unit": global_currency_unit,
        "price-box-bg-color": global_price_box_bg_color,
        "strikeprice-font-size": global_strikeprice_font_size,
        "strikeprice-font-family": global_strikeprice_font_family,
        "strikeprice-font-weight": global_strikeprice_font_weight,
        "strikeprice-font-color": global_strikeprice_font_color,
        "strikeprice-visible": global_strikeprice_visible,
        "header-color": global_header_color,
        "footer-color": global_footer_color,
        "all-promo-resizer": global_all_promo_resizer,
        "all-image-resizer": global_all_image_resizer
      };

      global_template_data["common"] = common;

      $.ajax({
        url: "/save-flyer-template/",
        type: "POST",
        headers:{
          'X-CSRFToken':getCsrfToken()
        },
        data: {
          flyer_pk: window.location.pathname.split("/")[2],
          template_data: JSON.stringify(global_template_data)
        },
        success: function(response) {
          console.log("Success!", response);
          $("#save-flyer-template-btn").removeAttr("disabled");
          if(response["status"]==200)
          {
            M.toast({html: "Flyer template saved successfully!"});
          }
          else if(response["status"]==403)
          {
            M.toast({html: "You do not have permission to save flyer!"}); 
          }
          else
          {
            M.toast({html: "Error saving flyer!"});
          }
        },
        error: function(xhr, textstatus, errorthrown) {
          console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
        }
      });

    });


    $(document).on(".remove-product-btn", "click", function(){
      
    })

    $(window).keydown(function(event) {
      console.log(event.which, event.keyCode, event.ctrlKey);
      if(event.which == 83 && event.ctrlKey)
      {
        event.preventDefault();
        $("#save-flyer-template-btn").click();
        return false;
      }
    });








    function set_background_image()
    {
      $("#flyer-div").css("background-image", "url("+global_background_image_url+")");
      $("#flyer-div").css("background-position", "center");
      $("#flyer-div").css("background-size", "100% 210mm");
    }

    function set_border_style()
    {
      if(global_border_visible)
      {
        $("#divgrid-"+global_selected_grid_id).parent().parent().css("border", "0.14em dashed");
        $(".divgrid").parent().parent().parent().css("border", "2px solid "+global_border_color);
      }
      else
      {
        $("#divgrid-"+global_selected_grid_id).parent().parent().css("border", "0.14em dashed");
        $(".divgrid").parent().parent().parent().css("border", "none");
      } 
    }

    function set_header_logos()
    {
      if(global_super_brand_logo)
        $("#super-brand-img").show();
      else
        $("#super-brand-img").hide();


      if(global_iso_logo)
        $("#iso-img").show();
      else
        $("#iso-img").hide();

      if(global_consumer_logo)
        $("#consumer-img").show();
      else
        $("#consumer-img").hide();

      if(global_brand_name_visible)
        $(".brand-text").show();
      else
        $(".brand-text").hide();
    }

    function set_product_title_style()
    {
      $(".product-title-info").css("font-size", global_product_title_font_size+"px");
      $(".product-title-info").css("font-family", global_product_title_font_family);
      $(".product-title-info").css("font-weight", global_product_title_font_weight);
      $(".product-title-info").css("color", global_product_title_font_color);
    }

    function set_price_box_style()
    {
      //Actual Price
      $(".product-price-info").css("font-size", global_price_font_size+"px");
      $(".product-price-info").css("font-family", global_price_font_family);
      $(".product-price-info").css("font-weight", global_price_font_weight);
      $(".product-price-info").css("color", global_price_font_color);

      //currency
      $(".product-currency-info").css("font-size", global_currency_font_size+"px");
      $(".product-currency-info").css("font-family", global_currency_font_family);
      $(".product-currency-info").css("font-weight", global_currency_font_weight);
      $(".product-currency-info").css("color", global_currency_font_color);
      $(".product-currency-info").html(global_currency_unit);

      $(".grid-item-footer-right input").css("background", global_price_box_bg_color);
      $(".grid-item-footer-right").css("max-width", global_price_resizer+"px");
    }

    function set_strike_price_style()
    {
      //strikeprice
      $(".product-strikeprice-info").css("font-size", global_strikeprice_font_size+"px");
      $(".product-strikeprice-info").css("font-family", global_strikeprice_font_family);
      $(".product-strikeprice-info").css("font-weight", global_strikeprice_font_weight);
      $(".product-strikeprice-info").css("color", global_strikeprice_font_color);

      if(global_strikeprice_visible)
        $(".footer-top-right").show();
      else
        $(".footer-top-right").hide();
    }

    function set_header_style()
    {
      $("#header-div").css("background-color", global_header_color);
    }

    function set_footer_style()
    {
      $("#footer-div").css("background-color", global_footer_color);
    }



    // Updates the editor // One time call
    function update_editor_settings()
    {

      //Border Settings
      $("#border-option").prop("checked", global_border_visible);
      $("#border-color").val(global_border_color);


      //Header Logos
      $("#super-brand-option").prop("checked", global_super_brand_logo);
      $("#iso-option").prop("checked", global_iso_logo);
      $("#consumer-option").prop("checked", global_consumer_logo)
      $("#small-brand-option").prop("checked", global_brand_name_visible);
      $("#white-option").prop("checked", global_white_container)

      //Price Resizer
      $("#price-resizer").val(global_price_resizer);

      //Image Resizer
      $("#all-image-resizer").val(global_all_image_resizer);

      //Promo Resizer
      $("#all-promo-resizer").val(global_all_promo_resizer);


      // Product Title Settings
      $("#product-title-font-size").val(global_product_title_font_size);
      $("#product-title-font-family").val(global_product_title_font_family);
      $("#product-title-font-weight").val(global_product_title_font_weight);
      $("#product-title-font-color").val(global_product_title_font_color);



      //Price Box
      $("#product-price-font-size").val(global_price_font_size);
      $("#product-price-font-family").val(global_price_font_family);
      $("#product-price-font-weight").val(global_price_font_weight);
      $("#product-price-font-color").val(global_price_font_color);

      $("#currency-font-size").val(global_currency_font_size);
      $("#currency-font-family").val(global_currency_font_family);
      $("#currency-font-weight").val(global_currency_font_weight);
      $("#currency-font-color").val(global_currency_font_color);
      
      $("#currency-unit").val(global_currency_unit);
      $("#price-box-bg-color").val(global_price_box_bg_color);
      

      //Strikeprice settings
      $("#product-strikeprice-font-size").val(global_strikeprice_font_size);
      $("#product-strikeprice-font-family").val(global_strikeprice_font_family);
      $("#product-strikeprice-font-weight").val(global_strikeprice_font_weight);
      $("#product-strikeprice-font-color").val(global_strikeprice_font_color);
      
      if(global_strikeprice_visible)
        $("#strikeprice-option").prop("checked", true);
      else
        $("#strikeprice-option").prop("checked", false);
      
      //Header/Footer settings
      $("#header-color").val(global_header_color);
      $("#footer-color").val(global_footer_color);
      
      $("select").formSelect();
    }

    // Sets the current global editor styles to all elements
    function set_editor_style()
    {
      //Background Image
      set_background_image();

      //Border Settings
      set_border_style();

      //Header Logos
      set_header_logos();

      //Product Title Settings
      set_product_title_style();

      //Price Box Settings
      set_price_box_style()

      //Strike Price Settings
      set_strike_price_style();

      //Header/Footer Settings
      set_header_style();
      set_footer_style();
    }


    $("#upload-image-btn").click(function(){

      var fd = new FormData();
      fd.append("flyer_pk", window.location.pathname.split("/")[2]);

      var product_image_input = document.getElementById("product-image-input");

      fd.append("image_count", product_image_input.files.length);
      for(var i=0;i<product_image_input.files.length;i++)
      {
        fd.append("image_"+i, product_image_input.files[i]);
      }
      $("#upload-preloader").show();
      $("#upload-image-btn").attr("disabled", "disabled");

      $.ajax({
        url: "/upload-flyer-external-images/",
        type: "POST",
        headers:{
          'X-CSRFToken':getCsrfToken()
        },
        processData: false,
        contentType: false,
        data: fd,
        success: function(response) {
          console.log("Success!", response);
          $("#upload-preloader").hide();
          $("#upload-image-btn").removeAttr("disabled");

          if(response["status"]==200)
          {
            $("#upload-image-modal").modal("close");
            M.toast({html: "Successfully uploaded images!"});

            var images = response["external_images_bucket_list"];
            for(var i=0;i<images.length;i++)
            {
              global_external_image_bucket.push({"url":images[i]["url"], "high-res-url":images[i]["high-res-url"]});
            }
            update_external_image_bucket();
          }
          else if(response["status"]==403)
          {
            M.toast({html: "You do not have permission to upload images!"});
          }
          else
          {
            M.toast({html: "Error uploading images!"});
          }
        },
        error: function(xhr, textstatus, errorthrown) {
          console.log("Please report this error: "+errorthrown+xhr.status+xhr.responseText);
          $("#upload-preloader").hide();
        }
      });
    });

  </script>

</body>
</html>
